!function(O,X,Z){"use strict";var J="ht";if(!O[J]){!function(){for(var g=0,C=["ms","moz","webkit","o"],e=0;e<C.length&&!O.requestAnimationFrame;++e)O.requestAnimationFrame=O[C[e]+"RequestAnimationFrame"],O.cancelAnimationFrame=O[C[e]+"CancelAnimationFrame"]||O[C[e]+"CancelRequestAnimationFrame"];O.requestAnimationFrame||(O.requestAnimationFrame=function(n){var Z=(new Date).getTime(),j=Math.max(0,16-(Z-g)),w=O.setTimeout(function(){n(Z+j)},j);return g=Z+j,w}),O.cancelAnimationFrame||(O.cancelAnimationFrame=function(i){m(i)})}();var C=O.document,t=null,p=O[J]={},h=O[J+"config"],b=p.Default=h&&h.Default||{},L=p.Style=h&&h.Style||{},A=p.Color=h&&h.Color||{},q=p.IsGetter=h&&h.IsGetter||{},$=Math,I=$.round,D=$.floor,Q=$.ceil,k=$.sqrt,n=$.max,d=$.min,g=$.abs,_=$.cos,T=$.acos,E=$.sin,l=$.pow,B=$.asin,R=$.PI,x=2*R,P=R/2,f=$.tan,W=$.atan2,S=$.random,V=O.parseInt||global.parseInt,i=function(N){return N*N},N=O.setTimeout,m=O.clearTimeout,j=O.navigator?O.navigator.userAgent.toLowerCase():"",H=function(Q){return Q.test(j)},w=H(/msie/)||H(/trident/),u=H(/msie 10/),K=H(/firefox/),e=H(/mac/),F=b.isTouchable===Z?C?"ontouchend"in C:!1:b.isTouchable,M="default",o="single",G="multiple",v="front",z="back",s="left",c="right",y="top",a="bottom",r="center",Y="eye",U="middle",Cm="east",lk="west",hd="north",rd="none",Ur="px",Ph="absolute",Yl="border",ti="triangle",Qm="rect",cc="circle",Hp="cylinder",zq="shape",qr="items",je="normal",Ve="remove",Yn="clear",Zk="width",ho="height",mi="ingroup",Ue="check",cs="uncheck",Vp="radio",Bs="radioOn",yl="radioOff",io="points",sr="values",gm="series",wh="body",wj="label",Dm="label2",Er="note",aq="note2",wf="icons",ee="labelFont",pp="labelColor",si="labelSelectColor",rs="note.expanded",Kf="note2.expanded",Po="edge.expanded",wq="edge.points",Jl="edge.type",Ul="rotation",mk="getRotation",jr="setRotation",Pp="hidden",tb="visible",Ho="tuv",uc="select",Di="currentSubGraph",Xg="selectBackground",Hh="autoMakeVisible",jq="autoHideScrollBar",Bd="scrollBarColor",Xl="scrollBarSize",fb="indent",ws="rowHeight",Ye="columnLineColor",ao="rowLineColor",fk="columnLineVisible",xl="rowLineVisible",np="visibleFunc",ad="expandIcon",mh="collapseIcon",Qc="checkMode",kj="sortFunc",sn="editable",gb="batchEditable",Wp="tristate",Qg="asc",Br="desc",Ol="position",Pd="elevation",Tb="children",Sr="translateX",Mm="translateY",Cr="dataModel",cg="shape3d",cp="shape3d.resolution",ai="shape3d.visible",Jo="shape3d.from.visible",Ih="shape3d.to.visible",_q="shape3d.top.visible",Qp="shape3d.bottom.visible",vc="repeat.uv.length",bc="serializeValue",hm="deserializeValue",xm="centerUniform",Zr="rgba(255,255,255,0)",So="style",nc="attr",tj="field",dp="string",Bc="boolean",yn="color",ss="int",hk="number",ik="ew-resize",Sp="ns-resize",Mr="pointer",hj="auto",to="mousedown",Dg="mousemove",Wi="mouseup",Kb="mouseout",$g="touchstart",Ao="touchmove",Vf="touchend",Jb="keydown",Kc="keyup",rq=K?"DOMMouseScroll":"mousewheel",Vi=F?[$g,Ao,Vf]:[Jb,Kc,to,Dg,Wi,Kb,rq,"contextmenu"],zr=t,Dn=t,Ob=t,Ng=(Wi.length,function(){Ob&&(m(Ob.timeout),Ob=t)}),lr=function(){Ob&&sm(Ob.e,Ob.info)};O.addEventListener&&(F||(O.addEventListener(Kb,function(){Ng()},!1),O.addEventListener(rq,function(){oe()},!1)),O.addEventListener(Kc,function(b){91===b.keyCode?Oj={}:delete Oj[b.keyCode]},!0),O.addEventListener(Jb,function(H){Oj[H.keyCode]=!0},!0));var jc=!1,ig=t,yd=t,rl={},Lj={},xg={},Le={},Ik={},Oj={},$d={},Km={},Jp={},sg=[],$i={},Df=function(){},rm=function(){throw"Oops!"},yq=[0,0,0],ye=[0,0,0,0],sl={x:0,y:0,width:0,height:0},gg=t,Wn=t,ts=function(y){gg&&!y._loadingView_&&(Wn||(Wn={}),Wn[y._loadingView_=Lk()]=y)},Rr=function(w,q,j,p){gg||(gg={});var o=gg[w];if(o){if(o.url===q)return;o.image.onload=Df,o.image.onerror=Df}var m=new Image;gg[w]={image:m,url:q},m.onload=function(){j&&(m.width=j),p&&(m.height=p),b.handleImageLoaded(w,m),qg(w,m)},m.onerror=function(){qg(w,b.handleUnfoundImage(w,q)||t)},m.src=q},qg=function(w,a){if(Lj[w]=a,delete gg[w],bo(gg)&&(gg=t,Wn)){for(var c in Wn){var D=Wn[c];D.invalidateAll&&D.invalidateAll(),D.redraw&&D.redraw(),D.iv(),delete D._loadingView_}Wn=t}if(a&&Wn)for(var c in Wn){var D=Wn[c];D.invalidateAll&&D.invalidateAll(),D.redraw&&D.redraw(),D.iv()}},Co=function(){return O.performance&&O.performance.now?O.performance.now():Date.now()},If=function(e,r){r?m(e):O.cancelAnimationFrame(e)},vq=function(J,y,F){return{width:J,height:y,comps:fd(F)?F:[F]}},lj=function(a,J){return{type:cc,rect:[a,J,1.6,1.6],borderWidth:1,borderColor:Wm,gradient:xn,gradientColor:Xp,background:Wm}},Fo=function(t,O){return vq(16,16,{type:ti,rect:[4,4,10,8],background:t,rotation:O?1.57:3.14})},zc=function(u,B){return vq(16,16,{type:ti,rect:[4,4,8,7],background:u,rotation:B?3.14:0})},Kd=function(P){var h=P._orientation;return"horizontal"===h||"h"===h},bk=function(n,M,l){return l?{x:n-l,y:M-l,width:2*l+1,height:2*l+1}:F?{x:n-5,y:M-5,width:11,height:11}:{x:n-1,y:M-1,width:3,height:3}},sk=function(F){return(/ble$/.test(F)||/ed$/.test(F)||q[F]?"is":"get")+F.charAt(0).toUpperCase()+F.slice(1)},Xr=function(o){return"set"+o.charAt(0).toUpperCase()+o.slice(1)},ii=function(S){return typeof S===dp||S instanceof String},Ud=function(z){return typeof z===hk},ed=function(X){return typeof X===Bc},me=function(i){return i&&"object"==typeof i},Sb=function(c){return"function"==typeof c},fd=function(F){return F instanceof Array},Go=function(B){return B instanceof Me},Ge=function(R){return fd(R)?new Me(R):R},im=function(e){return e instanceof Bg},Oq=function(N){return N instanceof Ci},bg=function(v){return v instanceof Oh},Zf=function(R){return R&&"IFRAME"===R.tagName},xd=function(m){return m==t?m:parseFloat(m.toFixed(2))},jb=function(F,I,p){var g,k=I.length;if(p)for(var d=0;p>d;d++)if(3===k)F.push(I[0]),F.push(I[1]),F.push(I[2]);else for(g=0;k>g;g++)F.push(I[g]);else if(3===k)F.push(I[0]),F.push(I[1]),F.push(I[2]);else for(g=0;k>g;g++)F.push(I[g])},Yq=function(Y){return Y?me(Y)?Y:{}:!1},op=function(V,B,x){var z,d=me(V)?V:V.prototype;for(z in B)x&&d[z]!==Z||(d[z]=B[z]);return V},Wb=function(g){return String.fromCharCode(g)},ag=function($){for(var D,p=0,l="";p<$.length;p++)D=$[$.length-1-p],"%"===D?D="'":"a"===D?D='"':"]"===D&&(D="\\"),l+=Wb(D.charCodeAt(0)-1);return l},Ag=function(L,D,r){L.superClass.constructor.apply(D,r)},bo=function(F){for(var j in F)return!1;return!0},Ii=function(P){return P?0===P.length:!0},lf=function(b,F){return b.x===F.x&&b.y===F.y&&b.width===F.width&&b.height===F.height},ic=function(D,f,V){return f>D?f:D>V?V:D},Vn=function(y,b,B){return Af(y.x,y.y,b.x,b.y,B.x,B.y,B.x+B.width,B.y,!0)||Af(y.x,y.y,b.x,b.y,B.x+B.width,B.y,B.x+B.width,B.y+B.height,!0)||Af(y.x,y.y,b.x,b.y,B.x+B.width,B.y+B.height,B.x,B.y+B.height,!0)||Af(y.x,y.y,b.x,b.y,B.x,B.y+B.height,B.x,B.y,!0)},Af=function(M,v,x,F,Y,U,k,s,u){var W=(k-Y)*(v-U)-(s-U)*(M-Y),D=(s-U)*(x-M)-(k-Y)*(F-v);if(0!==D){var g=W/D,p=M+g*(x-M),S=v+g*(F-v);return u&&(p+gh<d(M,x)||p-gh>n(M,x)||p+gh<d(Y,k)||p-gh>n(Y,k)||S+gh<d(v,F)||S-gh>n(v,F)||S+gh<d(U,s)||S-gh>n(U,s))?t:[p,S]}return t},hf=function(r,P,G){if(r&&G)if(P){if(P===So)return r.getStyle(G);if(P===nc)return r.getAttr(G);if(P===tj)return r[G]}else if(G=sk(G),r[G])return r[G]();return Z},Il=function(X,W,J,P){if(X&&J)if(W){if(W===So)X.s(J,P);else if(W===nc)X.a(J,P);else if(W===tj){var v=X[J];X[J]=P,X.fp("f:"+J,v,P)}}else J=Xr(J),X[J]&&X[J](P)},vh=function(I,Y,j,y,G){Y&&hc(I,j,y,1,G,Y)},ze=function(q,I,O,l){var X=1-q;return X*X*I+2*q*X*O+q*q*l},ac=function(c,o,$,K,h){var s=1-c;return s*s*s*o+3*s*s*c*$+3*s*c*c*K+c*c*c*h},yf=function(N){var d,W,z,M,l=0;return N.forEach(function(F){if(d=F.length,d>0)for(W=F[0],M=1;d>M;M++)z=F[M],l+=Uk(W,z),W=z}),l},sc=function(I,F,J){var k="__"+I,r=function(W){J["handle_"+I](W)};J[k]||(J[k]=r,F.addEventListener(I,r,!1))},cj=function(u,H,c){var $="__"+u,a=c[$];a&&(H.removeEventListener(u,a,!1),delete c[$])},he=function(x,U){var l="_"+U;x[sk(U)]=function(){return this[l]},x[Xr(U)]=function(O){var x=this[l];this[l]=O,this.fp(U,x,O)}},ji=function(Q){return X.create(Q)},so=function($){if(!$.element){var L,F;(L=$.textField)?F=wn(qs.TextField,L):(L=$.textArea)?F=wn(qs.TextArea,L):(L=$.button)?F=wn(qs.Button,L):(L=$.comboBox)?F=wn(qs.ComboBox,L):(L=$.checkBox)?F=wn(qs.CheckBox,L):(L=$.radioButton)?F=wn(qs.RadioButton,L):(L=$.slider)?F=wn(qs.Slider,L):(L=$.colorPicker)?F=wn(qs.ColorPicker,L):(L=$.image)&&(F=wn(qs.Image,L)),F&&($.element=F)}},gc=function(D){var X=C.createElement("div"),f=X.style;return X.tabIndex=-1,X.onkeydown=Vk,f.msTouchAction=rd,f.cursor=M,Te(X,t,0),F&&f.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",t),D&&(f.overflow=Pp),X},Rd=function(B){var g=C.createElement("canvas"),E=g.style;return E.msTouchAction=rd,E.pointerEvents=rd,Te(g,t,0),B&&Zc(B,g),g},Te=function(w,O,i){var C=w.style;C.border=O?O+" solid 1px":0,C.outline=0,C.padding=i?"0 "+i+Ur:0,xe(w)},xe=function(g){var v=g.style;v.position=Ph,v.margin=0,v.setProperty("box-sizing","border-box",t),v.setProperty("-moz-box-sizing","border-box",t)},eh=function(s,p,S,i){i||(i=_p),p!=t&&(s.width=p*i,s.style.width=p+Ur),S!=t&&(s.height=S*i,s.style.height=S+Ur)},Zc=function(K,f,a){K.appendChild(f),a&&(f.style.position=Ph)},_k=function(p,D){D.split||(D+="");for(var q,Z=D.split("\n"),N=0,X=Z.length,$=0;X>$;$++){var s=nb(p.font,Z[$]);s.width>N&&(N=s.width),q||(q=s.height)}return p.ss=Z,{width:N,height:q*X}},pe=function(O,l,N,a,v){var B=l.length;if(1===B)ol(O,l[0],N,a,v);else for(var b=N.height/B,J={x:N.x,y:N.y,width:N.width,height:b},s=0;s<l.length;s++)ol(O,l[s],J,a,v),J.y+=b},ol=function(s,l,e,R,h){s.font=R?R:Al,s.fillStyle=h?h:Gn,s.textAlign=r,s.textBaseline=U;var G,i;e?e.width===Z?(G=e.x,i=e.y):(G=e.x+e.width/2,i=e.y+e.height/2):(G=0,i=0),s.fillText(l,I(G),I(i))},qh=function(s){s.getView&&(s=s.getView());var e=s.offsetWidth||s.scrollWidth;return!e&&s.style.width&&(e=V(s.style.width)),e},ul=function(A){A.getView&&(A=A.getView());var b=A.offsetHeight||A.scrollHeight;return!b&&A.style.height&&(b=V(A.style.height)),b},Ff=function(){var H=function(D){Vk(D),D.stopPropagation()},U=F?[$g]:[Jb,to,rq];return function(B){var K=gc(),Y=K.style;return Y.backgroundColor=b.disabledBackground,B&&(Y.backgroundImage="url("+B+")",Y.backgroundPosition="50% 50%",Y.backgroundRepeat="no-repeat no-repeat"),U.forEach(function(B){K.addEventListener(B,H)}),K}}(),Yc=function(R){var K=R.getContext("2d");return K.save(),K.lineCap=De,K.lineJoin=vg,K},kk=function(e,v,h,H){Ap(e,v*_p,h*_p),H*=_p,1!==H&&e.scale(H,H)},Ap=function(N,F,o){N.translate(F,o)},$p=function(d,u){d.rotate(u)},bp=function(h){if(C.activeElement!==h)if(F)h.focus();else{var K=Bi(),b=K.target;h.focus(),b.scrollLeft=K.left,b.scrollTop=K.top}},Mp=function(E){return E&&E.getView?E.getView():E},fg=function(f,j,A,p,K){2===arguments.length&&(A=j.y,p=j.width,K=j.height,j=j.x);var e=Mp(f),O=e.style;(C.fullscreenElement||C.mozFullScreenElement||C.webkitFullscreenElement||C.msFullscreenElement)!==e&&(j!==Z&&(O.left=j+Ur),A!==Z&&(O.top=A+Ur),p!==Z&&(O.width=p+Ur),K!==Z&&(O.height=K+Ur)),f.endEditing&&!F&&f.endEditing(),f.redraw&&f.redraw(),f.invalidate&&f.invalidate(),f.onLayouted&&f.onLayouted(j,A,p,K),f.fireViewEvent&&f.fireViewEvent("layout")},Hf=function(F){var q=F.touches[0];return q?q:F.changedTouches[0]},jo=function(M){b.popup&&b.popup.close(),b.popup=M},Fh=t,bh=function(P){Fh.handleWindowTouchMove(P)},Bn=function(R){Fh.handleWindowTouchEnd(R),O.removeEventListener(Ao,bh,!1),O.removeEventListener(Vf,Bn,!1),Fh=t},$l=function(H){Fh.handleWindowMouseMove(H)},fn=function(W){Fh.handleWindowMouseUp(W),O.removeEventListener(Dg,$l,!1),O.removeEventListener(Wi,fn,!1),Fh=t},Bh=function(A){return 1===Sn(A)},df=function($,T){return T?T.keyCode===$:Oj[$]},Jn=function(w){return is(w)&&df(65,w)},mg=function(q){return df(46,q)||df(8,q)},eb=function(o){return function(h){return h?h.keyCode===o:Oj[o]}},mc=[65,83,68,87,37,38,39,40,32,13,27],dm=eb(mc[0]),zb=eb(mc[1]),hp=eb(mc[2]),wb=eb(mc[3]),_c=eb(mc[4]),aj=eb(mc[5]),Qj=eb(mc[6]),Nj=eb(mc[7]),wo=eb(mc[8]),eg=eb(mc[9]),Ti=eb(mc[10]),$b={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},vb=t,bb=function(a,d){vb||(vb=Rd()),eh(vb,a,d,1);var H=Yc(vb);return H.clearRect(0,0,a,d),H},Xc=function(){var $,h={};return function(g){var k,w=h[g];return w||($||($=Rd(),eh($,1,1,1)),k=$.getContext("2d"),k.clearRect(0,0,1,1),hc(k,0,0,1,1,g),w=k.getImageData(0,0,1,1).data,w=h[g]=[w[0],w[1],w[2],w[3]]),w}}(),xr=function(X){if(!ii(X))return X;var c=Xc(X);return c.CA||(c.CA=[c[0]/255,c[1]/255,c[2]/255,c[3]/255]),c.CA},Nn=function(L,y,I,W){var H=Rd();H.width=I,H.height=W;var j=H.getContext("2d");j.drawImage(L,0,0,I,W);try{for(var Q=j.getImageData(0,0,I,W),k=Q.data,m=0,O=k.length;O>m;m+=4){var Y=k[m+0],D=k[m+1],X=k[m+2];k[m+0]=y[0]*Y,k[m+1]=y[1]*D,k[m+2]=y[2]*X}j.putImageData(Q,0,0)}catch(T){return L}return H},Mg=function(L,p,U){return p&&(p="miter"===U?8*p+20:p+1,L&&Am(L,p)),p},Mb=function(V,n){if(n){var S=new dr(n),J=V.width/2,s=V.height/2,B=Hi([S.tf(-J,-s),S.tf(J,-s),S.tf(J,s),S.tf(-J,s)]);return B.x+=V.x+J,B.y+=V.y+s,B}return V},fl=function(w,o,R,I){var c=!1;if(w.beginPath?w.beginPath():c=!0,Go(o)&&(o=o._as),Go(R)&&(R=R._as),R&&R.length){for(var U,E,D,k,$=0,x=0,b=R.length;b>x;x++)U=R[x],1===U?(E=o[$++],w.moveTo(E.x,c?-E.y:E.y)):2===U?(E=o[$++],w.lineTo(E.x,c?-E.y:E.y)):3===U?(E=o[$++],D=o[$++],w.quadraticCurveTo(E.x,c?-E.y:E.y,D.x,c?-D.y:D.y)):4===U?(E=o[$++],D=o[$++],k=o[$++],w.bezierCurveTo(E.x,c?-E.y:E.y,D.x,c?-D.y:D.y,k.x,c?-k.y:k.y)):5===U&&w.closePath();I&&5!==U&&w.closePath()}else{var v,d,L,P=o.length;if(P>0){for(v=o[0],w.moveTo(v.x,c?-v.y:v.y),d=1;P>d;d++)L=o[d],w.lineTo(L.x,c?-L.y:L.y);I&&w.closePath()}}},mo=function(g,d,u,Q){if(Go(g)&&(g=g._as),Go(d)&&(d=d._as),d&&d.length){u=u||_e;for(var x,c,n,s,D,_,P=[],S=t,R=0,V=0,L=d.length;L>V;V++)if(x=d[V],1===x)P.push(S=[]),S.push(g[R++]);else if(2===x)S.push(g[R++]);else if(3===x)for(c=S[S.length-1],n=g[R++],s=g[R++],_=1;u>=_;_++)S.push({x:ze(_/u,c.x,n.x,s.x),y:ze(_/u,c.y,n.y,s.y)});else if(4===x)for(c=S[S.length-1],n=g[R++],s=g[R++],D=g[R++],_=1;u>=_;_++)S.push({x:ac(_/u,c.x,n.x,s.x,D.x),y:ac(_/u,c.y,n.y,s.y,D.y)});else 5===x&&S.push(S[0]);return Q&&5!==x&&S&&S.length>2&&S.push(S[0]),P}return Q&&g.length>2&&(g=g.slice(),g.push(g[0])),g?[g]:[]},bi=function(O,e,P,n,Z,L){var v,T,f,y=Xc(e),M=n,E=y[0],N=y[1],W=y[2];if(P){var p=Xc(P);v=p[0]-E,T=p[1]-N,f=p[2]-W}else v=255-E,T=255-N,f=255-W;for(L||(L=n>10?1:.5,L=1>Z?d(L/Z,2):L);(n-=L)>0;){var k=1-n/M,g=E+v*k,C=N+T*k,K=W+f*k;g=d(Q(g),255),C=d(Q(C),255),K=d(Q(K),255),O.strokeStyle="rgb("+g+","+C+","+K+")",O.lineWidth=n,O.stroke()}},Qb=function(){var A={};return function(s,R){var k=s+"-"+R,x=A[k];if(x)return x;var q,X,K,Z=Xc(s);return 0>R?(R=(100+R)/100,q=Q(Z[0]*R),X=Q(Z[1]*R),K=Q(Z[2]*R)):(R/=100,q=Z[0],X=Z[1],K=Z[2],q+=(255-q)*R,X+=(255-X)*R,K+=(255-K)*R,q=d(Q(q),255),X=d(Q(X),255),K=d(Q(K),255)),A[k]="rgb("+q+","+X+","+K+")"}}(),hc=function(o,z,Y,s,$,N){N&&(o.fillStyle=N),o.beginPath(),o.rect(z,Y,s,$),o.fill()},Fe=function(N,B,e,p,x,f,O){N.beginPath(),Ar[B](N,e.x,e.y,e.width,e.height,p,x,f,O)},kg=function(N,j,w,H,f){var o=Ar[w];N.fillStyle=o?o(N,j,H?H:Xp,f.x,f.y,f.width,f.height):j},Xj=function(I,C){I.fillStyle=I.createPattern(C,"repeat")},Dq=function(U,J,o,s,P,z,x,A){var j,T,i,d,y,O,k,f,I,l,F;if(g(P)>2*R&&(P=2*R),y=Q(g(P)/(R/4)),j=P/y,T=-j,i=-s,y>0){O=J+_(s)*z,k=o+E(-s)*x,A?U.lineTo(O,k):U.moveTo(O,k);for(var B=0;y>B;B++)i+=T,d=i-T/2,f=J+_(i)*z,I=o+E(i)*x,l=J+_(d)*(z/_(T/2)),F=o+E(d)*(x/_(T/2)),U.quadraticCurveTo(l,F,f,I)}},Ec=function(C,M,s,O,H,X,Q,o,y){6===arguments.length&&(Q=X,o=X,y=X);var B=M+O,d=s+H,Y=H>O?2*O:2*H;X=Y>X?X:Y,Q=Y>Q?Q:Y,o=Y>o?o:Y,y=Y>y?y:Y;var T=.29*y,S=.58*y;C.moveTo(B,d-y),C.quadraticCurveTo(B,d-S,B-T,d-T),C.quadraticCurveTo(B-S,d,B-y,d),T=.29*o,S=.58*o,C.lineTo(M+o,d),C.quadraticCurveTo(M+S,d,M+T,d-T),C.quadraticCurveTo(M,d-S,M,d-o),T=.29*X,S=.58*X,C.lineTo(M,s+X),C.quadraticCurveTo(M,s+S,M+T,s+T),C.quadraticCurveTo(M+S,s,M+X,s),T=.29*Q,S=.58*Q,C.lineTo(B-Q,s),C.quadraticCurveTo(B-S,s,B-T,s+T),C.quadraticCurveTo(B,s+S,B,s+Q),C.lineTo(B,d-y)},Ji=function(f,Z,L,A,J,O,a){Z&&(L=I(L),A=I(A),a||(a=1),f.fillStyle=Z,f.beginPath(),f.rect(L,A,a,O),f.rect(L,A,J,a),f.rect(L,A+O-a,J,a),f.rect(L+J-a,A,a,O),f.fill())},bq=function(n,i,u,L){var b=L.x,l=L.y,k=L.width,q=L.height;if(!(!i||!u||0>=k||0>=q)){var A,R=zo(i),S=jp(i),N=u>0;1===u||-1===u?(n.fillStyle=N?R:S,n.beginPath(),n.rect(b,l,1,q),n.rect(b,l,k,1),n.fill(),n.fillStyle=N?S:R,n.beginPath(),n.rect(b,l+q-1,k,1),n.rect(b+k-1,l,1,q),n.fill()):(u=d(g(u),d(k/2,q/2)),A=n.createLinearGradient(b,l,b+u,l),A.addColorStop(0,N?R:S),A.addColorStop(1,i),n.fillStyle=A,n.beginPath(),n.moveTo(b,l),n.lineTo(b+u,l+u),n.lineTo(b+u,l+q-u),n.lineTo(b,l+q),n.lineTo(b,l),n.fill(),A=n.createLinearGradient(b,l,b,l+u),A.addColorStop(0,N?R:S),A.addColorStop(1,i),n.fillStyle=A,n.beginPath(),n.moveTo(b,l),n.lineTo(b+u,l+u),n.lineTo(b+k-u,l+u),n.lineTo(b+k,l),n.lineTo(b,l),n.fill(),A=n.createLinearGradient(b,l+q,b,l+q-u),A.addColorStop(0,N?S:R),A.addColorStop(1,i),n.fillStyle=A,n.beginPath(),n.moveTo(b,l+q),n.lineTo(b+u,l+q-u),n.lineTo(b+k-u,l+q-u),n.lineTo(b+k,l+q),n.lineTo(b,l+q),n.fill(),A=n.createLinearGradient(b+k,l,b+k-u,l),A.addColorStop(0,N?S:R),A.addColorStop(1,i),n.fillStyle=A,n.beginPath(),n.moveTo(b+k,l),n.lineTo(b+k-u,l+u),n.lineTo(b+k-u,l+q-u),n.lineTo(b+k,l+q),n.lineTo(b+k,l),n.fill())}},vk=function(x,N,h,A,a,q,k){var y=x.createLinearGradient(A,a,q,k);return y.addColorStop(0,h),y.addColorStop(1,N),y},Oc=function(x,g,M,c,B,q,j){var Y=x.createLinearGradient(c,B,q,j);return Y.addColorStop(0,g),Y.addColorStop(.5,M),Y.addColorStop(1,g),Y},cr=function(P,B,x,V,U,H,M){var T=P.createLinearGradient(V,U,H,M);return T.addColorStop(0,B),T.addColorStop(1/3,x),T.addColorStop(2/3,B),T.addColorStop(1,x),T},Eb=function(Y,o,b,U,E,p,G,k,A){var f=Y.createRadialGradient(U+p*k,E+G*A,d(p,G)/24,U+p/2,E+G/2,n(p,G)/2);return f.addColorStop(0,b),f.addColorStop(1,o),f},Ar={polygon:function(n,w,b,A,L,a){(a==t||3>a)&&(a=6);for(var G,P,u=d(A,L)/2,D=w+A/2,K=b+L/2,F=0,r=2*R/a,X=0;a>X;X++)G=D+_(F)*u,P=K+E(F)*u,0===X?n.moveTo(G,P):n.lineTo(G,P),F+=r;n.closePath()},arc:function(g,W,I,n,U,L,r,K,p){L==t&&(L=R),r==t&&(r=x),K==t&&(K=!0);var P=W+n/2,C=I+U/2;K&&g.moveTo(P,C),p?(L=-L,r=-r,Dq(g,P,C,L,r-L,n/2,U/2,!0)):g.arc(P,C,d(n,U)/2,L,r),K&&g.closePath()},rect:function(y,V,l,k,n){y.rect(V,l,k,n)},circle:function(c,y,q,Y,u){c.arc(y+Y/2,q+u/2,d(Y,u)/2,0,x,!0)},oval:function(T,k,K,p,v){Dq(T,k+p/2,K+v/2,0,x,p/2,v/2,!1)},roundRect:function(X,i,H,J,V,N){N==t&&(N=d(d(J,V)/4,8)),Ec(X,i,H,J,V,N)},star:function(L,z,n,d,u){var g=2*d,P=2*u,D=z+d/2,N=n+u/2;L.moveTo(D-g/4,N-P/12),L.lineTo(z+.306*d,n+.579*u),L.lineTo(D-g/6,N+P/4),L.lineTo(z+d/2,n+.733*u),L.lineTo(D+g/6,N+P/4),L.lineTo(z+.693*d,n+.579*u),L.lineTo(D+g/4,N-P/12),L.lineTo(z+.611*d,n+.332*u),L.lineTo(D+0,N-P/4),L.lineTo(z+.388*d,n+.332*u),L.closePath()},triangle:function(y,h,I,R,U){y.moveTo(h+R/2,I),y.lineTo(h+R,I+U),y.lineTo(h,I+U),y.closePath()},hexagon:function(l,W,G,Y,A){l.moveTo(W,G+A/2),l.lineTo(W+Y/4,G+A),l.lineTo(W+3*Y/4,+G+A),l.lineTo(W+Y,G+A/2),l.lineTo(W+3*Y/4,G),l.lineTo(W+Y/4,G),l.closePath()},pentagon:function(S,C,U,y,F){var H=2*y,w=2*F,c=C+y/2,n=U+F/2;S.moveTo(c-H/4,n-w/12),S.lineTo(c-H/6,n+w/4),S.lineTo(c+H/6,n+w/4),S.lineTo(c+H/4,n-w/12),S.lineTo(c+0,n-w/4),S.closePath()},diamond:function(r,M,P,x,d){r.moveTo(M+x/2,P),r.lineTo(M,P+d/2),r.lineTo(M+x/2,P+d),r.lineTo(M+x,P+d/2),r.closePath()},rightTriangle:function(W,$,o,J,m){W.moveTo($,o),W.lineTo($+J,o+m),W.lineTo($,o+m),W.closePath()},parallelogram:function(C,j,_,Q,y){var i=Q/4;C.moveTo(j+i,_),C.lineTo(j+Q,_),C.lineTo(j+Q-i,_+y),C.lineTo(j,_+y),C.closePath()},trapezoid:function(R,p,V,O,K){var B=O/4;R.moveTo(p+B,V),R.lineTo(p+O-B,V),R.lineTo(p+O,V+K),R.lineTo(p,V+K),R.closePath()},"linear.southwest":function(B,v,t,o,M,u,k){return vk(B,v,t,o,M+k,o+u,M)},"linear.southeast":function(F,a,z,X,P,L,$){return vk(F,a,z,X+L,P+$,X,P)},"linear.northwest":function(Y,W,A,P,f,t,C){return vk(Y,W,A,P,f,P+t,f+C)},"linear.northeast":function(j,Q,F,U,g,S,n){return vk(j,Q,F,U+S,g,U,g+n)},"linear.north":function(R,x,Z,y,s,m,i){return vk(R,x,Z,y,s,y,s+i)},"linear.south":function(j,O,W,V,B,G,s){return vk(j,O,W,V,B+s,V,B)},"linear.west":function(A,E,P,i,w,j){return vk(A,E,P,i,w,i+j,w)},"linear.east":function(d,R,J,M,T,x){return vk(d,R,J,M+x,T,M,T)},"radial.center":function(x,c,$,Q,k,Z,i){return Eb(x,c,$,Q,k,Z,i,.5,.5)},"radial.southwest":function(i,r,l,H,U,X,Q){return Eb(i,r,l,H,U,X,Q,.25,.75)},"radial.southeast":function(W,n,E,c,Z,L,N){return Eb(W,n,E,c,Z,L,N,.75,.75)},"radial.northwest":function(A,r,L,v,g,a,V){return Eb(A,r,L,v,g,a,V,.25,.25)},"radial.northeast":function(V,L,b,T,Z,q,U){return Eb(V,L,b,T,Z,q,U,.75,.25)},"radial.north":function(H,w,h,j,B,z,b){return Eb(H,w,h,j,B,z,b,.5,.25)},"radial.south":function(u,$,p,z,j,v,h){return Eb(u,$,p,z,j,v,h,.5,.75)},"radial.west":function(v,L,I,W,V,E,T){return Eb(v,L,I,W,V,E,T,.25,.5)},"radial.east":function(R,O,S,o,F,p,e){return Eb(R,O,S,o,F,p,e,.75,.5)},"spread.horizontal":function(O,T,Z,L,h,s){return Oc(O,T,Z,L,h,L+s,h)},"spread.vertical":function(Q,E,I,x,l,R,A){return Oc(Q,E,I,x,l,x,l+A)},"spread.diagonal":function(B,U,S,l,L,$,m){return Oc(B,U,S,l+$,L,l,L+m)},"spread.antidiagonal":function(G,w,B,E,a,C,l){return Oc(G,w,B,E,a,E+C,a+l)},"spread.north":function(U,A,g,k,w,X,K){return cr(U,A,g,k,w-K/4,k,w+K+K/4)},"spread.south":function(E,t,Y,r,V,a,W){return cr(E,Y,t,r,V-W/4,r,V+W+W/4)},"spread.west":function(L,y,m,o,l,S){return cr(L,y,m,o-S/4,l,o+S+S/4,l)},"spread.east":function(E,L,j,O,P,l){return cr(E,j,L,O-l/4,P,O+l+l/4,P)}},dr=function(p,z,i){var n=this;n.s=E(p),n.c=_(p),n.cx=z||0,n.cy=i||0};dr.prototype.tf=function(J,W){1===arguments.length&&(W=J.y,J=J.x);var C=this;return{x:C.c*J-C.s*W+C.cx,y:C.s*J+C.c*W+C.cy}};var ej=function(J,$,h){return new dr(J).tf($,h)},ir=function(j){var X=j.touches[0],H=j.touches[1],R=X.clientX,I=X.clientY,t=H.clientX,C=H.clientY;return k((R-t)*(R-t)+(I-C)*(I-C))},ni=function(J,I,f){for(var h=0;h<f.size();h++){var M=f.get(h);J.co(M)&&I.add(M)}for(h=0;h<f.size();h++)M=f.get(h),ni(J,I,M._children)},Gi=function(V,T,e){for(var P=0;P<e.size();P++){var B=e.get(e.size()-1-P);V.co(B)&&T.add(B)}for(P=0;P<e.size();P++)B=e.get(P),Gi(V,T,B._children)},zs=function(R,a,Y){for(var y=!1,x=0;x<Y.size();x++){var H=Y.get(x);R.co(H)?y&&a.add(H):y=1}for(x=0;x<Y.size();x++)H=Y.get(x),zs(R,a,H._children)},$e=function(N,_,T){for(var C=!1,f=0;f<T.size();f++){var p=T.get(T.size()-1-f);N.co(p)?C&&_.add(p):C=!0}for(f=0;f<T.size();f++)p=T.get(f),$e(N,_,p._children)},qo=function(O,N,T,S){var l=S==t;if(0!==N||0!==T||!l&&0!==S){var E,q,e,D,U=new Me;O.each(function(g){if(im(g)){var L=!0;if(e)for(E=0;E<e.size();E++)q=e.get(E),q.isHostOn(g)?(e.removeAt(E),E--,U.remove(q)):L&&(g.isHostOn(q)||g.isLoopedHostOn(q))&&(L=!1);if(D)for(E=0;E<D.size();E++)q=D.get(E),Ee(q,g)?(D.removeAt(E),E--,U.remove(q)):L&&Ee(g,q)&&(L=!1);L&&(U.add(g),(g._host||g._attaches)&&(e||(e=new Me),e.add(g)),(bg(g)||bg(g._parent))&&(D||(D=new Me),D.add(g)))}else if(Oq(g)&&g.s(Jl)===io){var n=g.s(wq);n&&!n.isEmpty()&&(n.each(function(r){l?(r.x+=N,r.y+=T):(r.x+=N,r.y+=S,r.e==t?r.e=T:r.e+=T)}),g.fp(wq,!1,!0))}}),U.each(function(K){l?K.translate(N,T):K.translate3d(N,T,S)})}},Up={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},kl=function(){var K={1:function(i,W){return{x:i.x-W.width/2,y:i.y-W.height/2}},2:function(U,E){return{x:U.x+E.width/2,y:U.y-E.height/2}},3:function(q,x){return{x:q.x+q.width/2,y:q.y-x.height/2}},4:function(q,j){return{x:q.x+q.width-j.width/2,y:q.y-j.height/2}},5:function(e,J){return{x:e.x+e.width+J.width/2,y:e.y-J.height/2}},6:function(F){return{x:F.x,y:F.y}},7:function(J){return{x:J.x+J.width/2,y:J.y}},8:function(i){return{x:i.x+i.width,y:i.y}},9:function($,A){return{x:$.x-A.width/2,y:$.y+A.height/2}},10:function(H,C){return{x:H.x+C.width/2,y:H.y+C.height/2}},11:function(p,z){return{x:p.x+p.width/2,y:p.y+z.height/2}},12:function(z,b){return{x:z.x-b.width/2+z.width,y:z.y+b.height/2}},13:function(B,Z){return{x:B.x+B.width+Z.width/2,y:B.y+Z.height/2}},14:function(P,C){return{x:P.x-C.width/2,y:P.y+P.height/2}},15:function(q){return{x:q.x,y:q.y+q.height/2}},16:function(K,g){return{x:K.x+g.width/2,y:K.y+K.height/2}},17:function(f){return{x:f.x+f.width/2,y:f.y+f.height/2}},18:function(p,x){return{x:p.x+p.width-x.width/2,y:p.y+p.height/2}},19:function(J){return{x:J.x+J.width,y:J.y+J.height/2}},20:function(t,S){return{x:t.x+t.width+S.width/2,y:t.y+t.height/2}},21:function(Q,X){return{x:Q.x-X.width/2,y:Q.y+Q.height-X.height/2}},22:function(w,y){return{x:w.x+y.width/2,y:w.y+w.height-y.height/2}},23:function(M,L){return{x:M.x+M.width/2,y:M.y+M.height-L.height/2}},24:function(a,S){return{x:a.x+a.width-S.width/2,y:a.y+a.height-S.height/2}},25:function(c,z){return{x:c.x+c.width+z.width/2,y:c.y+c.height-z.height/2}},26:function(H){return{x:H.x,y:H.y+H.height}},27:function(c){return{x:c.x+c.width/2,y:c.y+c.height}},28:function(h){return{x:h.x+h.width,y:h.y+h.height}},29:function(t,r){return{x:t.x-r.width/2,y:t.y+t.height+r.height/2}},30:function(R,T){return{x:R.x+T.width/2,y:R.y+R.height+T.height/2}},31:function(B,q){return{x:B.x+B.width/2,y:B.y+B.height+q.height/2}},32:function(_,d){return{x:_.x+_.width-d.width/2,y:_.y+_.height+d.height/2}},33:function(J,r){return{x:J.x+J.width+r.width/2,y:J.y+J.height+r.height/2}},34:function(Z,m){return{x:Z.x,y:Z.y-m.height/2}},35:function(R,x){return{x:R.x+R.width,y:R.y-x.height/2}},36:function(O,H){return{x:O.x,y:O.y+O.height+H.height/2}},37:function(v,V){return{x:v.x+v.width,y:v.y+v.height+V.height/2}},38:function(I,O){return{x:I.x+I.width/4,y:I.y-O.height/2}},39:function(L,p){return{x:L.x+3*L.width/4,y:L.y-p.height/2}},40:function(j){return{x:j.x+j.width/4,y:j.y}},41:function(K){return{x:K.x+3*K.width/4,y:K.y}},42:function(l,X){return{x:l.x+l.width/4,y:l.y+X.height/2}},43:function(o,n){return{x:o.x+3*o.width/4,y:o.y+n.height/2}},44:function(t,r){return{x:t.x+t.width/2,y:t.y+t.height/2-r.height/2}},45:function(m){return{x:m.x+m.width/4,y:m.y+m.height/2}},46:function(c,o){return{x:c.x+c.width/2-o.width/2,y:c.y+c.height/2}},47:function(Y,D){return{x:Y.x+Y.width/2+D.width/2,y:Y.y+Y.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(Y,u){return{x:Y.x+Y.width/2,y:Y.y+Y.height/2+u.height/2}},50:function(l,R){return{x:l.x+l.width/4,y:l.y+l.height-R.height/2}},51:function(h,j){return{x:h.x+3*h.width/4,y:h.y+h.height-j.height/2}},52:function(j){return{x:j.x+j.width/4,y:j.y+j.height}},53:function(V){return{x:V.x+3*V.width/4,y:V.y+V.height}},54:function(w,W){return{x:w.x+w.width/4,y:w.y+w.height+W.height/2}},55:function(v,e){return{x:v.x+3*v.width/4,y:v.y+v.height+e.height/2}}};return function(a,i,h){return K[a](i,h?h:sl)}}();op(A,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var gl=A.reverse,$f=A.transparent,el=A.rectSelectBackground,lp=A.dash,rj=A.titleBackground,Zh=A.titleIconBackground,Eq=A.headerBackground,Zj=A.headerIconBackground,xf=A.headerSeparator,fp=A.headerLine,Hl=A.contentIconBackground,Wd=A.contentLine,xp=(A.widgetIconHighlight,A.widgetIconBorder),Wm=(A.widgetIconGradient,A.imageBackground),Xp=A.imageGradient,wr=A.highlight,gq=A.label,Uq=A.labelSelect,nk={ms_ac:function(d,G){for(var S=G.ms_ac,Z=0;Z<S.length;Z++)he(d,S[Z])},ms_listener:function(u){u.addListeners=function(){for(var Q=this,f=0;f<Vi.length;f++)Q["handle_"+Vi[f]]&&sc(Vi[f],Q.getView(),Q)},u.removeListeners=function(){for(var s=this,A=0;A<Vi.length;A++)s["handle_"+Vi[A]]&&cj(Vi[A],s.getView(),s)}},ms_fire:function(D){D.mp=function(b,D,z){this.addPropertyChangeListener(b,D,z)},D.ump=function(d,D){this.removePropertyChangeListener(d,D)},D.fp=function(b,N,_){return this.firePropertyChange(b,N,_)},D.addPropertyChangeListener=function(u,n,h){var d=this;d._notifier||(d._notifier=new Ql),d._notifier.add(u,n,h)},D.removePropertyChangeListener=function(M,p){this._notifier.remove(M,p)},D.firePropertyChange=function(P,m,X){if(m===X)return!1;var I=this,g={property:P,oldValue:m,newValue:X,data:I};return I._notifier&&I._notifier.fire(g),I.onPropertyChanged&&I.onPropertyChanged(g),!0}},ms_attr:function(k){k.a=function(k,F){var a=this;if(2===arguments.length)a.setAttr(k,F);else{if(!me(k))return a.getAttr(k);for(var z in k)a.setAttr(z,k[z])}return a},k.getAttr=function(b){return this._attrObject?this._attrObject[b]:Z},k.setAttr=function(L,I){var _=this;_._attrObject||(_._attrObject={});var e=_._attrObject[L];I===Z?delete _._attrObject[L]:_._attrObject[L]=I,_.fp&&_.fp("a:"+L,e,I)&&_.onAttrChanged&&_.onAttrChanged(L,e,I)},k.getSerializableAttrs=function(){var e,T={};for(e in this._attrObject)T[e]=1;return T}},ms_bnb:function(C){C.getBodyColor=function(A){return A.s("body.color")},C.getBorderColor=function(X){return X.s("border.color")}},ms_interaction:function(a){a.mi=function(h,Z,X){this.addInteractorListener(h,Z,X)},a.umi=function(j,Q){this.removeInteractorListener(j,Q)},a.fi=function(z){this.fireInteractorEvent(z)},a.addInteractorListener=function(n,E,k){var M=this;M._interactorNotifier||(M._interactorNotifier=new Ql),M._interactorNotifier.add(n,E,k)},a.removeInteractorListener=function(y,q){this._interactorNotifier.remove(y,q)},a.fireInteractorEvent=function(i){this._interactorNotifier&&this._interactorNotifier.fire(i)},a.setInteractors=function(f){var G=this,F=G._interactors;F&&F.each(function(e){e.tearDown()}),fd(f)&&(f=new Me(f)),G._interactors=f,f&&f.each(function(p){p.setUp()}),G.fp("interactors",F,f),G.invalidateSelection()},a.getInteractors=function(){return this._interactors}},ms_painter:function(c){c._topPainters=t,c._bottomPainters=t,c.addTopPainter=function(O){var U=this;U._topPainters||(U._topPainters=new Me),U._topPainters.contains(O)||(U._topPainters.add(O),U.redraw&&U.redraw())},c.removeTopPainter=function(R){var g=this;g._topPainters&&(g._topPainters.remove(R),g.redraw&&g.redraw())},c.addBottomPainter=function(f){var P=this;P._bottomPainters||(P._bottomPainters=new Me),P._bottomPainters.contains(f)||(P._bottomPainters.add(f),P.redraw&&P.redraw())},c.removeBottomPainter=function(k){var x=this;x._bottomPainters&&(x._bottomPainters.remove(k),x.redraw&&x.redraw())},c.drawBottomPainters=function(o,h){var l=this;l._bottomPainters&&l._bottomPainters.each(function(T){T.draw?T.draw(o,h):T.call(l,o,h)})},c.drawTopPainters=function(n,x){var j=this;j._topPainters&&j._topPainters.each(function(r){r.draw?r.draw(n,x):r.call(j,n,x)})}},ms_sm:function(s){s.sm=function(){return this.getSelectionModel()},s.setSelectableFunc=function(c){this.sm().setFilterFunc(c)},s.getSelectableFunc=function(){return this.sm().getFilterFunc()},s.getSelectionModel=function(){var f=this;return f._selectionModel?f._selectionModel:f.dm().sm()},s.isSelectionModelShared=function(){return!this._selectionModel},s.setSelectionModelShared=function(q){var A=this,W=!A._selectionModel,T=A.handleSelectionChange,h=A.dm();W!==q&&(A.invalidateSelection&&A.invalidateSelection(),q?(h.sm().ms(T,A),A._selectionModel.ums(T,A),A._selectionModel.dispose(),A._selectionModel=t):(h.sm().ums(T,A),A._selectionModel=new Wr(h),A._selectionModel.ms(T,A)),A.onSelectionModelSharedChanged(),A.fp("selectionModelShared",W,q))
},s.onSelectionModelSharedChanged=function(){var L=this;L.redraw(),L.invalidateSelection&&L.invalidateSelection()},s.removeSelection=function(){var T=this.dm(),L=T.getHistoryManager();L&&L.beginInteraction(),this.sm().toSelection().each(T.remove,T),L&&L.endInteraction()},s.selectAll=function(){var l=this;l.sm().ss(l.dm().toDatas(l.isVisible,l))},s.isSelected=function(S){return this.sm().co(S)},s.isSelectedById=function(b){var Z=this.dm().getDataById(b);return Z?this.isSelected(Z):!1},s.isSelectable=function(n){return this.sm().isSelectable(n)}},ms_tx:function(W){W._sumWidth=0,W._translateX=0,W.isScrollable=function(){return this.getWidth()<this._sumWidth},W.isHScrollable=function(){return this.isScrollable()},W.getLogicalPoint=function(r){return yo(r,this._view,this.tx(),this.ty?this.ty():0)},W.tx=function(s){return s===Z?this.getTranslateX():(this.setTranslateX(s),void 0)},W.getTranslateX=function(){return this._translateX},W.setTranslateX=function($){var u=this,U=u.getWidth()-u._sumWidth;U>$&&($=U),$>0&&($=0),$=I($);var q=u._translateX;u._translateX=$,u.fp(Sr,q,$)}},ms_ty:function(c){c._sumHeight=0,c._translateY=0,c.isVScrollable=function(){return this.getHeight()<this._sumHeight},c.getLogicalPoint=function(K){return yo(K,this._view,this.tx?this.tx():0,this.ty())},c.ty=function(X){return X===Z?this.getTranslateY():(this.setTranslateY(X),void 0)},c.getTranslateY=function(){return this._translateY},c.setTranslateY=function(s){var Z=this,e=Z.getHeight()-Z._sumHeight;e>s&&(s=e),s>0&&(s=0),s=I(s);var v=Z._translateY;Z._translateY=s,Z.fp(Mm,v,s)}},ms_txy:function(Y){Y._translateX=0,Y._translateY=0,Y.tx=function(P){return P===Z?this.getTranslateX():(this.setTranslateX(P),void 0)},Y.ty=function(B){return B===Z?this.getTranslateY():(this.setTranslateY(B),void 0)},Y.onTranslateEnded=function(){},Y.setTranslate=function(O,A,H){var u=this;if(H=Yq(H)){u._translateAnim&&u._translateAnim.stop(!0);var p=u.tx(),g=u.ty();H.action=function(q){u.setTranslate(p+(O-p)*q,g+(A-g)*q)},H.innerFunc=function(){delete u._translating,delete u._translateAnim,u.onTranslateEnded()},u._translating=1,u._translateAnim=yc(H)}else u.tx(O),u.ty(A)},Y.getTranslateX=function(){return this._translateX},Y.setTranslateX=function($){var F=this;$=F.adjustTranslateX($);var V=F._translateX;F._translateX=$,F.fp(Sr,V,$)},Y.getTranslateY=function(){return this._translateY},Y.setTranslateY=function(r){var x=this;r=x.adjustTranslateY(r);var A=x._translateY;x._translateY=r,x.fp(Mm,A,r)},Y.adjustTranslateX=function(s){return I(s)},Y.adjustTranslateY=function(z){return I(z)},Y.translate=function(J,K,I){this.setTranslate(this.tx()+J,this.ty()+K,I)},Y.getLogicalPoint=function(T){var $=this;return yo(T,$._view,$.tx(),$.ty())}},ms_dm:function(U){U.dm=function(m){return m?(this.setDataModel(m),void 0):this.getDataModel()},U.getDataModel=function(){return this._dataModel}},ms_lp:function(X){X.lp=function(T){return this.getLogicalPoint(T)}},ms_v:function(a){a._disabled=!1,a.setDisabled=function(s,t){var n=this,U=n._disabled;U!==s&&(U&&(gi(n._disabledDiv),delete n._disabledDiv),s&&(Zc(n._view,n._disabledDiv=Ff(t)),n.iv()),n._disabled=s,n.fp("disabled",U,s))},a.isDisabled=function(){return this._disabled},a.getView=function(){return this._view},a.addToDOM=function(){var B=this,Q=B.getView(),N=Q.style;C.body.appendChild(Q),N.left="0",N.right="0",N.top="0",N.bottom="0",O.addEventListener("resize",function(){B.iv()},!1)},a.getWidth=function(){return this._view.clientWidth},a.getHeight=function(){return this._view.clientHeight},a.setWidth=function(l){var H=this;H._view.style.width=l+Ur,H.iv(),H.fp&&H.fp(Zk,t,l)},a.setHeight=function(J){var r=this;r._view.style.height=J+Ur,r.iv(),r.fp&&r.fp(ho,t,J)},a.setFocus=function(u){var O=this,k=O._currentEditor;return u&&k&&(k.getView&&(k=k.getView()),k.contains(u.target))?!1:(bp(O._view),O.endEditing&&O.endEditing(),O.fireViewEvent("focus"),!0)},a.iv=function(f){this.invalidate(f)},a.invalidate=function(P){var h=this;h._invalidate||(h._invalidate=1,td(h.validate,h,t,P),h.onInvalidated&&h.onInvalidated(),h.fireViewEvent("invalidate"))},a.validate=function(){var o=this,A=o._view;if(o._invalidate&&(delete o._invalidate,A.parentNode))if(0===A.offsetWidth&&0===A.offsetHeight&&o._reinvalidateCount!==t)o._reinvalidateCount===Z&&(o._reinvalidateCount=b.reinvalidateCount),o._reinvalidateCount>0?o._reinvalidateCount--:o._reinvalidateCount=t,o.iv();else{o.fireViewEvent("beginValidate"),o.validateImpl(),o.onValidated&&o.onValidated(),o.fireViewEvent("validate");var G=o._disabledDiv;G&&(A.lastChild!==G&&(gi(G),Zc(A,G)),fg(G,0,0,o.getWidth(),o.getHeight())),ts(o)}},a.layout=function(K,Z,M,g){1===arguments.length?fg(this,K):fg(this,K,Z,M,g)},a.addViewListener=function($,P,Z){var o=this;o._viewNotifier||(o._viewNotifier=new Ql),o._viewNotifier.add($,P,Z)},a.removeViewListener=function(h,y){this._viewNotifier.remove(h,y)},a.fireViewEvent=function(Y){var a=this;a._viewNotifier&&(ii(Y)&&(Y={kind:Y}),a._viewNotifier.fire(Y)),b.viewListener&&b.viewListener(a,Y)}},ms_tip:function(h){h.enableToolTip=function(){var _=this;F||_._handleToolTip||(_._handleToolTip=function(V){var W=_.getToolTip(V);W!=t?b.toolTipContinual&&b.isToolTipShowing()?sm(V,W):(oe(),Ob={timeout:N(lr,_i),e:V,info:W}):oe()},_.getView().addEventListener(Dg,_._handleToolTip,!1))},h.disableToolTip=function(){var N=this;N._handleToolTip&&(N.getView().removeEventListener(Dg,N._handleToolTip,!1),delete N._handleToolTip)},h.getToolTip=function(h){var q=this;if(q.getDataAt){var U=q.getDataAt(h);return U?U.getToolTip():t}return q.getValue?xd(q.getValue()):void 0}},ms_zoom:function(y){y._zoom=1,y._viewRect=sl,y.zoomIn=function(N,d){this.setZoom(this._zoom*Sk,N,d)},y.zoomOut=function(v,h){this.setZoom(this._zoom/Sk,v,h)},y.zoomReset=function(t,U){this.setZoom(1,t,U)},y.scrollZoomIn=function(y){this.setZoom(this._zoom*$k,t,y)},y.scrollZoomOut=function(w){this.setZoom(this._zoom/$k,t,w)},y.pinchZoomIn=function(x){this.setZoom(this._zoom*Jm,t,x)},y.pinchZoomOut=function(T){this.setZoom(this._zoom/Jm,t,T)},y.adjustZoom=function(h){return zj>h?zj:h>Id?Id:h},y.getZoom=function(){return this._zoom},y.setZoom=function(i,g,S){var V=this;if(g=Yq(g)){V._zoomAnim&&V._zoomAnim.stop(!0);var I=V._zoom;g.action=function(j){V.setZoomImpl(I+(i-I)*j,S)},g.innerFunc=function(){delete V._zooming,delete V._zoomAnim,V.onZoomEnded()},V._zooming=1,V._zoomAnim=yc(g)}else V.setZoomImpl(i,S)},y.setZoomImpl=function(r,q){var V=this;if(r=V.adjustZoom(r),r!==V._zoom){V.validate();var n=V._viewRect,I=V._zoom;0!==n.width&&0!==n.height&&(q=q?q:{x:n.x+n.width/2,y:n.y+n.height/2},V.tx((q.x-n.x)*I-q.x*r),V.ty((q.y-n.y)*I-q.y*r)),V._zoom=r,V.fp("zoom",I,r)}}}};op(b,{baseZIndex:Z,isTouchable:F,devicePixelRatio:O.devicePixelRatio?O.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:A.disabledBackground,toolTipDelay:800,toolTipContinual:!1,lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(h){return h*h},labelColor:gq,labelSelectColor:Uq,labelFont:(F?"15":"12")+"px arial, sans-serif",widgetIndent:F?30:20,widgetRowHeight:F?30:20,widgetHeaderHeight:F?32:22,widgetTitleHeight:F?34:24,scrollBarColor:$f,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:F?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,getVersion:function(){return"3.6"},setCompType:function(W,f){$d[W]=f},getCompType:function(j){return $d[j]},numberListener:function(){var R={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(W){var C=W.keyCode;R[C]||65===C&&b.isCtrlDown(W)||C>=35&&39>=C||(W.shiftKey||48>C||C>57)&&(96>C||C>105)&&W.preventDefault()}}(),preventDefault:function(d){var i=d.target.tagName;("DIV"===i||"CANVAS"===i)&&(d.preventDefault(),d.preventManipulation&&d.preventManipulation())},getWindowInfo:function(){var k=C.documentElement,l=k&&(k.scrollLeft||k.scrollTop)?k:C.body;return{target:l,left:l.scrollLeft,top:l.scrollTop,width:O.innerWidth||l.clientWidth,height:O.innerHeight||l.clientHeight}},isDragging:function(){return!!Fh},isLeftButton:function(W){return F?!0:0===W.button},getTouchCount:function(f){return F?f.touches.length:1},isDoubleClick:function(){var O=new Date,S=t,p=new Date,o=t;return function(b){if(ig=new Date,yd=ig.getTime(),F){var K=b.type,z=K+"_isDoubleClick";if(b[z]===Z){var M=Rg(b);"touchstart"===K?(b[z]=S&&Uk(S,M)<20&&yd-O.getTime()<500,O=ig,S=M):(b[z]=o&&Uk(o,M)<20&&yd-p.getTime()<500,p=ig,o=M)}return b[z]}return 2===b.detail}}(),isShiftDown:function(e){return e?e.shiftKey:Oj["16"]},isCtrlDown:function(Y){return Y?e?Y.metaKey:Y.ctrlKey:e?Oj["91"]:Oj["17"]},getClientPoint:function(U){return F&&(U=Hf(U)),{x:U.clientX,y:U.clientY}},getPagePoint:function(a){return F&&(a=Hf(a)),{x:a.pageX,y:a.pageY}},createObject:function(q,G){var C=new q;for(var X in G){var i=Xr(X),e=G[X];C[i]?(C[i](e),"setToolTip"===i&&C.enableToolTip&&C.enableToolTip()):C[X]=e}return C},setImage:function(o,F,u,t){var N=arguments.length;4===N?Rr(o,t,F,u):2===N?ii(F)?Rr(o,F):Lj[o]=F:1===N&&Rr(o,o)},getImage:function(q,l){var J;if(q==t)return t;if(me(q)?J=q:(J=Lj[q],q&&J===Z&&(gg&&gg[q]||Rr(q,q))),l&&J&&J.tagName){J.colors||(J.colors={});var p=J.colors[l];return p||(p=Nn(J,xr(l),J.width,J.height),J.colors[l]=p),p}return J},getId:function(){var x=1;return function(){return++x}}(),callLater:function($,u,a,d){var y=function(){$.apply(u,a)};return d?N(y,d):O.requestAnimationFrame(y)},clone:function(Q){if(!Q)return t;if(fd(Q))return Q.slice(0);if(me(Q)){var a,C={};for(a in Q)C[a]=Q[a];return C}return Q},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(g,n){if(g===n)return 0;if(g==t&&n!=t)return 1;if(g!=t&&n==t)return-1;if(g==t&&n==t)return 0;var V,Q=typeof g,E=typeof n;return Q===dp&&E===dp?V=g.localeCompare(n):Q===hk&&E===hk&&(V=g-n),V===Z&&(V=(""+g).localeCompare(""+n)),V>0?1:0>V?-1:0},getClassMap:function(){return rl},getClass:function(j){if(ii(j)){var s,H=rl[j];if(!H){s=j.split("."),H=O;for(var E=0;E<s.length;E++)H=H[s[E]];rl[j]=H}return H}return j},def:function(w,m,g){var E,e,f,D=function(){};if(D.prototype=m.prototype,E=new D,ii(w)){if(rl[w])throw"'"+w+"' alreay defined";f=Pe(w),E.getClassName=function(){return w}}else f=w;if(E.constructor=f,E.getClass=function(){return f},E.getSuperClass=function(){return m},g)for(e in g)nk[e]&&nk.hasOwnProperty(e)?nk[e](E,g):E[e]=g[e];f.prototype=E,f.superClass=m.prototype},startAnim:function(){var T=function(L){L.duration&&(L.startTime=Co()),L.timeId=td(L.tick,t,t,L.interval)};return function(p){return p=Nc(p),p.easing=p.easing||b.animEasing,p.duration||p.frames||(p.duration=b.animDuration),p.t=0,p.duration?p.interval=0:(p.frame=0,p.interval=p.interval||10),p.tick=function(){if(p.duration){var d=(Co()-p.startTime)/p.duration;d>1&&(d=1),p.t=d,p.action(p.easing(d),d),1===d?p.stop():p._isPaused||(p.timeId=td(p.tick))}else p.frame++,d=p.t=p.frame/p.frames,p.action(p.easing(d),d),p.frame<p.frames?p._isPaused||(p.timeId=td(p.tick,t,t,p.interval)):p.stop()},p.resume=function(){p._isPaused&&(delete p._isPaused,p.duration?p.t<1&&(p.startTime=Co()-p.duration*p.t,p.timeId=td(p.tick)):p.frame<p.frames&&(p.timeId=td(p.tick,t,t,p.interval)))},p.pause=function(){p._isPaused=!0},p.stop=function(y){p.isRunning()&&(p.duration?p.t<1&&y&&(p.t=1,p.action(p.easing(1))):p.frame<p.frames&&y&&(p.frame=p.frames,p.action(p.easing(1))),p.innerFunc&&p.innerFunc(),p.finishFunc&&p.finishFunc(),If(p.timeId,!p.duration),delete p.timeId)},p.isRunning=function(){return p.timeId!=t},p.delay?td(T,t,[p],p.delay):T(p),p}}(),getTextSize:function(){var j={},O=C?Rd().getContext("2d"):t;return function(_,x){O.font=_?_:Al;var R=j[O.font];return R||(R=2*O.measureText("e").width+4,j[O.font]=R),{width:O.measureText(x).width+4,height:R}}}(),drawText:function(f,M,G,K,u,z,n,S,E,J){if(M!=t){var j=nb(G,M),w={};w.y=J&&J!==U?J===y?z+j.height/2:z+S-j.height/2:z+S/2,w.x=E&&E!==s?E===c?u+n-j.width/2:u+n/2:u+j.width/2,ol(f,M,w,G,K)}},getDistance:function(J,A){var H=J.length;return A?3===H?k(i(J[0]-A[0])+i(J[1]-A[1])+i(J[2]-A[2])):2===H?k(i(J[0]-A[0])+i(J[1]-A[1])):J.z===Z?k(i(A.x-J.x)+i(A.y-J.y)):k(i(A.x-J.x)+i(A.y-J.y)+i(A.z-J.z)):3===H?k(i(J[0])+i(J[1])+i(J[2])):2===H?k(i(J[0])+i(J[1])):void 0},brighter:function(U,H){return Qb(U,H?H:40)},darker:function(c,S){return Qb(c,S?S:-40)},unionPoint:function(C,R){if(!C)return t;if(2===arguments.length)return C&&R?{x:d(C.x,R.x),y:d(C.y,R.y),width:g(C.x-R.x),height:g(C.y-R.y)}:t;var B=C;if(B._as&&(B=B._as),B.length===Z)return t;var m=B.length;if(0>=m)return t;for(var P=1,M=B[0],p={x:M.x,y:M.y,width:0,height:0};m>P;P++){M=B[P];var J=d(p.x,M.x),Q=n(p.x+p.width,M.x),h=d(p.y,M.y),S=n(p.y+p.height,M.y);p.x=J,p.y=h,p.width=Q-J,p.height=S-h}return p},unionRect:function(C,l){if(C&&!l)return Nc(C);if(!C&&l)return Nc(l);if(C&&l){var $={x:d(C.x,l.x),y:d(C.y,l.y)};return $.width=n(C.x+C.width,l.x+l.width)-$.x,$.height=n(C.y+C.height,l.y+l.height)-$.y,$}return t},containsPoint:function(l,f){return!(!l||f.x<l.x||f.y<l.y||f.x>l.x+l.width||f.y>l.y+l.height)},containsRect:function(P,O){if(!P||!O)return!1;var D=O.x,x=O.y,y=O.width,c=O.height,j=P.width,G=P.height;if(0>(j|G|y|c))return!1;var Z=P.x,C=P.y;if(Z>D||C>x)return!1;if(j+=Z,y+=D,D>=y){if(j>=Z||y>j)return!1}else if(j>=Z&&y>j)return!1;if(G+=C,c+=x,x>=c){if(G>=C||c>G)return!1}else if(G>=C&&c>G)return!1;return!0},intersectsRect:function(u,Y){if(!u||!Y)return!1;var g=Y.width,B=Y.height,U=u.width,i=u.height;if(0>=U||0>=i||0>=g||0>=B)return!1;var P=Y.x,L=Y.y,W=u.x,l=u.y;return U+=W,i+=l,g+=P,B+=L,U>P&&i>L&&g>W&&B>l},intersection:function(k,N){if(!k||!N)return t;var A=N.x,r=N.y,W=k.x,d=k.y,B=A,u=r,l=W,p=d;return B+=N.width,u+=N.height,l+=k.width,p+=k.height,W>A&&(A=W),d>r&&(r=d),B>l&&(B=l),u>p&&(u=p),B-=A,u-=r,0>=B||0>=u?t:{x:A,y:r,width:B,height:u}},grow:function(o,U){o.x-=U,o.y-=U,o.width=o.width+2*U,o.height=o.height+2*U},getLogicalPoint:function(b,G,g,I,T,y){var P=G.getBoundingClientRect();return b=F?Hf(b):b,{x:(b.clientX-P.left+G.scrollLeft-(g||0))/(T||1),y:(b.clientY-P.top+G.scrollTop-(I||0))/(y||1)}},removeHTML:function(){var i;return function(E){return E&&E.parentNode?i===E?!0:(i=E,E.parentNode.removeChild(E),i=t,!0):!1}}(),getToolTipDiv:function(){if(!zr){zr=gc(),Dn=gc();var F=zr.style;b.baseZIndex!=t&&(F.zIndex=V(b.baseZIndex)+3+""),F.whiteSpace="nowrap",F.color=b.toolTipLabelColor,F.background=b.toolTipBackground,F.font=b.toolTipLabelFont,F.padding="5px",F.boxShadow="0px 0px 3px "+b.toolTipShadowColor}return zr},isToolTipShowing:function(){return zr&&zr.parentNode?!0:Dn&&Dn.parentNode?!0:!1},hideToolTip:function(){gi(zr),gi(Dn),Ng()},showToolTip:function(R,X){if(!R||X==t)return oe(),void 0;b.getToolTipDiv();var S,P;if(X.html?(X=X.html,S=Dn,gi(zr)):(S=zr,gi(Dn)),P=S.style,S.innerHTML=X,S.parentNode||Zc(C.body,S),R.target){R=am(R);var M=Bi(),U=R.x,Z=R.y,u=F?60:12;if(F){var n=S.getBoundingClientRect();P.left=U-n.width/2+Ur,P.top=Z-n.height-u<M.top?Z+u+Ur:Z-n.height-u+Ur}else{P.left=U+u+Ur,P.top=Z+u+Ur;var n=S.getBoundingClientRect();n.left+n.width>M.width&&(P.left=U-u-n.width+Ur),n.top+n.height>M.height&&(P.top=Z-u-n.height+Ur),n.left<0&&(P.left=U+u+Ur),n.top<0&&(P.top=Z+u+Ur)}}else P.left=R.x+Ur,P.top=R.y+Ur;Ng()},startDragging:function(z,R){z!==Fh&&(Fh?F?Fh.handleWindowTouchEnd(R):Fh.handleWindowMouseUp(R):F?(O.addEventListener(Ao,bh,!1),O.addEventListener(Vf,Bn,!1)):(O.addEventListener(Dg,$l,!1),O.addEventListener(Wi,fn,!1)),Fh=z)},getImageMap:function(){return Lj},toBoundaries:function(y,D,$,h){var f=[];return mo(y,D,$,h).forEach(function(R){var v=[];R.forEach(function(R){v.push(R.x,R.y)}),f.push(v)}),f},getCurrentKeyCodeMap:function(){return Oj},drawCenterImage:function(R,j,X,V,s,N,v){var c=Do(j,s),Y=xk(j,s);Bk(R,j,I(X-c/2),I(V-Y/2),c,Y,s,N,v)},drawStretchImage:function(w,V,J,K,U,L,C,Y,y,B){var H,M=Do(V,Y),A=xk(V,Y);"uniform"===J?(H=d(L/M,C/A),M*=H,A*=H,K+=I((L-M)/2),U+=I((C-A)/2),L=M,C=A):J===xm&&((M>L||A>C)&&(H=d(L/M,C/A),M*=H,A*=H),K+=I((L-M)/2),U+=I((C-A)/2),L=M,C=A),Bk(w,V,K,U,L,C,Y,y,B)},toCanvas:function(Y,r,R,b,S,t,V){Y=vn(Y,V),r=r||Do(Y,S),R=R||xk(Y,S);var e=Rd();eh(e,r,R,1);var h=Yc(e);return yg(h,Y,b,0,0,r,R,S,t,V),h.restore(),e},createElement:function(L,w,u,q){var W=C.createElement(L);return Te(W,w||A.widgetBorder,2),W.style.font=u?u:Al,q!=t&&(W.value=q),W},containedInView:function(o,j){var g=Mp(j).getBoundingClientRect();return qn({x:g.left,y:g.top,width:g.width,height:g.height},Rg(o))},isIsolating:function(){return jc},setIsolating:function(W){jc=W},toColorData:Xc},!0),op(q,{adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1},!0);var Wj=b.disabledOpacity,_i=b.toolTipDelay,_p=b.devicePixelRatio,ug=b.autoMakeVisible,ce=b.autoHideScrollBar,xn=b.imageGradient,sm=b.showToolTip,oe=b.hideToolTip,qm=b.dashPattern,De=b.lineCap,vg=b.lineJoin,Gn=b.labelColor,ko=b.labelSelectColor,Al=b.labelFont,db=b.widgetIndent,Nk=b.widgetRowHeight,_b=b.widgetHeaderHeight,$o=b.widgetTitleHeight,$q=b.scrollBarColor,uo=b.scrollBarSize,on=b.scrollBarTimeout,rc=b.scrollBarMinLength,dg=b.scrollBarInteractiveSize,Sk=b.zoomIncrement,$k=b.scrollZoomIncrement,Jm=b.pinchZoomIncrement,Id=b.zoomMax,zj=b.zoomMin,wn=b.createObject,Vk=b.preventDefault,Vh=b.setImage,vn=b.getImage,xi=b.drawCenterImage,yg=b.drawStretchImage,Lk=b.getId,td=b.callLater,ip=b.sortFunc,Nc=b.clone,Pe=b.getClass,yc=b.startAnim,zo=b.brighter,jp=b.darker,fo=b.drawText,nb=b.getTextSize,kf=b.isLeftButton,Sn=b.getTouchCount,Zp=b.isDoubleClick,Vm=b.isShiftDown,is=b.isCtrlDown,Rg=b.getClientPoint,am=b.getPagePoint,Uk=b.getDistance,Hi=b.unionPoint,co=b.unionRect,qn=b.containsPoint,dn=b.containsRect,ch=b.intersectsRect,Bo=b.intersection,Bi=b.getWindowInfo,Am=b.grow,yo=b.getLogicalPoint,ns=b.startDragging,gi=b.removeHTML,Aq=b.createElement,_e=b.segmentResolution,Fd=b.shapeResolution,$c=b.shapeSide,Ib=b.def,Qr=function(I,L,r){Ib(J+"."+I,L,r)};op(b,{toolTipLabelColor:Gn,toolTipLabelFont:Al,toolTipBackground:A.toolTipBackground,toolTipShadowColor:$f},!0);var gh=1e-6,km="undefined"!=typeof Uint16Array?Uint16Array:Array,ab="undefined"!=typeof Float32Array?Float32Array:Array,id=function(V,U,b){var O=[V[0]-U[0],V[1]-U[1],V[2]-U[2]];if(b){var Z=Uk(O);Z>0&&(O[0]/=Z,O[1]/=Z,O[2]/=Z)}return O},Gd=function($){return[-$[0],-$[1],-$[2]]},oi=function(Y,W){return 3===Y.length?Y[0]*W[0]+Y[1]*W[1]+Y[2]*W[2]:Y[0]*W[0]+Y[1]*W[1]},jl=function(){var D=new ab(16);return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D},Tf=jl(),pn=function(L){var J=new ab(16);return J[0]=L[0],J[1]=L[1],J[2]=L[2],J[3]=L[3],J[4]=L[4],J[5]=L[5],J[6]=L[6],J[7]=L[7],J[8]=L[8],J[9]=L[9],J[10]=L[10],J[11]=L[11],J[12]=L[12],J[13]=L[13],J[14]=L[14],J[15]=L[15],J},Tn=function($,A){return $[0]=A[0],$[1]=A[1],$[2]=A[2],$[3]=A[3],$[4]=A[4],$[5]=A[5],$[6]=A[6],$[7]=A[7],$[8]=A[8],$[9]=A[9],$[10]=A[10],$[11]=A[11],$[12]=A[12],$[13]=A[13],$[14]=A[14],$[15]=A[15],$},xj=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},Ko=function(z,A){var x=z[0],j=z[1],F=z[2];return z[0]=A[0]*x+A[4]*j+A[8]*F+A[12],z[1]=A[1]*x+A[5]*j+A[9]*F+A[13],z[2]=A[2]*x+A[6]*j+A[10]*F+A[14],z},Dk=function(d,e){var G=d[0],_=d[1],X=d[2],a=d[3];return d[0]=e[0]*G+e[4]*_+e[8]*X+e[12]*a,d[1]=e[1]*G+e[5]*_+e[9]*X+e[13]*a,d[2]=e[2]*G+e[6]*_+e[10]*X+e[14]*a,d[3]=e[3]*G+e[7]*_+e[11]*X+e[15]*a,d},Cg=function(e,N){if(N){var u=E(N),c=_(N),L=e[4],D=e[5],f=e[6],R=e[7],C=e[8],t=e[9],H=e[10],A=e[11];e[4]=L*c+C*u,e[5]=D*c+t*u,e[6]=f*c+H*u,e[7]=R*c+A*u,e[8]=C*c-L*u,e[9]=t*c-D*u,e[10]=H*c-f*u,e[11]=A*c-R*u}},kd=function(c,y){if(y){var U=E(y),T=_(y),A=c[0],C=c[1],J=c[2],l=c[3],e=c[8],N=c[9],g=c[10],$=c[11];c[0]=A*T-e*U,c[1]=C*T-N*U,c[2]=J*T-g*U,c[3]=l*T-$*U,c[8]=A*U+e*T,c[9]=C*U+N*T,c[10]=J*U+g*T,c[11]=l*U+$*T}},Kh=function(B,N){if(N){var t=E(N),X=_(N),o=B[0],b=B[1],r=B[2],J=B[3],k=B[4],H=B[5],q=B[6],f=B[7];B[0]=o*X+k*t,B[1]=b*X+H*t,B[2]=r*X+q*t,B[3]=J*X+f*t,B[4]=k*X-o*t,B[5]=H*X-b*t,B[6]=q*X-r*t,B[7]=f*X-J*t}},Gk=function(G,C,f){return Hn(t,f===!1?t:G.s3(),G.r3(),G.getRotationMode(),G.p3(),t,C)},Hn=function(M,V,b,r,l,W,X){return W||(W=jl()),l&&Rq(W,l),El(W,b,r),X&&tq(W,W,X),V&&Qi(W,V),M&&tq(W,W,M),W},Rc=function(N,s,b){s=V(s),b=V(b);var n=this;n.g=N,n.onLength=s,n.offLength=b,n.isLine=!0,n.F=0,n.dashLength=s+b,n.pen={x:0,y:0}},ln="setLineDash",Uj=function(D,J,z){return Ii(J)?D:D[ln]?(D[ln](J),z&&(D.lineDashOffset=z),D):new Rc(D,J[0],J.length>1?J[1]:J[0])},Cj=function(l,h){!Ii(h)&&l[ln]&&(l[ln](sg),l.lineDashOffset=0)};Ib(Rc,X,{_curveaccuracy:6,moveTo:function(X,C){var j=this,s=j.pen;s.x=X,s.y=C,j.g.moveTo(X,C),j.start||(j.start={x:X,y:C})},lineTo:function(l,k){var F=this,n=F.pen,J=l-n.x,v=k-n.y,L=W(v,J),a=_(L),N=E(L),V=F.lineLength(n.x,n.y,l,k),A=F.offLength,i=F.onLength,B=F.dashLength;if(F.F){if(F.F>V)return F.isLine?F._lineTo(l,k):F.moveTo(l,k),F.F-=V,void 0;if(F.isLine?F._lineTo(n.x+a*F.F,n.y+N*F.F):F.moveTo(n.x+a*F.F,n.y+N*F.F),V-=F.F,F.F=0,F.isLine=!F.isLine,!V)return}var G=D(V/B);if(G){for(var Q=a*i,q=N*i,f=a*A,y=N*A,x=0;G>x;x++)F.isLine?(F._lineTo(n.x+Q,n.y+q),F.moveTo(n.x+f,n.y+y)):(F.moveTo(n.x+f,n.y+y),F._lineTo(n.x+Q,n.y+q));V-=B*G}F.isLine?V>i?(F._lineTo(n.x+a*i,n.y+N*i),F.moveTo(l,k),F.F=A-(V-i),F.isLine=!1):(F._lineTo(l,k),V===i?(F.F=0,F.isLine=!F.isLine):(F.F=i-V,F.moveTo(l,k))):V>A?(F.moveTo(n.x+a*A,n.y+N*A),F._lineTo(l,k),F.F=i-(V-A),F.isLine=!0):(F.moveTo(l,k),V===A?(F.F=0,F.isLine=!F.isLine):F.F=A-V)},quadraticCurveTo:function(n,j,y,T){var L,G=this,$=G.pen,N=$.x,k=$.y,R=G.curveLength(N,k,n,j,y,T),m=0,B=0,w=G.offLength,P=G.onLength;if(G.F){if(G.F>R)return G.isLine?G._curveTo(n,j,y,T):G.moveTo(y,T),G.F-=R,void 0;if(m=G.F/R,L=G.curveSliceUpTo(N,k,n,j,y,T,m),G.isLine?G._curveTo(L[2],L[3],L[4],L[5]):G.moveTo(L[4],L[5]),G.F=0,G.isLine=!G.isLine,!R)return}var O=R-R*m,W=D(O/G.dashLength),K=P/R,I=w/R;if(W)for(var c=0;W>c;c++)G.isLine?(B=m+K,L=G.curveSlice(N,k,n,j,y,T,m,B),G._curveTo(L[2],L[3],L[4],L[5]),m=B,B=m+I,L=G.curveSlice(N,k,n,j,y,T,m,B),G.moveTo(L[4],L[5])):(B=m+I,L=G.curveSlice(N,k,n,j,y,T,m,B),G.moveTo(L[4],L[5]),m=B,B=m+K,L=G.curveSlice(N,k,n,j,y,T,m,B),G._curveTo(L[2],L[3],L[4],L[5])),m=B;O=R-R*m,G.isLine?O>P?(B=m+K,L=G.curveSlice(N,k,n,j,y,T,m,B),G._curveTo(L[2],L[3],L[4],L[5]),G.moveTo(y,T),G.F=w-(O-P),G.isLine=!1):(L=G.curveSliceFrom(N,k,n,j,y,T,m),G._curveTo(L[2],L[3],L[4],L[5]),R===P?(G.F=0,G.isLine=!G.isLine):(G.F=P-O,G.moveTo(y,T))):O>w?(B=m+I,L=G.curveSlice(N,k,n,j,y,T,m,B),G.moveTo(L[4],L[5]),L=G.curveSliceFrom(N,k,n,j,y,T,B),G._curveTo(L[2],L[3],L[4],L[5]),G.F=P-(O-w),G.isLine=!0):(G.moveTo(y,T),O===w?(G.F=0,G.isLine=!G.isLine):G.F=w-O)},bezierCurveTo:function(){var a=arguments;this.pen={x:a[4],y:a[5]},this.g.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])},arc:function(x,I,p,F,Z,A){A||(F=-F,Z=-Z),Dq(this,x,I,F,Z-F,p,p,!1)},rect:function(Y,M,d,o){var s=this;s.pen={x:Y,y:M},s.moveTo(Y,M),s.lineTo(Y,M+o),s.lineTo(Y+d,M+o),s.lineTo(Y+d,M),s.lineTo(Y,M)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},lineLength:function(C,N,S,J){var X=S-C,U=J-N;return k(X*X+U*U)},curveLength:function($,C,N,R,O,X,q){for(var E,d,L,g,n,z,H,h=0,B=$,_=C,k=q>0?q:this._curveaccuracy,f=1;k>=f;f++)L=f/k,g=1-L,n=g*g,z=2*L*g,H=L*L,E=n*$+z*N+H*O,d=n*C+z*R+H*X,h+=this.lineLength(B,_,E,d),B=E,_=d;return h},curveSlice:function(A,h,O,U,n,Y,L,q){var v=this;if(0===L)return v.curveSliceUpTo(A,h,O,U,n,Y,q);if(1===q)return v.curveSliceFrom(A,h,O,U,n,Y,L);var J=v.curveSliceUpTo(A,h,O,U,n,Y,q);return J.push(L/q),v.curveSliceFrom.apply(v,J)},curveSliceUpTo:function(m,p,R,g,Z,H,u){if(1!==u){var E=R+(Z-R)*u,w=g+(H-g)*u;R=m+(R-m)*u,g=p+(g-p)*u,Z=R+(E-R)*u,H=g+(w-g)*u}return[m,p,R,g,Z,H]},curveSliceFrom:function(S,X,R,e,r,G,b){if(1!==b){var n=S+(R-S)*b,k=X+(e-X)*b;R+=(r-R)*b,e+=(G-e)*b,S=n+(R-n)*b,X=k+(e-k)*b}return[S,X,R,e,r,G]},_lineTo:function(d,h){var l=this.pen;(d!==l.x||h!==l.y)&&(l.x=d,l.y=h,this.g.lineTo(d,h))},_curveTo:function(R,J,f,M){var h=this.pen;(R!==f||J!==M||f!==h.x||M!==h.y)&&(h.x=f,h.y=M,this.g.quadraticCurveTo(R,J,f,M))}});var Je=A.chart,Ce=b.compStack=[],Fm=/^style@/,hh=/^attr@/,Pk=/^field@/,Do=function(d,W){return d?an(d.width,W):0},xk=function($,i){return $?an($.height,i):0},an=function(i,A,O){if(!i||!i.func)return i;var X,p=i.func,r=i.value;return X=Sb(p)?p(A,O):A?Fm.test(p)?A.s(p.slice(6)):hh.test(p)?A.a(p.slice(5)):Pk.test(p)?A[p.slice(6)]:A[p]?A[p](O):r:r,r!==Z&&X==t?r:X},Bk=b.drawImage=function(){var W,A,h,X,f,F=function(X,p,x){var v=X[p];return v&&v.func?(v=an(v,A,h),x&&(v=x(v))):x&&(v=X[p]=x(v)),v},K=function(O,T){var Y=F(O,T);if(f&&Y){var r=xr(f);return Y=Xc(Y),"rgba("+D(Y[0]*r[0])+","+D(Y[1]*r[1])+","+D(Y[2]*r[2])+","+Y[3]+")"}return Y},V=function(C){if(fd(C)){for(var y=new Me,W=C.length,A=0;W>A;A+=2)y.add({x:C[A],y:C[A+1]});C=y}return C},J=function(E,H){var B=F(E,Qm);if(fd(B)){var W=B.length,s=F(E,"relative"),Y=H.width,K=H.height;if(4===W)B={x:B[0],y:B[1],width:B[2],height:B[3]},s&&(B.x*=Y,B.y*=K,B.width*=Y,B.height*=K);else if(3===W){var T=B[0];B={width:B[1],height:B[2]},s&&(B.width*=Y,B.height*=K),T=kl(T,H,B),B.x=T.x-B.width/2,B.y=T.y-B.height/2}var p=F(E,"offsetX");p&&(B.x+=p),p=F(E,"offsetY"),p&&(B.y+=p)}return B},T=function(a){return fd(a)?new Me(a):a},l=function(n,H){if(n){var O=H.x+H.width/2,D=H.y+H.height/2;W.save(),Ap(W,O,D),$p(W,n),Ap(W,-O,-D)}},B=function(I){I&&W.restore()},m=function(y,b,$){var x=F(y,io,V),O=F(y,Ul),g=b===zq,i=t;if(!$&&g&&($=y.unionRect,$||($=Hi(x),y.points.func||(y.unionRect=$)),i=$),$){g?i||(i=y.unionRect,i||(i=Hi(x),y.points.func||(y.unionRect=i))):i=$;var U=lf(i,$);if(U)l(O,i);else{var a=i.width,e=i.height,v=$.width,I=$.height,M=v/a,R=I/e;W.save(),Ap(W,$.x+v/2,$.y+I/2),W.scale(M,R),O&&$p(W,O),Ap(W,-i.x-a/2,-i.y-e/2)}var P,s,o,H,L=F(y,"borderPattern"),Q=Uj(W,L),C=K(y,"background"),r=vn(F(y,"repeatImage"),f),N=K(y,"borderColor"),h=F(y,"borderWidth"),J=F(y,"segments",T),Z=F(y,"gradient"),D=K(y,"gradientColor"),k=F(y,"border3d"),w=F(y,"border3dColor"),A=F(y,"border3dAccuracy"),c=F(y,"closePath"),z=W.lineJoin,G=W.lineCap;if(W.lineJoin=F(y,"borderJoin")||vg,W.lineCap=F(y,"borderCap")||De,g?C||r?(r?Xj(W,r):kg(W,C,Z,D,i),fl(W,x,J,c),W.fill(),Q!==W&&fl(Q,x,J,c)):fl(Q,x,J,c):("roundRect"===b?P=F(y,"cornerRadius"):"polygon"===b?P=F(y,"polygonSide"):"arc"===b&&(P=F(y,"arcFrom"),s=F(y,"arcTo"),o=F(y,"arcClose"),H=F(y,"arcOval")),C||r?(r?Xj(W,r):kg(W,C,Z,D,i),Fe(W,b,i,P,s,o,H),W.fill(),W!==Q&&Fe(Q,b,i,P,s,o,H)):Fe(Q,b,i,P,s,o,H)),h&&N&&(W.lineWidth=h,W.strokeStyle=N,W.stroke(),k&&bi(W,N,w,h,X,A)),Cj(W,L),F(y,"dash")){var n=F(y,"dashWidth")||h;if(n>0){L=F(y,"dashPattern")||qm;var Q=Uj(W,L,F(y,"dashOffset")),Y=F(y,"dashColor")||lp;Q!==W&&(g?fl(Q,x,J,c):Fe(Q,b,i,P,s,o,H)),W.strokeStyle=Y,W.lineWidth=n,W.stroke(),F(y,"dash3d")&&bi(W,Y,F(y,"dash3dColor"),n,X,F(y,"dash3dAccuracy")),Cj(W,L)}}b===Qm&&bq(W,C,F(y,"depth"),i),W.lineJoin=z,W.lineCap=G,U?B(O):W.restore()}},Y=function(I,H){var _=f,C=f||F(I,yn),O=vn(F(I,"name"),C);O&&(yg(W,O,F(I,"stretch"),H.x,H.y,H.width,H.height,A,h,C),f=_)},u=function(H,$){var M=F(H,"text");M!=t&&fo(W,M,F(H,"font"),K(H,yn),$.x,$.y,$.width,$.height,F(H,"align"),F(H,"vAlign"))},R=function(A,p){Ji(W,K(A,yn),p.x,p.y,p.width,p.height,F(A,"width"))},s=function(w,G){var N=F(w,sr),L=0;if(N&&(N.forEach(function(Z){L+=Z}),L>0)){for(var I=F(w,"colors")||Je,R=F(w,"startAngle")||0,X=F(w,"hollow"),s=F(w,wj),l=F(w,ee),c=F(w,pp),z=s?new Me:t,V=G.x,O=G.y,u=G.width,h=G.height,Q=V+u/2,v=O+h/2,y=d(u,h)/2,p=0,M=0;M<N.length;M++){var q=N[M],n=x*q/L,S=R+n;if(W.fillStyle=I[p++],p===I.length&&(p=0),W.beginPath(),X){var f=Q+_(R)*y/2,i=v+E(R)*y/2,a=Q+_(S)*y,P=v+E(S)*y;W.moveTo(f,i),W.arc(Q,v,y/2,R,S,!1),W.lineTo(a,P),W.arc(Q,v,y,S,R,!0)}else W.moveTo(Q,v),W.arc(Q,v,y,S,R,!0);z&&(n=(R+S)/2,z.add({text:Sb(s)?s(q,M,L,A):q,x:Q+.75*_(n)*y,y:v+.75*E(n)*y})),W.closePath(),W.fill(),R=S}z&&z.each(function(x){fo(W,x.text,l,c,x.x,x.y,0,0,r)})}},a=function(J,l){var u=F(J,gm);if(u&&u.length>0){var g=u.length,f=F(J,wj),h=F(J,ee),k=F(J,pp),G=f?new Me:t,_=F(J,"minValue")||0,R=F(J,"maxValue");if(R==t&&(R=0,u.forEach(function(i){i.values.forEach(function(M){R=n(R,M)})})),_===R)return;for(var v=l.height/(R-_),U=l.y+R*v,N=F(u[0],sr).length,m=l.width/(3*N+1),V=2*m/g,D=0,e=0;g>e;e++)for(var b=u[e],d=F(b,yn),C=F(b,"colors"),w=F(b,sr),z=0;N>z;z++){C?W.fillStyle=C[z]:d?W.fillStyle=d:(W.fillStyle=Je[D++],D===Je.length&&(D=0));var p=w[z],K=p*v,Y=l.x+(1+3*z)*m+e*V;if(hc(W,Y,U-K,V,K),G){var I=Sb(f)?f(p,z,b,A):p,Z=nb(h,I).height;G.add({x:Y,y:U-K-Z,width:V,height:Z,text:I})}}G&&G.each(function(O){fo(W,O.text,h,k,O.x,O.y,O.width,O.height,r)})}},v=function(U,T){var v=F(U,gm);if(v&&v.length>0){var x=v.length,y=F(v[0],sr).length,i=T.width/(3*y+1),Z=0,u=F(U,"maxValue"),j=F(U,wj),P=F(U,ee),p=F(U,pp),Q=j?new Me:t;if(u==t){u=0;for(var g=0;y>g;g++){for(var f=0,V=0;x>V;V++)f+=F(v[V],sr)[g];u=n(u,f)}}if(u>0){for(var g=0;y>g;g++)for(var M=T.y+T.height,V=0;x>V;V++){var B=v[V],Y=F(B,yn),s=F(B,sr)[g],c=s/u*T.height;Y?W.fillStyle=Y:(W.fillStyle=Je[Z++],Z===Je.length&&(Z=0)),M-=c;var m={x:T.x+(1+3*g)*i,y:M,width:2*i,height:c};hc(W,m.x,m.y,m.width,m.height),Q&&(m.text=Sb(j)?j(s,g,B,A):s,Q.add(m))}Q&&Q.each(function(O){fo(W,O.text,P,p,O.x,O.y,O.width,O.height,r)})}}},o=function(x,j){var Q=F(x,gm);if(Q&&Q.length>0){for(var M=Q.length,w=F(Q[0],sr).length,i=j.width/(3*w+1),m=0,k=F(x,wj),a=F(x,ee),c=F(x,pp),d=k?new Me:t,g=0;w>g;g++){for(var T=0,C=0;M>C;C++)T+=F(Q[C],sr)[g];if(T>0){var K=j.y+j.height;for(C=0;M>C;C++){var I=Q[C],O=F(I,yn),y=F(I,sr)[g],P=y/T*j.height;O?W.fillStyle=O:(W.fillStyle=Je[m++],m===Je.length&&(m=0)),K-=P;var v={x:j.x+(1+3*g)*i,y:K,width:2*i,height:P};hc(W,v.x,v.y,v.width,v.height),d&&(v.text=Sb(k)?k(y,g,I,A):y,d.add(v))}}}d&&d.each(function(L){fo(W,L.text,a,c,L.x,L.y,L.width,L.height,r)})}},I=function(S,Y){var v=F(S,gm);if(v&&v.length>0){var R=v.length,q=F(S,"minValue")||0,U=F(S,"maxValue");if(U==t&&(U=0,v.forEach(function(F){F.values.forEach(function(K){U=n(U,K)})})),q===U)return;for(var l=Y.height/(U-q),g=Y.y+U*l,s=F(v[0],sr).length,a=Y.width/(3*s+1),K=0,j=F(S,"lineWidth")||2,M=F(S,"line3d"),y=F(S,"linePoint"),h=F(S,wj),H=F(S,ee),p=F(S,pp),f=0;R>f;f++){var e=v[f],D=F(e,yn),N=F(e,sr);D?W.strokeStyle=D:(D=W.strokeStyle=Je[K++],K===Je.length&&(K=0)),W.beginPath();for(var o=0;s>o;o++){var J=Y.x+(2+3*o)*a,E=g-N[o]*l;0===o?W.moveTo(J,E):W.lineTo(J,E)}if(W.lineWidth=j,W.stroke(),M&&bi(W,D,t,j,X),y||h){var c,G=j/2+2;for(o=0;s>o;o++){var u=N[o];if(J=Y.x+(2+3*o)*a,E=g-u*l,Sb(y)?y(W,J,E,D,o,e,A):y&&(W.fillStyle=D,W.beginPath(),W.arc(J,E,G,0,x,!0),W.fill()),Sb(h)?c=h(u,o,e,A):h&&(c=u),c){var V=nb(H,c).height,O=W.shadowBlur;if(O){var Q=W.shadowOffsetX,m=W.shadowOffsetY,w=W.shadowColor;W.shadowOffsetX=0,W.shadowOffsetY=0,W.shadowBlur=0,W.shadowColor=t}fo(W,c,H,p,J,E-V-G+2,0,V,r),O&&(W.shadowOffsetX=Q,W.shadowOffsetY=m,W.shadowColor=w,W.shadowBlur=O)}}}}}},i={border:R,image:Y,text:u,pieChart:s,columnChart:a,stackedColumnChart:v,percentageColumnChart:o,lineChart:I};return function(e,k,R,j,a,N,v,Q,Y){if(k&&a&&N){if(W=e,A=v,h=Q,X=h?h._zoom?h._zoom:1:1,f=Y,k.tagName)return W.drawImage(k,R,j,a,N),void 0;if(F(k,"visible")!==!1){f||(f=an(k.color,A,h));var U=Do(k,A),s=xk(k,A),V={x:0,y:0,width:U,height:s},D=F(k,"clip"),P=F(k,"opacity");W.save(),Ap(W,R,j),(U!==a||s!==N)&&W.scale(a/U,N/s),D&&(Sb(D)?D(W,U,s,A,h,k):(W.beginPath(),W.rect(0,0,U,s),W.clip())),P!=t&&(W.globalAlpha*=P),F(k,"comps").forEach(function($){if(F($,tb)!==!1){Ce.splice(0,0,$);var f=F($,"opacity"),C=F($,"shadow"),c=F($,"type"),g=J($,V);if(f!=t){var N=W.globalAlpha;W.globalAlpha*=f}if(C){var G=W.shadowOffsetX,x=W.shadowOffsetY,I=W.shadowBlur,X=W.shadowColor,k=F($,"shadowOffsetX"),E=F($,"shadowOffsetY"),o=F($,"shadowBlur"),Y=F($,"shadowColor");W.shadowOffsetX=k==t?3:k,W.shadowOffsetY=E==t?3:E,W.shadowBlur=o==t?6:o,W.shadowColor=Y||$f}if(Sb(c))c(W,g,$,A,h);else if(b.getCompType(c))b.getCompType(c)(W,g,$,A,h);else if(Ar[c]||c===zq)m($,c,g);
else if(i[c]&&g){var q=F($,Ul);l(q,g),i[c]($,g),B(q)}C&&(W.shadowOffsetX=G,W.shadowOffsetY=x,W.shadowBlur=I,W.shadowColor=X),f!=t&&(W.globalAlpha=N),Ce.splice(0,1)}}),W.restore()}}}}();b.getCurrentComp=function(){return Ce[0]},b.getParentComp=function(){return Ce[1]},b.getInternal=function(){return{isEnter:eg,isEsc:Ti,isSpace:wo,isLeft:_c,isUp:aj,isRight:Qj,isDown:Nj,addMethod:op,superCall:Ag,toPointsArray:mo,translateAndScale:kk,appendArray:jb,createWorldMatrix:Hn,vec3TransformMat4:Ko,setCanvas:eh,createDiv:gc,createCanvas:Rd,createImage:vq,initContext:Yc,layout:fg,fillRect:hc,Mat:dr,drawBorder:Ji,isString:ii,setBorder:Te,getPropertyValue:hf,setPropertyValue:Il,drawVerticalLine:vh,draw3DRect:bq,getPinchDist:ir,isSameRect:lf,getPosition:kl,intersectionLineRect:Vn,getNodeRect:Lb,getImageWidth:Do,getImageHeight:xk,formatNumber:xd,initItemElement:so,drawPoints:fl,createG2:Uj,closePopup:jo,isH:Kd,createAnim:Yq,createNormalMatrix:hb,createNormals:dk,toFloatArray:vm,glMV:Ef,batchShape:Nq,createNodeMatrix:Gk,getFaceInfo:ym,transformAppend:dj,drawFaceInfo:or,to3dPointsArray:gn,setGLDebugMode:function(D){Zl=D},cube:function(){return{vs:jj,is:Fq,uv:Sh}},ui:function(){return{DataUI:gj,NodeUI:af,EdgeUI:qd,GroupUI:ib,ShapeUI:Eo,GridUI:Sm,Data3dUI:Qk,Node3dUI:fr,Shape3dUI:Yb}},getDragger:function(){return Fh},addMSMap:function(n){op(nk,n)}}};var Me=p.List=function(){this._as=[];var m,Q,s=arguments.length;if(1===s){var R=arguments[0];if(Go(R)&&(R=R._as),fd(R))for(Q=R.length,m=0;Q>m;m++)this._as.push(R[m]);else R!=t&&this._as.push(R)}else if(s>1)for(m=0;s>m;m++)this._as.push(arguments[m])};Qr("List",X,{size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(I,H){return H===Z?this._as.push(I):this._as.splice(H,0,I)},addAll:function(z){Go(z)&&(z=z._as),fd(z)?jb(this._as,z):this._as.push(z)},get:function(z){return this._as[z]},slice:function(V,t){return new Me(this._as.slice(V,t))},remove:function(R){var C=this._as.indexOf(R);return C>=0&&C<this._as.length&&this.removeAt(C),C},removeAt:function(E){return this._as.splice(E,1)[0]},set:function(K,R){return this._as[K]=R},clear:function(){return this._as.splice(0,this._as.length)},contains:function(m){return this._as.indexOf(m)>=0},indexOf:function(M){return this._as.indexOf(M)},each:function(W,V){for(var P=0,C=this._as.length;C>P;P++){var t=this._as[P];V?W.call(V,t):W(t)}},reverseEach:function(U,e){for(var l=this._as.length-1;l>=0;l--){var p=this._as[l];e?U.call(e,p):U(p)}},toArray:function(O,h){if(O){for(var j,T=[],o=0,Y=this._as.length;Y>o;o++)j=this._as[o],h?O.call(h,j)&&T.push(j):O(j)&&T.push(j);return T}return this._as.concat()},toList:function(l,r){if(l){for(var N,G=new Me,Y=0,D=this._as.length;D>Y;Y++)N=this._as[Y],r?l.call(r,N)&&G.add(N):l(N)&&G.add(N);return G}return new Me(this)},reverse:function(){this._as.reverse()},sort:function(x){return this._as.sort(x?x:ip),this},toString:function(){return this._as.toString()}});var ll=new Me;op(ll,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Df,each:Df,reverseEach:Df,toArray:function(){return[]},toList:function(){return new Me},add:rm,addAll:rm,set:rm,remove:rm,removeAt:rm,clear:rm});var Ql=p.Notifier=function(){};Qr("Notifier",X,{contains:function(H,Y){if(this._ls)for(var l,R=0,q=this._ls.size();q>R;R++)if(l=this._ls.get(R),H===l.l&&Y===l.s)return!0;return!1},add:function(T,Y,C){var $=this,j={l:T,s:Y,a:C};$._ls||($._ls=new Me),$._f?($._as||($._as=new Me),$._as.add(j)):j.a?$._ls.add(j,0):$._ls.add(j)},remove:function(J,g){var C=this;C._ls&&(C._f?(C._rs||(C._rs=new Me),C._rs.add({l:J,s:g})):C._remove(J,g))},_remove:function(l,x){for(var E,I=this._ls,P=0,$=I.size();$>P;P++)if(E=I.get(P),E.l===l&&E.s===x)return I.removeAt(P),void 0},fire:function(G){var Z=this,x=Z._ls;if(x){Z._f=1;for(var I,P=0,V=x.size();V>P;P++)I=x.get(P),I.s?I.l.call(I.s,G):I.l(G);if(delete Z._f,Z._rs){for(V=Z._rs.size(),P=0;V>P;P++)I=Z._rs.get(P),Z._remove(I.l,I.s);delete Z._rs}if(Z._as){for(V=Z._as.size(),P=0;V>P;P++)I=Z._as.get(P),I.a?x.add(I,0):x.add(I);delete Z._as}}}});var pc=p.Data=function(){this._id=Lk()};Qr("Data",X,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop"],ms_dm:1,ms_attr:1,_icon:t,_parent:t,_children:ll,_childMap:t,_styleMap:t,_layer:0,_adjustChildrenToTop:!1,getUIClass:function(){return t},get3dUIClass:function(){return t},s:function(A,v){var c=this;if(2===arguments.length)c.setStyle(A,v);else{if(!me(A))return c.getStyle(A);for(var b in A)c.setStyle(b,A[b])}return c},fp:function(J,P,Z){return this.firePropertyChange(J,P,Z)},firePropertyChange:function(C,n,T){if(n===T)return!1;var p=this,R={property:C,oldValue:n,newValue:T,data:p};return p._dataModel&&p._dataModel.handleDataPropertyChange(R),p.onPropertyChanged(R),!0},onPropertyChanged:function(t){var e=this,g=e._parent,A=t.property;if(bg(g)){var Z=e.s(mi),Q="s:ingroup"===A;(Z&&lg[A]||A===Q)&&g.updatePositionFromChildren(),(Z||Q)&&g.fp("childChange",!0,!1)}},_setDataModel:function(Q){var K=this;if(Q&&K._dataModel)throw"HT-DM";K._dataModel=Q},getId:function(){return this._id},setId:function(G){this._id=G},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(w,p){return this._children.toList(w,p)},eachChild:function(g,c){this._children.each(g,c)},addChild:function(j,E){var h=this;j!==h&&(h._children===ll&&(h._children=new Me,h._childMap={}),E===Z&&(E=h._children.size()),h._childMap[j._id]||h.isDescendantOf(j)||(j._parent&&j._parent.removeChild(j),(0>E||E>h._children.size())&&(E=h._children.size()),h._children.add(j,E),h._childMap[j._id]=j,j.setParent(h),h.onChildAdded(j,E),h.fp(Tb,t,j)))},onChildAdded:function(){},removeChild:function(M){var p=this;if(p._childMap&&p._childMap[M._id]){var j=p._children.remove(M);delete p._childMap[M._id],p.fp(Tb,M,t),M.setParent(t),p.onChildRemoved(M,j)}},onChildRemoved:function(){},getChildAt:function(i){return this._children.get(i)},clearChildren:function(){var G=this;if(!G._children.isEmpty())for(var w=0,S=G._children.toArray(),U=S.length;U>w;w++)G.removeChild(S[w])},getParent:function(){return this._parent},setParent:function(s){var G=this;if(!(G._updatingParent||G._parent===s||G===s||s&&s.isDescendantOf(G))){var t=G._parent;G._parent=s,G._updatingParent=1,t&&t.removeChild(G),s&&s.addChild(G),delete G._updatingParent,G.fp("parent",t,s),G.onParentChanged(t,s)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Q){return Q?this.isDescendantOf(Q)||Q.isDescendantOf(this):!1},isParentOf:function(R){return R&&this._childMap?!!this._childMap[R._id]:!1},isDescendantOf:function(R){if(!R||R.isEmpty())return!1;for(var S=this._parent;S;){if(R===S)return!0;S=S._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(e,u){u===Z&&(u=1);var T=this._styleMap?this._styleMap[e]:Z;return T===Z&&u?L[e]:T},setStyle:function(M,G){var F=this;F._styleMap||(F._styleMap={});var x=F._styleMap[M];G===Z?delete F._styleMap[M]:F._styleMap[M]=G,F.fp("s:"+M,x,G)&&F.onStyleChanged(M,x,G)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var r=this;return r._displayName||r._name||r._tag||r._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(Y,J){var w=this,h=w.s(wf);h||w.s(wf,h={}),J?h[Y]=J:delete h[Y],w.fp(wf,t,h)},removeStyleIcon:function(O){var w=this.s(wf);if(w){var T=w[O];delete w[O],this.fp(wf,t,w)}return T},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1}},getSerializableStyles:function(){var P,C={};for(P in this._styleMap)C[P]=1;return C}});var fq=p.DataModel=function(){var r=this;r._datas=new Me,r._dataMap={},r._roots=new Me,r._rootMap={},r._tagMap={},r._dataModelNotifier=new Ql,r._dataNotifier=new Ql,r._selectionModel=new Wr(r);var n=r._scheduleTasks=[],u=r._scheduleCallback=function(){for(var N=Date.now(),S=0;S<n.length;S++){var _=n[S];_.enabled&&N-_.lastTime>_.interval&&(r.each(function(d){_.action(d)}),_.lastTime=N)}n.length&&(r._scheduleRequestId=O.requestAnimationFrame(u))}};Qr("DataModel",X,{ms_attr:1,sm:function(){return this.getSelectionModel()},mm:function(w,Y,C){this.addDataModelChangeListener(w,Y,C)},umm:function(f,R){this.removeDataModelChangeListener(f,R)},md:function(J,e,i){this.addDataPropertyChangeListener(J,e,i)},umd:function($,R){this.removeDataPropertyChangeListener($,R)},mh:function(N,X,C){this.addHierarchyChangeListener(N,X,C)},umh:function(k,H){this.removeHierarchyChangeListener(k,H)},getHistoryManager:function(){return this._historyManager},getAttrObject:function(){return this._attrObject},setAttrObject:function(d){return this._attrObject=d},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(i){return this._dataMap[i]},removeDataById:function(Q){this.remove(this.getDataById(Q))},toDatas:function(C,$){return this._datas.toList(C,$)},each:function(c,K){this._datas.each(c,K)},getDataByTag:function(P){return this._tagMap[P]},removeDataByTag:function(c){this.remove(this.getDataByTag(c))},add:function(J,o){var A=this,N=J._id,k=J._tag,X=A._roots;if(A._dataMap[N])throw"'"+N+"' already exists";k!=t&&(A._tagMap[k]=J),A._dataMap[N]=J,A._datas.add(J),J._parent||(A._rootMap[N]=J,o>=0?X.add(J,o):X.add(J)),J._setDataModel(A),A.onAdded(J),A._dataModelNotifier.fire({kind:"add",data:J})},onAdded:function(){},remove:function(O){if(O){var j=this,b=O._id,Z=O.getTag(),E=j.getHistoryManager();O._dataModel===j&&(E&&E.beginInteraction(),j.prepareRemove(O),O.toChildren().each(j.remove,j),O._parent&&O._parent.removeChild(O),j._datas.remove(O),delete j._dataMap[b],Z!=t&&delete j._tagMap[Z],j._rootMap[b]&&(delete j._rootMap[b],j._roots.remove(O)),O._setDataModel(t),j.onRemoved(O),j._dataModelNotifier.fire({kind:Ve,data:O}),E&&E.endInteraction())}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var J=this;J._datas.size()>0&&(J._datas.each(function(n){n._setDataModel(t)}),J._datas.clear(),J._dataMap={},J._roots.clear(),J._rootMap={},J._tagMap={},J._dataModelNotifier.fire({kind:Yn}))},contains:function(w){return w&&w._dataModel===this},handleDataPropertyChange:function(f){var S=this,w=f.data,k=f.property;if("parent"===k){var l=w._id,n=S._rootMap,T=S._roots;w._parent?n[l]&&(delete n[l],T.remove(w)):n[l]||(n[l]=w,T.add(w))}else if("tag"===k){var M=f.oldValue,P=f.newValue,A=S._tagMap;M!=t&&delete A[M],P!=t&&(A[P]=w)}this.onDataPropertyChanged(w,f),this._dataNotifier.fire(f)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(k,E,d){this._dataModelNotifier.add(k,E,d)},removeDataModelChangeListener:function(h,I){this._dataModelNotifier.remove(h,I)},addDataPropertyChangeListener:function(s,V,y){this._dataNotifier.add(s,V,y)},removeDataPropertyChangeListener:function(s,P){this._dataNotifier.remove(s,P)},fireHierarchyChange:function(c,P,i){this._hierarchyNotifier&&this._hierarchyNotifier.fire({data:c,oldIndex:P,newIndex:i})},addHierarchyChangeListener:function(l,v,i){this._hierarchyNotifier||(this._hierarchyNotifier=new Ql),this._hierarchyNotifier.add(l,v,i)},removeHierarchyChangeListener:function(l,w){this._hierarchyNotifier.remove(l,w)},getSiblings:function(a){var j=a._parent;return j?j._children:this._roots},eachByDepthFirst:function(A,a,G){if(a)this._depthFirst(A,a,G);else for(var F=0,$=this._roots,L=$.size();L>F;F++)if(this._depthFirst(A,$.get(F),G)===!1)return},_depthFirst:function(Q,R,g){for(var O=R.size(),m=0;O>m;m++)if(this._depthFirst(Q,R.getChildAt(m),g)===!1)return!1;if(g){if(Q.call(g,R)===!1)return!1}else if(Q(R)===!1)return!1;return!0},eachByBreadthFirst:function(z,A,F){var y=new Me;for(A?y.add(A):this._roots.each(y.add,y);y.size()>0;)if(A=y.removeAt(0),A.eachChild(y.add,y),F){if(z.call(F,A)===!1)return!1}else if(z(A)===!1)return!1;return!0},moveTo:function(o,q){var m=this.getSiblings(o),r=m.indexOf(o);r===q||0>r||q>=0&&q<=m.size()&&(m.remove(o),q>m.size()&&q--,m.add(o,q),this.fireHierarchyChange(o,r,q))},moveUp:function(q){this.moveTo(q,this.getSiblings(q).indexOf(q)-1)},moveDown:function(H){this.moveTo(H,this.getSiblings(H).indexOf(H)+1)},moveToTop:function(I){this.moveTo(I,0)},moveToBottom:function(K){this.moveTo(K,this.getSiblings(K).size())},moveSelectionUp:function(m){m||(m=this.sm());var i=new Me;zs(m,i,this._roots),i.each(this.moveUp,this)},moveSelectionDown:function($){$||($=this.sm());var b=new Me;$e($,b,this._roots),b.each(this.moveDown,this)},moveSelectionToTop:function(p){p||(p=this.sm());var B=new Me;Gi(p,B,this._roots),B.each(this.moveToTop,this)},moveSelectionToBottom:function(v){v||(v=this.sm());var B=new Me;ni(v,B,this._roots),B.each(this.moveToBottom,this)},addScheduleTask:function(k){var U=this;U.removeScheduleTask(k),k.enabled==t&&(k.enabled=!0),k.interval==t&&(k.interval=10),k.action==t&&(k.action=Df),k.lastTime=Date.now(),U._scheduleTasks.push(k),U._scheduleRequestId==t&&(U._scheduleRequestId=O.requestAnimationFrame(U._scheduleCallback))},removeScheduleTask:function(F){var B=this,b=B._scheduleTasks,U=b.indexOf(F);U>=0&&b.splice(U,1),b.length||B._scheduleRequestId==t||(O.cancelAnimationFrame(B._scheduleRequestId),delete B._scheduleRequestId)}});var Wr=p.SelectionModel=function(d){var x=this;x._selectionMode=G,x._map={},x._list=new Me,x._selectionNotifier=new Ql,x._setDataModel(d)};Qr("SelectionModel",X,{ms_fire:1,ms_dm:1,ms:function(E,_,L){this.addSelectionChangeListener(E,_,L)},ums:function(j,h){this.removeSelectionChangeListener(j,h)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._selectionMode===o},co:function(w){return this._map[w._id]!=t},ss:function(z){this.setSelection(z)},as:function(o){this.appendSelection(o)},rs:function(W){this.removeSelection(W)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._selectionMode},setSelectionMode:function(w){var S=this;if(S._selectionMode!==w&&(w===rd||w===o||w===G)){S.cs();var K=S._selectionMode;S._selectionMode=w,S.fp("selectionMode",K,w)}},_setDataModel:function(Y){var j=this,i=j._dataModel;i!==Y&&(i&&(j.cs(),i.umm(j.handleDataModelChange,j)),j._dataModel=Y,Y.mm(j.handleDataModelChange,j,!0),j.fp(Cr,i,Y))},dispose:function(){var N=this;N.cs(),N._dataModel.umm(N.handleDataModelChange,N)},handleDataModelChange:function(i){var d=this;if(i.kind===Ve){var c=i.data;d.co(c)&&(d._list.remove(c),delete d._map[c._id],d.fireSelectionChange(Ve,new Me(c)))}else i.kind===Yn&&d.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(S){var y=this;if(y._filterFunc!==S){y.cs();var A=y._filterFunc;y._filterFunc=S,y.fp("filterFunc",A,y._filterFunc)}},fireSelectionChange:function(k,K,M,R){M&&(this._list.each(function(z){R[z._id]?M.remove(z):M.add(z)}),K=M.toList()),this._selectionNotifier.fire({kind:k,datas:new Me(K)})},addSelectionChangeListener:function(M,B,Q){this._selectionNotifier.add(M,B,Q)},removeSelectionChangeListener:function(t,V){this._selectionNotifier.remove(t,V)},_filterList:function(c,H){for(var y,T=this,u=0,o=new Me(c);u<o.size();u++)y=o.get(u),(T._filterFunc&&!T._filterFunc(y)||H&&T.co(y)||!H&&!T.co(y)||!T._dataModel.contains(y))&&(o.removeAt(u),u--);return o},appendSelection:function(j){var R=this;if(R._selectionMode!==rd){var c,W,v=R._list,J=R._filterList(j,!0);J.isEmpty()||(R.sg()&&(c=new Me(v),W=R._map,v.clear(),R._map={},J=new Me(J.get(J.size()-1))),J.each(function(f){v.add(f),R._map[f._id]=f}),R.fireSelectionChange("append",J,c,W))}},removeSelection:function(G){var o=this,J=o._filterList(G),B=0,L=J.size();if(0!==L){for(;L>B;B++){var C=J.get(B);o._list.remove(C),delete o._map[C._id]}o.fireSelectionChange(Ve,J)}},toSelection:function(N,C){return this._list.toList(N,C)},getSelection:function(){return this._list},each:function(A,t){this._list.each(A,t)},setSelection:function(G){var u=this,L=u._list;if(u._selectionMode!==rd&&!(L.isEmpty()&&!G||1===L.size()&&u.ld()===G)){var k=new Me(L),g=u._map;L.clear(),u._map={};var D=u._filterList(G,!0);u.sg()&&D.size()>1&&(D=new Me(D.get(D.size()-1))),D.each(function(j){L.add(j),u._map[j._id]=j}),u.fireSelectionChange("set",t,k,g)}},clearSelection:function(){var L=this,C=L._list;if(C.size()>0){var N=C.toList();C.clear(),L._map={},L.fireSelectionChange(Yn,N)}},selectAll:function(){var d=this;if(d._selectionMode!==rd){var m,Y,O=d._dataModel.toDatas();if(d._filterFunc)for(m=0;m<O.size();m++)Y=O.get(m),d._filterFunc(Y)||(O.removeAt(m),m--);var j=d._list,I=new Me(j),y=d._map;j.clear(),d._map={},d.sg()&&O.size()>1&&(O=new Me(O.get(O.size()-1)));var G=O.size();for(m=0;G>m;m++)Y=O.get(m),j.add(Y),d._map[Y._id]=Y;d.fireSelectionChange("all",t,I,y)}},size:function(){return this._list.size()},isEmpty:function(){return this._list.isEmpty()},contains:function(H){return this._map[H._id]!=t},getLastData:function(){var D=this._list;return D.size()>0?D.get(D.size()-1):t},getFirstData:function(){var b=this._list;return b.size()>0?b.get(0):t},isSelectable:function(q){var u=this;return q&&u._selectionMode!==rd?u._filterFunc?u._filterFunc(q):!0:!1}}),op(b,{edgeGroupAgentFunc:t,graphViewAutoScrollZone:16,graphViewResettable:!0,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:A.rectSelectBorder,graphViewRectSelectBackground:el,graphViewEditPointSize:F?17:7,graphViewEditPointBorderColor:A.editPointBorder,graphViewEditPointBackground:A.editPointBackground,setEdgeType:function(i,h,Y){Km[i]=h,Jp[i]=Y},getEdgeType:function(P){return Km[P]}},!0),op(L,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Z,"image.stretch":"fill",icons:Z,ingroup:!0,"body.color":Z,opacity:Z,"select.color":wr,"select.width":1,"select.padding":2,"select.type":Qm,"border.color":Z,"border.width":2,"border.padding":2,"border.type":Qm,label:Z,"label.font":Z,"label.color":Gn,"label.background":Z,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Z,"label.max":Z,"label.opacity":Z,"label.scale":1,label2:Z,"label2.font":Z,"label2.color":Gn,"label2.background":Z,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Z,"label2.max":Z,"label2.opacity":Z,"label2.scale":1,note:Z,"note.expanded":!0,"note.font":Z,"note.color":ko,"note.background":wr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Z,"note.toggleable":!0,"note.border.width":1,"note.border.color":Z,"note.opacity":Z,"note.scale":1,note2:Z,"note2.expanded":!0,"note2.font":Z,"note2.color":ko,"note2.background":wr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Z,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Z,"note2.opacity":Z,"note2.scale":1,"group.type":Z,"group.image":Z,"group.image.stretch":"fill","group.repeat.image":Z,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Z,"group.title.color":ko,"group.title.background":A.groupTitleBackground,"group.title.align":s,"group.background":A.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Z,"group.border.color":Wm,"group.border.cap":De,"group.border.join":vg,"group.gradient":t,"group.gradient.color":"#FFF",shape:Z,"shape.background":Wm,"shape.repeat.image":Z,"shape.border.width":0,"shape.border.color":Wm,"shape.border.3d":!1,"shape.border.3d.color":Z,"shape.border.3d.accuracy":Z,"shape.border.cap":De,"shape.border.join":vg,"shape.border.pattern":Z,"shape.gradient":t,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":qm,"shape.dash.offset":0,"shape.dash.color":lp,"shape.dash.width":Z,"shape.dash.3d":!1,"shape.dash.3d.color":Z,"shape.dash.3d.accuracy":Z,"shape.polygon.side":6,"shape.arc.from":R,"shape.arc.to":x,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Z,"edge.type":Z,"edge.points":Z,"edge.segments":Z,"edge.color":Wm,"edge.width":2,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Z,"edge.3d.accuracy":Z,"edge.cap":De,"edge.join":vg,"edge.source.position":17,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":Z,"edge.dash":!1,"edge.dash.pattern":qm,"edge.dash.offset":0,"edge.dash.color":lp,"edge.dash.width":Z,"edge.dash.3d":!1,"edge.dash.3d.color":Z,"edge.dash.3d.accuracy":Z,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Z,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Z,"grid.column.percents":Z,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":A.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":A.gridCellBorderColor,"grid.block":Z,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":A.gridBlockColor},!0),op(fq,{_autoAdjustIndex:!0,isAutoAdjustIndex:function(){return this._autoAdjustIndex},setAutoAdjustIndex:function(z){this._autoAdjustIndex=z},fireIndexChange:function(Q,x,H){this._indexNotifier&&this._indexNotifier.fire({data:Q,oldIndex:x,newIndex:H})},addIndexChangeListener:function(I,p,J){var j=this;j._indexNotifier||(j._indexNotifier=new Ql),j._indexNotifier.add(I,p,J)},removeIndexChangeListener:function(X,r){this._indexNotifier.remove(X,r)},prepareRemove:function(Y){Oq(Y)&&(Y.setSource(t),Y.setTarget(t)),Y._edges&&Y._edges.toList().each(this.remove,this),Y._attaches&&Y._attaches.toList().each(function(D){D.setHost(t)}),Y._host&&Y.setHost(t)},onAdded:function(t){this.isAutoAdjustIndex()&&this.adjustIndex(t)},onDataPropertyChanged:function(o,I){ih[I.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(o)},isAdjustable:function(J){return im(J)||Oq(J)},isAdjustedToBottom:function(f){return bg(f)?f.isExpanded()&&Rl(f):!1},adjustIndex:function(J){var M=this;M.isAdjustedToBottom(J)?(M.sendToBottom(J),J.eachChild(M.adjustIndex,M)):M.sendToTop(J)},sendToTop:function(s){var f=this;if(f.contains(s)&&f.isAdjustable(s)){var I=f._datas;if(s!==I.get(f.size()-1)){var o=I.indexOf(s);I.removeAt(o),I.add(s),f.fireIndexChange(s,o,f.size()-1)}if(Oq(s)){var Y=s._sourceAgent;Y&&!f.isAdjustedToBottom(Y)&&f.sendToTop(Y),Y=s._targetAgent,Y&&!f.isAdjustedToBottom(Y)&&f.sendToTop(Y)}s._attaches&&s._attaches.each(function(w){w.isRelatedTo(s)||im(s)&&w.isLoopedHostOn(s)||f.sendToTop(w)}),s.ISubGraph||(!bg(s)||s.isExpanded())&&s._adjustChildrenToTop&&s.eachChild(function(g){Oq(g)||f.sendToTop(g)})}},sendToBottom:function(K,s){var w=this;if(K!==s&&w.contains(K)&&w.isAdjustable(K)&&(!s||w.contains(s))){var B=w._datas,i=B.remove(K),U=s?w._datas.indexOf(s):0;if(B.add(K,U),i!==U){w.fireIndexChange(K,i,U);var M=K._parent;!M||M.ISubGraph||Oq(M)||w.sendToBottom(K._parent,K)}}}}),op(nk,{ms_edit:function(H){H.endEdit=function(A){var X=this,t=X.gv.dm(),L=t.getHistoryManager(),g=X._index,l=X._direction,O=X._node,J=X._shape,d=X._edge,k=X._rotationNode;O&&l?(this.fi({kind:"endEditRect",event:A,data:O,direction:l}),L&&L.endInteraction()):J&&g>=0?(X.fi({kind:"endEditPoint",event:A,data:J,index:g}),L&&L.endInteraction()):d&&g>=0?(X.fi({kind:"endEditPoint",event:A,data:d,index:g}),L&&L.endInteraction()):k&&(X.fi({kind:"endEditRotation",event:A,data:k}),L&&L.endInteraction())},H.betweenEdit=function($){var w=this;w.autoScroll($);var r=w.gv.lp($),o=w._index,e=w._direction,b=w._node,u=w._shape,Z=w._edge,Y=w._rotationNode;if(b&&e)w.resizeNode(r),w.fi({kind:"betweenEditRect",event:$,data:b,direction:e});else if(u&&o>=0)r.e=u.getPoints().get(o).e,u.setPoint(o,r),w.fi({kind:"betweenEditPoint",event:$,data:u,index:o});else if(Z&&o>=0){var d=Z.s(wq);r.e=d.get(o).e,d.set(o,r),Z.fp(wq,t,d),w.fi({kind:"betweenEditPoint",event:$,data:Z,index:o})}else if(Y){var B=Y.p(),R=P+W(r.y-B.y,r.x-B.x);g(R)<.04&&(R=0),Y.setRotation(R),w.fi({kind:"betweenEditRotation",event:$,data:Y})}},H.resizeNode=function(H){var C=this,k=C._rect,$=k.x,x=k.y,t=k.width,L=k.height,E=C._direction;"northwest"===E?k=Hi(H,{x:$+t,y:x+L}):E===hd?k=Hi({x:$,y:H.y},{x:$+t,y:x+L}):"northeast"===E?k=Hi({x:$,y:H.y},{x:H.x,y:x+L}):E===lk?k=Hi({x:H.x,y:x},{x:$+t,y:x+L}):E===Cm?k=Hi({x:$,y:x},{x:H.x,y:x+L}):"southwest"===E?k=Hi({x:H.x,y:x},{x:$+t,y:H.y}):"south"===E?k=Hi({x:$,y:x},{x:$+t,y:H.y}):"southeast"===E&&(k=Hi({x:$,y:x},H)),C._node.setRect(k)},H.checkResize=function(J,g,e,S,U){var m=this,f=m.gv.getEditPointSize()+2;return qn({x:g-f/2,y:e-f/2,width:f,height:f},J)?(m._direction!==S&&(m.setCursor(U),m._direction=S),!0):!1},H.checkEdit=function(A,V,k){var I=this,o=I.gv,v=V?o.getDataUI(V):t,R=v?v.editInfo:t;if(R){var B,l,F,$=o.getEditPointSize()+2,Z=o.lp(A);if(im(V)){if(R.rotationEditable&&im(V)&&(l=R.rotationPoint,qn({x:l.x-$/2,y:l.y-$/2,width:$,height:$},Z)))return I._rotationNode=V,k&&I.fi({kind:"beginEditRotation",event:A,data:V}),I.setCursor("crosshair"),!0;if(R.pointEditable&&V instanceof wg)for(F=V.getPoints(),B=F.size()-1;B>=0;B--)if(l=F.get(B),qn({x:l.x-$/2,y:l.y-$/2,width:$,height:$},Z))return I._index=B,I._shape=V,k&&I.fi({kind:"beginEditPoint",event:A,data:V,index:B}),I.setCursor("crosshair"),!0;if(R.rectEditable){var K=V.getRect(),z=K.x,h=K.y,D=K.width,M=K.height;if(I.checkResize(Z,z,h,"northwest","nwse-resize")||I.checkResize(Z,z+D/2,h,hd,Sp)||I.checkResize(Z,z+D,h,"northeast","nesw-resize")||I.checkResize(Z,z,h+M/2,lk,ik)||I.checkResize(Z,z+D,h+M/2,Cm,ik)||I.checkResize(Z,z,h+M,"southwest","nesw-resize")||I.checkResize(Z,z+D/2,h+M,"south",Sp)||I.checkResize(Z,z+D,h+M,"southeast","nwse-resize"))return I._node=V,I._rect=V.getRect(),k&&I.fi({kind:"beginEditRect",event:A,data:V,direction:I._direction}),!0}}if(R.pointEditable&&Oq(V)&&V.s(Jl)===io&&(F=V.s(wq)))for(B=F.size()-1;B>=0;B--)if(l=F.get(B),qn({x:l.x-$/2,y:l.y-$/2,width:$,height:$},Z))return I._index=B,I._edge=V,k&&I.fi({kind:"beginEditPoint",event:A,data:V,index:B}),I.setCursor("crosshair"),!0}return!1}},ms_gv:function(L){L._currentSubGraph=t,L.upSubGraph=function(){this.setCurrentSubGraph(Ch(this._currentSubGraph))},L.isVisible=function(f){var t=this;if(Ch(f)!==t._currentSubGraph)return!1;if(Oq(f)){var p=f._sourceAgent,W=f._targetAgent;if(!p||!W)return!1;if(!t.isVisible(p)||!t.isVisible(W))return!1;if(f.isEdgeGroupHidden())return!1}else for(var D=f._parent;D&&!D.ISubGraph;){if(bg(D)&&(!D.isExpanded()||!t.isVisible(D)))return!1;D=D._parent}if(t instanceof Pg){if(!f.s("3d.visible"))return!1}else if(!f.s("2d.visible"))return!1;return t._visibleFunc?t._visibleFunc(f):!0},L.handleSelectionChange=function(h){var m=this;h.datas.each(function($){m.invalidateData($);var J=$._parent;bg(J)&&im($)&&$.s(mi)&&(m.invalidateData(J),J._agentEdges&&J._agentEdges.each(function(D){m.invalidateData(D)}))}),m.onSelectionChanged(h)},L.onSelectionChanged=function(i){var F=this,G=F.sm();if(1===G.size()&&("set"===i.kind||"append"===i.kind)){var s=G.ld();F.isAutoMakeVisible()&&F.makeVisible(s),F.adjustIndex&&F._dataModel.isAutoAdjustIndex()&&F.adjustIndex(s)}},L.makeVisible=function(F){if(F){var v=this,c=v.getDataUI?v.getDataUI(F):v.getData3dUI(F);if(c){var x=F,m=Ch(F);for(m!==v._currentSubGraph&&v.setCurrentSubGraph(m);(x=x._parent)&&x!==m;)bg(x)&&x.setExpanded(!0);v._makeVisibleData=F,v.iv()}}},L.getLabel=function(i){var V=i.getStyle(wj);return V===Z?i.getName():V},L.getLabelBackground=function(Y){return Y.getStyle("label.background")},L.getLabelColor=function(A){return A.getStyle("label.color")},L.getLabel2=function(Y){return Y.getStyle("label2")},L.getLabel2Background=function(M){return M.getStyle("label2.background")},L.getLabel2Color=function(w){return w.getStyle("label2.color")},L.getNote=function(G){return G.getStyle(Er)},L.getNoteBackground=function(q){return q.getStyle("note.background")},L.getNote2=function(z){return z.getStyle(aq)},L.getNote2Background=function(g){return g.getStyle("note2.background")},L.handleClick=function(z,J,$){var t=this;J?(t.fi({kind:"clickData",event:z,data:J,part:$}),t.onDataClicked(J,z)):(t.fi({kind:"clickBackground",event:z}),t.onBackgroundClicked(z))},L.handleDoubleClick=function(z,H,L){var E=this;kf(z)&&(H?(E.fi({kind:"doubleClickData",event:z,data:H,part:L}),E.onDataDoubleClicked(H,z,L),E.checkDoubleClickOnNote(z,H,L)||E.checkDoubleClickOnRotation&&E.checkDoubleClickOnRotation(z,H,L)||(Oq(H)?E.onEdgeDoubleClicked(H,z,L):H.ISubGraph?E.onSubGraphDoubleClicked(H,z,L):bg(H)?E.onGroupDoubleClicked(H,z,L):H.IDoorWindow?E.onDoorWindowDoubleClicked(H,z,L):H.ICSGBox&&E.onCSGBoxDoubleClicked(H,z,L))):(E.fi({kind:"doubleClickBackground",event:z}),E.onBackgroundDoubleClicked(z)))},L.onSubGraphDoubleClicked=function(M){this.setCurrentSubGraph(M)},L.onEdgeDoubleClicked=function(f,M){f.ISubGraph&&!is(M)?this.setCurrentSubGraph(f):f.s("edge.toggleable")&&f.toggle()},L.onGroupDoubleClicked=function(R){R.s("group.toggleable")&&R.toggle()},L.onDoorWindowDoubleClicked=function(i){i.s("dw.toggleable")&&i.toggle(!0)},L.onCSGBoxDoubleClicked=function(t,l){var d=this;if(d instanceof Pg){var g=d.getHitFaceInfo(l);g&&g.face&&t.s(g.face+".toggleable")&&t.toggleFace(g.face,!0)}},L.onBackgroundClicked=function(){},L.onBackgroundDoubleClicked=function(){this.upSubGraph()},L.onDataClicked=function(){},L.onDataDoubleClicked=function(){},L.onAutoLayoutEnded=function(){},L.onMoveEnded=function(){},L.onPanEnded=function(){},L.onPinchEnded=function(){},L.onRectSelectEnded=function(){},L.onZoomEnded=function(){}},ms_icons:function(K){K.getRotation=function(U){return U==t?0:U},K.updateIcons=function(){var o=this,c=o.s(wf);if(c){var p=o,E=o.data||o._data,q=o.iconsInfo={icons:c,rects:{}};for(var S in c){var U=c[S],T=an(U.shape3d,E,p);if(!(an(U.visible,E,p)===!1||an(U.for3d,E,p)&&!o.I3d||T&&!o.I3d)){var g=T?[T]:an(U.names,E,p),Z=g?g.length:0,l=an(U.position,E,p)||3,I=an(U.offsetX,E,p)||0,f=an(U.offsetY,E,p)||0,b=an(U.direction,E,p)||Cm,u=an(U.gap,E,p),y=u!=t?u:1,e=an(U.rotation,E,p),a=an(U.keepOrien,E,p),X=an(U.rotationFixed,E,p)?e:o.getRotation(e,a,l),A=t,z=q.rects[S]=new Array(Z);z.rotation=X;for(var h=0;Z>h;h++){var s,x,J,r,V=g[h];if(T)J=0,r=0;else{var P=vn(V);J=an(U.width,E,p),r=an(U.height,E,p),J==t&&(J=Do(P,E)),r==t&&(r=xk(P,E))}if(A?b===Cm?I+=J/2:b===lk?I-=J/2:b===hd?f-=r/2:f+=r/2:A={width:J,height:r},o.I3d){var Y=-J/2,B=-r/2;x={width:J,height:r,mat:o.getPartMat(an(U.autorotate,E,p),l,A,an(U.face,E,p)||v,an(U.t3,E,p),an(U.r3,E,p),an(U.rotationMode,E,p),I,f),vs:new ab([Y,-B,0,Y,-B-r,0,Y+J,-B-r,0,Y+J,-B,0])}}else s=o.getPosition(l,I,f,A,an(U.positionFixed,E,p)),x={x:s.x-J/2,y:s.y-r/2,width:J,height:r},o.addRect(x,X);z[h]=x,b===Cm?I+=J/2+y:b===lk?I-=J/2+y:b===hd?f-=r/2+y:f+=r/2+y}}}}}}});var ue={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Oe={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Lf={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},ih={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},lg={position:1,width:1,height:1,expanded:1,rotation:1,"s:edge.points":1},Od={"edge.type":1,"edge.group":1},Pb={rotation:1,rotationX:1,rotationZ:1},Ic={position:1,width:1,height:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},dc={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Eh={shape:1,thickness:1,position:1},Ee=function(o,k){if(!o||!bg(k)||k.isEmpty())return!1;
for(o=o._parent;bg(o);){if(o===k)return!0;o=o._parent}return!1},Ch=function(O){if(!O)return t;if(Oq(O)){var p=O._sourceAgent,x=O._targetAgent;if(!p||!x)return t;var w=Ch(p),y=Ch(x);return w===y?w:t}for(var S=O._parent;Oq(S)&&!S.ISubGraph;)S=S._parent;return S?S.ISubGraph?S:Ch(S):t},ne=function(q,c,G,z){var N=c.getStyle(G)*z;N&&Am(q,N),N=c.getStyle(G+".left")*z,N&&(q.x-=N,q.width+=N),N=c.getStyle(G+".right")*z,N&&(q.width+=N),N=c.getStyle(G+".top")*z,N&&(q.y-=N,q.height+=N),N=c.getStyle(G+".bottom")*z,N&&(q.height+=N),q.width<0&&(q.width=-q.width,q.x-=q.width),q.height<0&&(q.height=-q.height,q.y-=q.height)},Rl=function(h){for(var r,e=0,g=h.size();g>e;e++)if(r=h.getChildAt(e),im(r)&&Rl(r))return!0;return h.hasAgentEdges()},Gq=function(r){if(!r)return t;for(var V=r._parent;bg(V);){if(!bg(V._parent))return V.isExpanded()?r:V;V.isExpanded()||(r=V),V=V._parent}return r},Yo=function(M,V){if(!M||!V)return t;var m,T,k,g=Ch(M),b=Ch(V);if(g!==b){for(;b&&g!==b;)b=Ch(b);if(g===b)return M;m=new Me,m.add(M,0);for(var q=M._parent;im(q)&&!V.isDescendantOf(q);)m.add(q,0),q=q._parent;for(k=m.size(),T=0;k>T;T++){var v=m.get(T);if(bg(v)&&!v.isExpanded())return v;if(v.ISubGraph)return v}return M}return M},Lc=function(W){if(W.isLooped())return W._source;var V=Gq(W._source),M=Gq(W._target);return V===M?W._source:Yo(V,M)},Oo=function(t){if(t.isLooped())return t._target;var V=Gq(t._source),G=Gq(t._target);return V===G?t._target:Yo(G,V)},Lb=function(N,f){var U;if(bg(f)&&f.isExpanded()){var l=N.getDataUI(f);l&&l._groupInfo&&(U=l._groupInfo.rect)}return U?U:f.getRect()},oc=function(k,Q,d,U,z){return Q?(d=kl(d,Lb(k,Q)),d.x+=U,d.y+=z,d):t},Si=function(E,u){if(!E||!u)return t;var z,A,e,q,r,y;if(E===u){if(q=E.getLoopedEdges(),!q)return t;q=new Me(q)}else{if(r=E.getAgentEdges(),y=u.getAgentEdges(),!r||!y)return t;for(A=r.size(),z=0;A>z;z++)e=r.get(z),y.contains(e)&&(q||(q=new Me),q.add(e))}if(q)for(z=0;z<q.size();z++)e=q.get(z),e.getStyle(Jl)===io&&(e._setEdgeGroup(t),q.removeAt(z),z--);return q},Xi=function(Q,Y){var D=Si(Q,Y);if(D&&!D.isEmpty()){if(1===D.size())return D.get(0)._setEdgeGroup(t),void 0;var S=new Me,O=new Me;D.each(function(A){var a=A.s("edge.group");S.contains(a)||S.add(a)}),S.sort(),S.each(function(T){O.add(new p.EdgeGroup(D.toList(function(d){return T===d.s("edge.group")}),O))}),O.each(function(d){d.each(function(u){u._setEdgeGroup(d)})})}},ui=function(D,j){if(j){var f=j.rect,W=j.color,Q=j.rotation,C=j.labelWidth,w=j.background,A=j.opacity,E=j.scale,X=E!=t&&1!==E;if(A!=t){var U=D.globalAlpha;D.globalAlpha*=A}if(Q||X){D.save();var $=f.x+f.width/2,M=f.y+f.height/2;Ap(D,$,M),Q&&$p(D,Q),X&&D.scale(E,E),Ap(D,-$,-M)}if(w&&hc(D,f.x,f.y,f.width,f.height,w),C){var K=f.width,I=D.createLinearGradient(f.x,f.y,f.x+K,f.y);I.addColorStop(0,W),I.addColorStop(.9,W),I.addColorStop(1,Zr),W=I,f.width=C}pe(D,j.ss,f,j.font,W),C&&(f.width=K),(Q||X)&&D.restore(),A!=t&&(D.globalAlpha=U)}},ak=function(C,I){if(I){var W=I.rect,E=W.x,$=W.y,b=W.width,O=W.height,k=I.background,V=I.borderWidth,U=I.borderColor,H=I.labelWidth,q=I.opacity,u=I.scale,f=u!=t&&1!==u;if(q!=t){var Z=C.globalAlpha;C.globalAlpha*=q}if(f){C.save();var n=W.x+W.width/2,i=W.y+W.height/2;Ap(C,n,i),C.scale(u,u),Ap(C,-n,-i)}if(I.expanded){var g=d(8,b/4),o=$+O-8;if(C.fillStyle=k,C.beginPath(),C.moveTo(E,$),C.lineTo(E,o),C.lineTo(E+b/2,o),C.lineTo(E+b/2,$+O),C.lineTo(E+b/2+g,o),C.lineTo(E+b,o),C.lineTo(E+b,$),C.closePath(),C.fill(),V&&(C.lineWidth=V,C.strokeStyle=U?U:zo(k),C.beginPath(),C.moveTo(E+b,$),C.lineTo(E,$),C.lineTo(E,o),C.lineTo(E+b/2,o),C.lineTo(E+b/2,$+O),C.stroke(),C.strokeStyle=U?U:jp(k),C.beginPath(),C.moveTo(E+b,$),C.lineTo(E+b,o),C.lineTo(E+b/2+g,o),C.lineTo(E+b/2,$+O),C.stroke()),W.height-=8,k=I.color,H){var B=b,D=C.createLinearGradient(E,$,E+B,$);D.addColorStop(0,k),D.addColorStop(.9,k),D.addColorStop(1,Zr),k=D,W.width=H}pe(C,I.ss,W,I.font,k),H&&(W.width=B),W.height+=8}else{var r=b/2;V&&(C.lineWidth=V,C.strokeStyle=U?U:zo(k),C.beginPath(),C.arc(E+r,$+r,r,1.6*R,P,!0),C.moveTo(E+r,$+O),C.lineTo(E+r/5,$+r),C.stroke(),C.strokeStyle=U?U:jp(k),C.beginPath(),C.arc(E+r,$+r,r,P,1.6*R,!0),C.moveTo(E+r,$+O),C.lineTo(E+b-r/5,$+r),C.stroke()),C.fillStyle=k,C.beginPath(),C.arc(E+r,$+r,r,0,x,!0),C.moveTo(E+r,$+O),C.lineTo(E+b-r/5,$+r),C.lineTo(E+r/5,$+r),C.closePath(),C.fill(),C.fillStyle=I.color,C.beginPath(),C.arc(E+r,$+r,r/3,0,x,!0),C.fill()}f&&C.restore(),q!=t&&(C.globalAlpha=Z)}},Fi=function(T,s){return s>2*T?T:s/2},fm=function(p,H,h,f){if(!p||!H)return 0;var G=W(H.y-p.y,H.x-p.x);return h||(G=H.x<p.x?G+R:G),G+f},om=function(x,U,a,B,q,e,g){g&&(x.x>U.x||x.x===U.x&&x.y>U.y)&&(a=Up[a],q=-q);var m=kl(a,{x:0,y:0,width:Uk(x,U),height:0},e);return m.x+=B,m.y+=q,m=new dr(W(U.y-x.y,U.x-x.x)).tf(m),m.x+=x.x,m.y+=x.y,m},ep=function(N,Q,f,j,H){if(N._sameSourceWithFirstEdge=!0,!f.getEdgeGroup())return j?f.s("edge.gap"):0;var m,V=0,C=0,v=0;if(f.getEdgeGroup().getSiblings().each(function(e){e.each(function(o){if(Q.isVisible(o)&&o.s(Jl)==H){var W=o.s("edge.gap");m?(C+=v/2+W/2,v=W):(m=o,v=W),o===f&&(V=C)}})}),j)return C-V+v;var h=V-C/2;return m&&f._sourceAgent!==m._sourceAgent&&(N._sameSourceWithFirstEdge=!1),h},Th=function(){var j=function(m){var U=[];return m.forEach(function(J){U.push({x:J.x,y:J.y}),U.push({x:J.x+J.width,y:J.y+J.height}),U.push({x:J.x+J.width,y:J.y}),U.push({x:J.x,y:J.y+J.height})}),U};return function(G,L,b){if("oval"===G){var F=0,c=b.height/b.width,H=c*c,$=b.x+b.width/2,R=b.y+b.height/2,f=j(L);f.forEach(function(u){var E=u.x-$,V=u.y-R,J=E*E+V*V/H;J>F&&(F=J)}),F=k(F);var q=c*F;return{x:$-F,y:R-q,width:2*F,height:2*q}}if("circle"===G){var Y=0,$=b.x+b.width/2,R=b.y+b.height/2,f=j(L);return f.forEach(function(N){var c=N.x-$,A=N.y-R,l=c*c+A*A;l>Y&&(Y=l)}),Y=k(Y),{x:$-Y,y:R-Y,width:2*Y,height:2*Y}}return"roundRect"===G?(Am(b,d(b.width,b.height)/16),b):b}}(),od=p.graph={},th=function(O,q,C){Ib(J+".graph."+O,q,C)};p.layout={},Vh("node_image",vq(30,30,[{type:Qm,rect:[4,5,22,16],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[2,3,26,20],borderWidth:1,borderColor:Wm},{type:Qm,rect:[11,23,8,4],background:Wm},{type:Qm,rect:[6,27,18,2],background:Wm}])),Vh("node_icon",vq(16,16,[{type:Qm,rect:[2,2,12,10],gradient:xn,gradientColor:Xp,background:Wm},{type:Yl,rect:[2,2,12,10],width:1,color:Wm},{type:Qm,rect:[6,12,4,2],background:Wm},{type:Qm,rect:[4,14,8,1],background:Wm}])),Vh("group_image",vq(66,39,[{type:Qm,rect:[44.3,18,18.1,12.8],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[3.3,17.8,18.1,12.8],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Wm,gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[26.2,29.4,12.8,4.2],background:Wm},{type:Qm,rect:[21.3,33.5,22.5,2.3],background:Wm},{type:Qm,rect:[5.3,32.7,14.1,2.1],background:Wm},{type:Qm,rect:[9,30.4,6.7,2.4],background:Wm},{type:Qm,rect:[50,30.7,6.7,2.4],background:Wm},{type:Qm,rect:[46.3,33,14.1,2.1],background:Wm}])),Vh("group_icon",vq(16,16,[{type:Qm,rect:[4,12,4,2],background:Wm},{type:Qm,rect:[2,13,8,1],background:Wm},{type:Qm,rect:[12,12,2,1],background:Wm},{type:Qm,rect:[11,13,4,1],background:Wm},{type:Qm,rect:[10,7,6,5],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[1,2,10,10],gradient:xn,gradientColor:Xp,background:Wm},{type:Yl,rect:[1,2,10,10],width:1,color:Wm}])),Vh("edge_icon",vq(16,16,[{type:Qm,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[10.8,1,4,4],background:Wm},{type:Qm,rect:[1,11,4,4],background:Wm}])),Vh("subGraph_image",vq(72,45,[{type:zq,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[29.6,30.7,3.6,1.8],background:Wm},{type:Qm,rect:[28.4,32.3,6,1.2],background:Wm},{type:Qm,rect:[37.3,32,10.8,1.8],background:Wm},{type:Qm,rect:[39.1,29.9,7.2,2.3],background:Wm},{type:Qm,rect:[26.6,23.7,9.6,7.2],gradient:xn,gradientColor:Xp,background:Wm},{type:Qm,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Wm,gradient:xn,gradientColor:Xp,background:Wm}])),Vh("subGraph_icon",vq(17,17,[{type:zq,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:xn,gradientColor:Xp,background:Wm}])),Vh("shape_icon",vq(16,16,[{type:zq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Wm}])),Vh("polyline_icon",vq(16,16,[{type:zq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Wm},lj(7.5,.4),lj(7.5,6.3),lj(13.6,6.3),lj(13.6,14),lj(.7,13.9),lj(.7,.3)])),Vh("grid_icon",vq(16,16,[{type:Qm,rect:[1,1,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[6,1,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[11,1,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[11,6,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[6,6,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[1,6,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[11,11,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[6,11,4,4],background:Wm,gradient:xn,gradientColor:Xp},{type:Qm,rect:[1,11,4,4],background:Wm,gradient:xn,gradientColor:Xp}])),Vh("light_icon",vq(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Wm},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Wm,gradient:xn,gradientColor:Xp,background:{func:function(D){var j=D?D.s(Qe):t;return fd(j)?"rgb("+V(255*j[0])+","+V(255*j[1])+","+V(255*j[2])+")":j||Wm}}}]));var Wg=function(J,x){for(var g=J.vertices,H=0;H<g.length;H++){var p=g[H],Q=p.y;p.y=p.z,p.z=-Q,x&&(p.y+=x)}},ie=function(r){for(var A,G,L,l,O,w,t=[],x=[],Q=[],s=r.faces,$=0,y=0,g=0,W=s.length;W>$;$++,y+=6,g+=9){var B=s[$];1===B.i?(A||(A=[],G=[],L=[]),Gh(B,$,y,g,r,A,L,G)):2===B.i?(l||(l=[],O=[],w=[]),Gh(B,$,y,g,r,l,w,O)):Gh(B,$,y,g,r,t,Q,x)}return{vs:t,uv:x,ns:Q,top_vs:A,top_uv:G,top_ns:L,bottom_vs:l,bottom_uv:O,bottom_ns:w}},Gh=function(l,T,z,j,n,Z,P,R){var V=n.vertices,Y=n.faceVertexUvs,o=V[l.a],y=V[l.b],t=V[l.c];Z[j]=o.x,Z[j+1]=o.y,Z[j+2]=o.z,Z[j+3]=y.x,Z[j+4]=y.y,Z[j+5]=y.z,Z[j+6]=t.x,Z[j+7]=t.y,Z[j+8]=t.z;var e=l.vertexNormals;if(3===e.length){var w=e[0],F=e[1],q=e[2];P[j]=w.x,P[j+1]=w.y,P[j+2]=w.z,P[j+3]=F.x,P[j+4]=F.y,P[j+5]=F.z,P[j+6]=q.x,P[j+7]=q.y,P[j+8]=q.z}else{var s=l.normal;P[j]=s.x,P[j+1]=s.y,P[j+2]=s.z,P[j+3]=s.x,P[j+4]=s.y,P[j+5]=s.z,P[j+6]=s.x,P[j+7]=s.y,P[j+8]=s.z}var H=Y[0][T][0],v=Y[0][T][1],C=Y[0][T][2];R[z]=H.x,R[z+1]=H.y,R[z+2]=v.x,R[z+3]=v.y,R[z+4]=C.x,R[z+5]=C.y},Bl=function(N,D,z,L,Y,V,U,S,u){z==t&&(z=!0),L==t&&(L=!0),U==t&&(U=1),S==t&&(S=0);var J=new _g;return fl(J,N,D,u),ie(new hs(J,{top:z,bottom:L,curveSegments:Y,amount:U,repeatUVLength:V},-U/2+S))},kp=function(D,$){this.x=D||0,this.y=$||0};kp.prototype={constructor:kp,add:function(a){return this.x+=a.x,this.y+=a.y,this},sub:function(N){return this.x-=N.x,this.y-=N.y,this},equals:function($){return $.x===this.x&&$.y===this.y},multiplyScalar:function(A){return this.x*=A,this.y*=A,this},distanceTo:function(D){return k(this.distanceToSquared(D))},distanceToSquared:function(s){var b=this.x-s.x,r=this.y-s.y;return b*b+r*r},clone:function(){return new kp(this.x,this.y)}};var hl=function(z,I,C){this.x=z||0,this.y=I||0,this.z=C||0};hl.prototype={constructor:hl,set:function(W,Y,X){return this.x=W,this.y=Y,this.z=X,this},setY:function(j){return this.y=j,this},copy:function(U){return this.x=U.x,this.y=U.y,this.z=U.z,this},add:function(J){return this.x+=J.x,this.y+=J.y,this.z+=J.z,this},addVectors:function(s,j){return this.x=s.x+j.x,this.y=s.y+j.y,this.z=s.z+j.z,this},sub:function(g){return this.x-=g.x,this.y-=g.y,this.z-=g.z,this},subVectors:function(s,w){return this.x=s.x-w.x,this.y=s.y-w.y,this.z=s.z-w.z,this},multiplyScalar:function(r){return this.x*=r,this.y*=r,this.z*=r,this},applyMatrix4:function(q){var c=this.x,d=this.y,$=this.z,E=q.elements;return this.x=E[0]*c+E[4]*d+E[8]*$+E[12],this.y=E[1]*c+E[5]*d+E[9]*$+E[13],this.z=E[2]*c+E[6]*d+E[10]*$+E[14],this},divideScalar:function(P){if(0!==P){var $=1/P;this.x*=$,this.y*=$,this.z*=$}else this.x=0,this.y=0,this.z=0;return this},dot:function(g){return this.x*g.x+this.y*g.y+this.z*g.z},length:function(){return k(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(s){var G=this.x,V=this.y,t=this.z;return this.x=V*s.z-t*s.y,this.y=t*s.x-G*s.z,this.z=G*s.y-V*s.x,this},crossVectors:function(q,j){var A=q.x,P=q.y,L=q.z,y=j.x,S=j.y,c=j.z;return this.x=P*c-L*S,this.y=L*y-A*c,this.z=A*S-P*y,this},distanceTo:function(S){return k(this.distanceToSquared(S))},distanceToSquared:function(J){var E=this.x-J.x,P=this.y-J.y,p=this.z-J.z;return E*E+P*P+p*p},clone:function(){return new hl(this.x,this.y,this.z)}};var bf=function(){this.elements=new Float32Array(16)};bf.prototype={constructor:bf,set:function(D,T,K,z,m,F,U,x,g,A,R,e,O,n,y,L){var b=this.elements;return b[0]=D,b[4]=T,b[8]=K,b[12]=z,b[1]=m,b[5]=F,b[9]=U,b[13]=x,b[2]=g,b[6]=A,b[10]=R,b[14]=e,b[3]=O,b[7]=n,b[11]=y,b[15]=L,this},makeRotationAxis:function(n,L){var M=_(L),r=E(L),z=1-M,x=n.x,R=n.y,G=n.z,d=z*x,b=z*R;return this.set(d*x+M,d*R-r*G,d*G+r*R,0,d*R+r*G,b*R+M,b*G-r*x,0,d*G-r*R,b*G+r*x,z*G*G+M,0,0,0,0,1),this}};var En=function($){this.repeatUVLength=$};En.prototype={generateTopUV:function($,T,R,w,X,o,A){var r,x,k,N,F=$.vertices,M=F[w].x,f=F[w].y,z=F[X].x,s=F[X].y,D=F[o].x,t=F[o].y,e=this.repeatUVLength;if(e)r=0,x=0,k=e,N=e;else{this._bb||(this._bb=T.getBoundingBox());var K=this._bb;r=K.minX,x=K.minY,k=K.maxX-r,N=K.maxY-x}return A?[new kp((M-r)/k,(f-x)/N),new kp((z-r)/k,(s-x)/N),new kp((D-r)/k,(t-x)/N)]:[new kp((M-r)/k,1-(f-x)/N),new kp((z-r)/k,1-(s-x)/N),new kp((D-r)/k,1-(t-x)/N)]},generateBottomUV:function(P,n,v,z,W,q){return this.generateTopUV(P,n,v,z,W,q,!0)},generateSideWallUV:function(s,i,o,f,y,V,v,O,c,H,X,_){if(!this._cl){for(var r,j,e=[],A=0,D=o.length,G=0;D>G;G++){r=o[G],j=o[(G+1)%D];var q=r.x-j.x,n=r.y-j.y,p=k(q*q+n*n);e.push(A),A+=p}for(var G=0;D>G;G++)e[G]/=A;this._cl=e}var e=this._cl,Z=1-c/H,K=1-(c+1)/H,C=e[X],W=e[_];return W>C&&(C+=1),[new kp(C,Z),new kp(W,Z),new kp(W,K),new kp(C,K)]}};var Vc=function(g,B,K,V,f,Y){this.a=g,this.b=B,this.c=K,this.i=Y,this.normal=V instanceof hl?V:new hl,this.vertexNormals=V instanceof Array?V:[]};Vc.prototype={constructor:Vc};var zg=function(){},$r=zg.prototype;$r.getPointAt=function(v){var i=this.getUtoTmapping(v);return this.getPoint(i)},$r.getPoints=function(B){B||(B=5);var j,v=[];for(j=0;B>=j;j++)v.push(this.getPoint(j/B));return v},$r.getSpacedPoints=function(f){f||(f=5);var D,S=[];for(D=0;f>=D;D++)S.push(this.getPointAt(D/f));return S},$r.getLength=function(){var w=this.getLengths();return w[w.length-1]},$r.getLengths=function(p){if(p||(p=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==p+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var O,U,Y=[],v=this.getPoint(0),g=0;for(Y.push(0),U=1;p>=U;U++)O=this.getPoint(U/p),g+=O.distanceTo(v),Y.push(g),v=O;return this.cacheArcLengths=Y,Y},$r.getUtoTmapping=function(f,N){var Z,b=this.getLengths(),U=0,o=b.length;Z=N?N:f*b[o-1];for(var T,S=0,M=o-1;M>=S;)if(U=D(S+(M-S)/2),T=b[U]-Z,0>T)S=U+1;else{if(!(T>0)){M=U;break}M=U-1}if(U=M,b[U]==Z){var d=U/(o-1);return d}var n=b[U],$=b[U+1],G=$-n,X=(Z-n)/G,d=(U+X)/(o-1);return d},$r.getTangent=function(_){var G=1e-4,n=_-G,s=_+G;0>n&&(n=0),s>1&&(s=1);var V=this.getPoint(n),J=this.getPoint(s),y=J.clone().sub(V);return y.normalize()},$r.getTangentAt=function(n){var C=this.getUtoTmapping(n);return this.getTangent(C)},zg.create=function(P,G){return P.prototype=ji(zg.prototype),P.prototype.getPoint=G,P};var le=function(){this.curves=[],this.autoClose=!1},Tk=le.prototype=ji($r);Tk.add=function(c){this.curves.push(c)},Tk.closePath=function(){var Z=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);Z.equals(t)||this.curves.push(new de(t,Z))},Tk.getPoint=function(k){for(var O,Q,W=k*this.getLength(),J=this.getCurveLengths(),b=0;b<J.length;){if(J[b]>=W){O=J[b]-W,Q=this.curves[b];var p=1-O/Q.getLength();return Q.getPointAt(p)}b++}return null},Tk.getLength=function(){var K=this.getCurveLengths();return K[K.length-1]},Tk.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var v,J=[],x=0,T=this.curves.length;for(v=0;T>v;v++)x+=this.curves[v].getLength(),J.push(x);return this.cacheLengths=J,J},Tk.getTransformedPoints=function(g){return this.getPoints(g)},Tk.getBoundingBox=function(){var U,l,w,c,e,L,p=this.getPoints();U=l=Number.NEGATIVE_INFINITY,c=e=Number.POSITIVE_INFINITY;var I,f,W,j,X=p[0]instanceof hl;for(j=X?new hl:new kp,f=0,W=p.length;W>f;f++)I=p[f],I.x>U&&(U=I.x),I.x<c&&(c=I.x),I.y>l&&(l=I.y),I.y<e&&(e=I.y),X&&(I.z>w&&(w=I.z),I.z<L&&(L=I.z)),j.add(I);var g={minX:c,minY:e,maxX:U,maxY:l};return X&&(g.maxZ=w,g.minZ=L),g};var Iq=function(C){le.call(this),this.actions=[],C&&this.fromPoints(C)},Yg=Iq.prototype=ji(le.prototype),_o="moveTo",Fj="lineTo",uq="quadraticCurveTo",uh="bezierCurveTo",pr="arc",cq="ellipse";Yg.fromPoints=function(z){this.moveTo(z[0].x,z[0].y);for(var L=1,e=z.length;e>L;L++)this.lineTo(z[L].x,z[L].y)},Yg.moveTo=function(){var f=Array.prototype.slice.call(arguments);this.actions.push({action:_o,args:f})},Yg.lineTo=function(E,p){var g=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,e=D[D.length-2],F=D[D.length-1],L=new de(new kp(e,F),new kp(E,p));this.curves.push(L),this.actions.push({action:Fj,args:g})},Yg.quadraticCurveTo=function(W,m,$,V){var w=Array.prototype.slice.call(arguments),X=this.actions[this.actions.length-1].args,z=X[X.length-2],d=X[X.length-1],C=new pb(new kp(z,d),new kp(W,m),new kp($,V));this.curves.push(C),this.actions.push({action:uq,args:w})},Yg.bezierCurveTo=function(P,D,S,f,i,V){var H=Array.prototype.slice.call(arguments),L=this.actions[this.actions.length-1].args,X=L[L.length-2],K=L[L.length-1],g=new Wq(new kp(X,K),new kp(P,D),new kp(S,f),new kp(i,V));this.curves.push(g),this.actions.push({action:uh,args:H})},Yg.arc=function(E,p,d,H,r,n){var U=this.actions[this.actions.length-1].args,A=U[U.length-2],F=U[U.length-1];this.absarc(E+A,p+F,d,H,r,n)},Yg.absarc=function(M,B,X,c,P,n){this.absellipse(M,B,X,X,c,P,n)},Yg.ellipse=function(D,y,j,V,M,p,R){var X=this.actions[this.actions.length-1].args,x=X[X.length-2],B=X[X.length-1];this.absellipse(D+x,y+B,j,V,M,p,R)},Yg.absellipse=function(p,E,k,e,A,b,U){var V=Array.prototype.slice.call(arguments),g=new zl(p,E,k,e,A,b,U);this.curves.push(g);var j=g.getPoint(1);V.push(j.x),V.push(j.y),this.actions.push({action:cq,args:V})},Yg.getSpacedPoints=function(B){B||(B=40);for(var N=[],U=0;B>U;U++)N.push(this.getPoint(U/B));return N},Yg.getPoints=function(K,u){K=K||12;var c,A,f,W,N,q,X,$,h,T,G,t,a,M,w,R,U,n,o=[];for(c=0,A=this.actions.length;A>c;c++)switch(f=this.actions[c],W=f.action,N=f.args,W){case _o:o.push(new kp(N[0],N[1]));break;case Fj:o.push(new kp(N[0],N[1]));break;case uq:for(q=N[2],X=N[3],T=N[0],G=N[1],o.length>0?(M=o[o.length-1],t=M.x,a=M.y):(M=this.actions[c-1].args,t=M[M.length-2],a=M[M.length-1]),w=1;K>=w;w++)R=w/K,U=Ld.b2(R,t,T,q),n=Ld.b2(R,a,G,X),o.push(new kp(U,n));break;case uh:for(q=N[4],X=N[5],T=N[0],G=N[1],$=N[2],h=N[3],o.length>0?(M=o[o.length-1],t=M.x,a=M.y):(M=this.actions[c-1].args,t=M[M.length-2],a=M[M.length-1]),w=1;K>=w;w++)R=w/K,U=Ld.b3(R,t,T,$,q),n=Ld.b3(R,a,G,h,X),o.push(new kp(U,n));break;case pr:var O,s=N[0],Z=N[1],D=N[2],V=N[3],F=N[4],C=!!N[5],H=F-V,y=2*K;for(w=1;y>=w;w++)R=w/y,C||(R=1-R),O=V+R*H,U=s+D*_(O),n=Z+D*E(O),o.push(new kp(U,n));break;case cq:var O,s=N[0],Z=N[1],z=N[2],Y=N[3],V=N[4],F=N[5],C=!!N[6],H=F-V,y=2*K;for(w=1;y>=w;w++)R=w/y,C||(R=1-R),O=V+R*H,U=s+z*_(O),n=Z+Y*E(O),o.push(new kp(U,n))}var i=o[o.length-1],p=1e-10;return g(i.x-o[0].x)<p&&g(i.y-o[0].y)<p&&o.splice(o.length-1,1),u&&o.push(o[0]),o},Yg.toShapes=function(h,b){function S(P){var t,e,j,X,q,d=[],w=new Iq;for(t=0,e=P.length;e>t;t++)j=P[t],q=j.args,X=j.action,X==_o&&0!=w.actions.length&&(d.push(w),w=new Iq),w[X].apply(w,q);return 0!=w.actions.length&&d.push(w),d}function Y(K){for(var s=[],E=0,B=K.length;B>E;E++){var V=K[E],f=new _g;f.actions=V.actions,f.curves=V.curves,s.push(f)}return s}function y(U,c){for(var n=1e-10,l=c.length,L=!1,m=l-1,T=0;l>T;m=T++){var y=c[m],E=c[T],Y=E.x-y.x,d=E.y-y.y;if(g(d)>n){if(0>d&&(y=c[T],Y=-Y,E=c[m],d=-d),U.y<y.y||U.y>E.y)continue;if(U.y==y.y){if(U.x==y.x)return!0}else{var I=d*(U.x-y.x)-Y*(U.y-y.y);if(0==I)return!0;if(0>I)continue;L=!L}}else{if(U.y!=y.y)continue;if(E.x<=U.x&&U.x<=y.x||y.x<=U.x&&U.x<=E.x)return!0}}return L}var L=S(this.actions);if(0==L.length)return[];if(b===!0)return Y(L);var B,k,r,o=[];if(1==L.length)return k=L[0],r=new _g,r.actions=k.actions,r.curves=k.curves,o.push(r),o;var D=!_g.Utils.isClockWise(L[0].getPoints());D=h?!D:D;var U,_=[],I=[],m=[],d=0;I[d]=Z,m[d]=[];var t,V;for(t=0,V=L.length;V>t;t++)k=L[t],U=k.getPoints(),B=Ld.isClockWise(U),B=h?!B:B,B?(!D&&I[d]&&d++,I[d]={s:new _g,p:U},I[d].s.actions=k.actions,I[d].s.curves=k.curves,D&&d++,m[d]=[]):m[d].push({h:k,p:U[0]});if(!I[0])return Y(L);if(I.length>1){for(var s=!1,A=[],J=0,c=I.length;c>J;J++)_[J]=[];for(var J=0,c=I.length;c>J;J++){I[J];for(var z=m[J],w=0;w<z.length;w++){for(var T=z[w],W=!0,Q=0;Q<I.length;Q++)y(T.p,I[Q].p)&&(J!=Q&&A.push({froms:J,tos:Q,hole:w}),W?(W=!1,_[Q].push(T)):s=!0);W&&_[J].push(T)}}A.length>0&&(s||(m=_))}var v,C,E;for(t=0,V=I.length;V>t;t++)for(r=I[t].s,o.push(r),v=m[t],C=0,E=v.length;E>C;C++)r.holes.push(v[C].h);return o};var _g=function(){Iq.apply(this,arguments),this.holes=[]},Ai=_g.prototype=ji(Yg);Ai.getPointsHoles=function(P){var M,t=this.holes.length,k=[];for(M=0;t>M;M++)k[M]=this.holes[M].getTransformedPoints(P);return k},Ai.extractAllPoints=function(y){return{shape:this.getTransformedPoints(y),holes:this.getPointsHoles(y)}},Ai.extractPoints=function(S){return this.extractAllPoints(S)};var Ld={triangulateShape:function(J,K){function W(X,x,C){return X.x!=x.x?X.x<x.x?X.x<=C.x&&C.x<=x.x:x.x<=C.x&&C.x<=X.x:X.y<x.y?X.y<=C.y&&C.y<=x.y:x.y<=C.y&&C.y<=X.y}function Q(Y,b,c,K,I){var P=1e-10,_=b.x-Y.x,O=b.y-Y.y,N=K.x-c.x,J=K.y-c.y,M=Y.x-c.x,E=Y.y-c.y,v=O*N-_*J,z=O*M-_*E;if(g(v)>P){var a;if(v>0){if(0>z||z>v)return[];if(a=J*M-N*E,0>a||a>v)return[]}else{if(z>0||v>z)return[];if(a=J*M-N*E,a>0||v>a)return[]}if(0==a)return!I||0!=z&&z!=v?[Y]:[];if(a==v)return!I||0!=z&&z!=v?[b]:[];if(0==z)return[c];if(z==v)return[K];var o=a/v;return[{x:Y.x+o*_,y:Y.y+o*O}]}if(0!=z||J*M!=N*E)return[];var r=0==_&&0==O,X=0==N&&0==J;if(r&&X)return Y.x!=c.x||Y.y!=c.y?[]:[Y];if(r)return W(c,K,Y)?[Y]:[];if(X)return W(Y,b,c)?[c]:[];var H,F,m,C,p,R,u,Z;return 0!=_?(Y.x<b.x?(H=Y,m=Y.x,F=b,C=b.x):(H=b,m=b.x,F=Y,C=Y.x),c.x<K.x?(p=c,u=c.x,R=K,Z=K.x):(p=K,u=K.x,R=c,Z=c.x)):(Y.y<b.y?(H=Y,m=Y.y,F=b,C=b.y):(H=b,m=b.y,F=Y,C=Y.y),c.y<K.y?(p=c,u=c.y,R=K,Z=K.y):(p=K,u=K.y,R=c,Z=c.y)),u>=m?u>C?[]:C==u?I?[]:[p]:Z>=C?[p,F]:[p,R]:m>Z?[]:m==Z?I?[]:[H]:Z>=C?[H,F]:[H,R]}function j(U,z,A,n){var F=1e-10,S=z.x-U.x,s=z.y-U.y,C=A.x-U.x,I=A.y-U.y,m=n.x-U.x,f=n.y-U.y,h=S*I-s*C,l=S*f-s*m;if(g(h)>F){var c=m*I-f*C;return h>0?l>=0&&c>=0:l>=0||c>=0}return l>0}function b(w,v){function Y(h,V){var P=F.length-1,q=h-1;0>q&&(q=P);var e=h+1;e>P&&(e=0);var E=j(F[h],F[q],F[e],W[V]);if(!E)return!1;var s=W.length-1,D=V-1;0>D&&(D=s);var o=V+1;return o>s&&(o=0),E=j(W[V],W[D],W[o],F[h]),E?!0:!1}function u(w,P){var z,u,o;for(z=0;z<F.length;z++)if(u=z+1,u%=F.length,o=Q(w,P,F[z],F[u],!0),o.length>0)return!0;return!1}function N(p,D){var x,l,N,y,$;for(x=0;x<E.length;x++)for(l=v[E[x]],N=0;N<l.length;N++)if(y=N+1,y%=l.length,$=Q(p,D,l[N],l[y],!0),$.length>0)return!0;return!1}for(var W,R,r,x,L,y,i,k,X,f,J,F=w.concat(),E=[],O=[],M=0,q=v.length;q>M;M++)E.push(M);for(var b=0,T=2*E.length;E.length>0&&(T--,!(0>T));)for(r=b;r<F.length;r++){x=F[r],R=-1;for(var M=0;M<E.length;M++)if(y=E[M],i=x.x+":"+x.y+":"+y,O[i]===Z){W=v[y];for(var H=0;H<W.length;H++)if(L=W[H],Y(r,H)&&!u(x,L)&&!N(x,L)){R=H,E.splice(M,1),k=F.slice(0,r+1),X=F.slice(r),f=W.slice(R),J=W.slice(0,R+1),F=k.concat(f).concat(J).concat(X),b=r;break}if(R>=0)break;O[i]=!0}if(R>=0)break}return F}for(var C,B,z,a,N,k,O={},I=J.concat(),L=0,P=K.length;P>L;L++)Array.prototype.push.apply(I,K[L]);for(C=0,B=I.length;B>C;C++)N=I[C].x+":"+I[C].y,O[N]!==Z,O[N]=C;var i=b(J,K),p=Ug.Triangulate(i,!1);for(C=0,B=p.length;B>C;C++)for(a=p[C],z=0;3>z;z++)N=a[z].x+":"+a[z].y,k=O[N],k!==Z&&(a[z]=k);return p.concat()},isClockWise:function(k){return Ug.Triangulate.area(k)<0},b2p0:function(i,L){var y=1-i;return y*y*L},b2p1:function(X,j){return 2*(1-X)*X*j},b2p2:function(x,o){return x*x*o},b2:function(i,$,t,V){return this.b2p0(i,$)+this.b2p1(i,t)+this.b2p2(i,V)},b3p0:function(S,c){var x=1-S;return x*x*x*c},b3p1:function(Q,X){var z=1-Q;return 3*z*z*Q*X},b3p2:function(y,G){var U=1-y;return 3*U*y*y*G},b3p3:function(j,i){return j*j*j*i},b3:function(v,M,y,A,C){return this.b3p0(v,M)+this.b3p1(v,y)+this.b3p2(v,A)+this.b3p3(v,C)}},Ug={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(F){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(T){var A=T.familyName.toLowerCase(),n=this;return n.faces[A]=n.faces[A]||{},n.faces[A][T.cssFontWeight]=n.faces[A][T.cssFontWeight]||{},n.faces[A][T.cssFontWeight][T.cssFontStyle]=T,n.faces[A][T.cssFontWeight][T.cssFontStyle]=T,T},drawText:function(k){var q,h=this.getFace(),j=this.size/h.resolution,W=0,M=String(k).split(""),X=M.length,B=[];for(q=0;X>q;q++){var K=new Iq,p=this.extractGlyphPoints(M[q],h,j,W,K);W+=p.offset,B.push(p.path)}var U=W/2;return{paths:B,offset:U}},extractGlyphPoints:function(p,I,L,z,X){var u,N,F,A,n,o,b,j,l,O,f,B,t,J,T,s,P,Y,Z,G=[],R=I.glyphs[p]||I.glyphs["?"];if(R){if(R.o)for(A=R._cachedOutline||(R._cachedOutline=R.o.split(" ")),o=A.length,b=L,j=L,u=0;o>u;)switch(n=A[u++]){case"m":l=A[u++]*b+z,O=A[u++]*j,X.moveTo(l,O);break;case"l":l=A[u++]*b+z,O=A[u++]*j,X.lineTo(l,O);break;case"q":if(f=A[u++]*b+z,B=A[u++]*j,T=A[u++]*b+z,s=A[u++]*j,X.quadraticCurveTo(T,s,f,B),Z=G[G.length-1])for(t=Z.x,J=Z.y,N=1,F=this.divisions;F>=N;N++){var e=N/F;Ld.b2(e,t,T,f),Ld.b2(e,J,s,B)}break;case"b":if(f=A[u++]*b+z,B=A[u++]*j,T=A[u++]*b+z,s=A[u++]*j,P=A[u++]*b+z,Y=A[u++]*j,X.bezierCurveTo(T,s,P,Y,f,B),Z=G[G.length-1])for(t=Z.x,J=Z.y,N=1,F=this.divisions;F>=N;N++){var e=N/F;Ld.b3(e,t,T,P,f),Ld.b3(e,J,s,Y,B)}}return{offset:R.ha*L,path:X}}}};Ug.generateShapes=function(x,e){e=e||{};var q=e.size!==Z?e.size:100,g=e.curveSegments!==Z?e.curveSegments:4,y=e.font!==Z?e.font:"helvetiker",U=e.weight!==Z?e.weight:"normal",F=e.style!==Z?e.style:"normal";Ug.size=q,Ug.divisions=g,Ug.face=y,Ug.weight=U,Ug.style=F;for(var C=Ug.drawText(x),d=C.paths,m=[],t=0,c=d.length;c>t;t++)Array.prototype.push.apply(m,d[t].toShapes());return m},function($){var o=1e-10,l=function(d,k){var F=d.length;if(3>F)return null;var S,Q,U,$=[],C=[],e=[];if(K(d)>0)for(Q=0;F>Q;Q++)C[Q]=Q;else for(Q=0;F>Q;Q++)C[Q]=F-1-Q;var L=F,l=2*L;for(Q=L-1;L>2;){if(l--<=0)return k?e:$;if(S=Q,S>=L&&(S=0),Q=S+1,Q>=L&&(Q=0),U=Q+1,U>=L&&(U=0),X(d,S,Q,U,L,C)){var P,i,a,j,I;for(P=C[S],i=C[Q],a=C[U],$.push([d[P],d[i],d[a]]),e.push([C[S],C[Q],C[U]]),j=Q,I=Q+1;L>I;j++,I++)C[j]=C[I];L--,l=2*L}}return k?e:$},K=function(Y){for(var D=Y.length,Q=0,j=D-1,l=0;D>l;j=l++)Q+=Y[j].x*Y[l].y-Y[l].x*Y[j].y;return.5*Q},X=function(R,e,U,f,S,x){var u,L,B,E,T,$,z,_,c;if(L=R[x[e]].x,B=R[x[e]].y,E=R[x[U]].x,T=R[x[U]].y,$=R[x[f]].x,z=R[x[f]].y,o>(E-L)*(z-B)-(T-B)*($-L))return!1;var V,M,Q,N,Z,b,J,y,a,X,C,P,w,r,g;for(V=$-E,M=z-T,Q=L-$,N=B-z,Z=E-L,b=T-B,u=0;S>u;u++)if(_=R[x[u]].x,c=R[x[u]].y,!(_===L&&c===B||_===E&&c===T||_===$&&c===z)&&(J=_-L,y=c-B,a=_-E,X=c-T,C=_-$,P=c-z,g=V*X-M*a,w=Z*y-b*J,r=Q*P-N*C,g>=-o&&r>=-o&&w>=-o))return!1;return!0};return $.Triangulate=l,$.Triangulate.area=K,$}(Ug),O._typeface_js={faces:Ug.faces,loadFace:Ug.loadFace};var dq=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Rf=dq.prototype={constructor:dq,computeFaceNormals:function(){for(var d=new hl,C=new hl,z=0,T=this.faces.length;T>z;z++){var Y=this.faces[z],l=this.vertices[Y.a],M=this.vertices[Y.b],a=this.vertices[Y.c];d.subVectors(a,M),C.subVectors(l,M),d.cross(C),d.normalize(),Y.normal.copy(d)}},computeVertexNormals:function(k){var w,t,g,f,p,h;for(h=new Array(this.vertices.length),w=0,t=this.vertices.length;t>w;w++)h[w]=new hl;if(k){var Q,l,M,L=new hl,m=new hl;for(g=0,f=this.faces.length;f>g;g++)p=this.faces[g],Q=this.vertices[p.a],l=this.vertices[p.b],M=this.vertices[p.c],L.subVectors(M,l),m.subVectors(Q,l),L.cross(m),h[p.a].add(L),h[p.b].add(L),h[p.c].add(L)}else for(g=0,f=this.faces.length;f>g;g++)p=this.faces[g],h[p.a].add(p.normal),h[p.b].add(p.normal),h[p.c].add(p.normal);for(w=0,t=this.vertices.length;t>w;w++)h[w].normalize();for(g=0,f=this.faces.length;f>g;g++)p=this.faces[g],p.vertexNormals[0]=h[p.a].clone(),p.vertexNormals[1]=h[p.b].clone(),p.vertexNormals[2]=h[p.c].clone()},mergeVertices:function(){var m,v,g,R,e,D,T,N,p={},W=[],r=[],d=4,M=l(10,d);for(g=0,R=this.vertices.length;R>g;g++)m=this.vertices[g],v=I(m.x*M)+"_"+I(m.y*M)+"_"+I(m.z*M),p[v]===Z?(p[v]=g,W.push(this.vertices[g]),r[g]=W.length-1):r[g]=r[p[v]];var Y=[];for(g=0,R=this.faces.length;R>g;g++){e=this.faces[g],e.a=r[e.a],e.b=r[e.b],e.c=r[e.c],D=[e.a,e.b,e.c];for(var h=0;3>h;h++)if(D[h]==D[(h+1)%3]){Y.push(g);break}}for(g=Y.length-1;g>=0;g--){var Q=Y[g];for(this.faces.splice(Q,1),T=0,N=this.faceVertexUvs.length;N>T;T++)this.faceVertexUvs[T].splice(Q,1)}var i=this.vertices.length-W.length;return this.vertices=W,i}},zl=function(Z,P,z,V,R,W,M){this.aX=Z,this.aY=P,this.xRadius=z,this.yRadius=V,this.aStartAngle=R,this.aEndAngle=W,this.aClockwise=M};zl.prototype=ji($r),zl.prototype.getPoint=function(g){var J,L=this.aEndAngle-this.aStartAngle;0>L&&(L+=x),L>x&&(L-=x),J=this.aClockwise===!0?this.aEndAngle+(1-g)*(x-L):this.aStartAngle+g*L;var R=this.aX+this.xRadius*_(J),S=this.aY+this.yRadius*E(J);return new kp(R,S)};var de=function(q,T){this.v1=q,this.v2=T},Hr=de.prototype=ji($r);Hr.getPoint=function(k){var Q=this.v2.clone().sub(this.v1);return Q.multiplyScalar(k).add(this.v1),Q},Hr.getPointAt=function(M){return this.getPoint(M)},Hr.getTangent=function(){var w=this.v2.clone().sub(this.v1);return w.normalize()};var pb=function(U,J,M){this.v0=U,this.v1=J,this.v2=M};pb.prototype=ji($r),pb.prototype.getPoint=function(x){var V,G;return V=Ld.b2(x,this.v0.x,this.v1.x,this.v2.x),G=Ld.b2(x,this.v0.y,this.v1.y,this.v2.y),new kp(V,G)};var Wq=function(Z,q,m,V){this.v0=Z,this.v1=q,this.v2=m,this.v3=V};Wq.prototype=ji($r),Wq.prototype.getPoint=function(l){var m,I;return m=Ld.b3(l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),I=Ld.b3(l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new kp(m,I)},zg.create(function(R,Y){this.v1=R,this.v2=Y},function(t){var L=new hl;return L.subVectors(this.v2,this.v1),L.multiplyScalar(t),L.add(this.v1),L});var Xk=zg.create(function(m,T,e){this.v0=m,this.v1=T,this.v2=e},function(X){var R,A,y;return R=Ld.b2(X,this.v0.x,this.v1.x,this.v2.x),A=Ld.b2(X,this.v0.y,this.v1.y,this.v2.y),y=Ld.b2(X,this.v0.z,this.v1.z,this.v2.z),new hl(R,A,y)}),yk=zg.create(function(Y,I,a,e){this.v0=Y,this.v1=I,this.v2=a,this.v3=e},function(C){var q,k,_;return q=Ld.b3(C,this.v0.x,this.v1.x,this.v2.x,this.v3.x),k=Ld.b3(C,this.v0.y,this.v1.y,this.v2.y,this.v3.y),_=Ld.b3(C,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new hl(q,k,_)}),_n=function(Y,h,o,n,c,f,H,p){dq.call(this),n=n!==Z?n:.5,c=c!==Z?c:.5,p=p!==Z?p:1,Y=Y||8,f=f||0,H=H||x;var l,K,S=1,t=p/2,g=[],w=[],T=this.vertices,D=this.faces,V=this.faceVertexUvs;for(K=0;S>=K;K++){var m=[],J=[],j=K/S,F=j*(c-n)+n;for(l=0;Y>=l;l++){var i=l/Y,Q=new hl,M=-(i*H+f);Q.z=F*E(M),Q.y=-j*p+t,Q.x=F*_(M),T.push(Q),m.push(T.length-1),J.push(new kp(i,j))}g.push(m),w.push(J)}var s,C,$=(c-n)/p;for(l=0;Y>l;l++)for(0!==n?(s=T[g[0][l]].clone(),C=T[g[0][l+1]].clone()):(s=T[g[1][l]].clone(),C=T[g[1][l+1]].clone()),s.setY(k(s.x*s.x+s.z*s.z)*$).normalize(),C.setY(k(C.x*C.x+C.z*C.z)*$).normalize(),K=0;S>K;K++){var y=g[K][l],d=g[K+1][l],u=g[K+1][l+1],B=g[K][l+1],U=s.clone(),a=s.clone(),e=C.clone(),I=C.clone(),q=w[K][l].clone(),W=w[K+1][l].clone(),L=w[K+1][l+1].clone(),r=w[K][l+1].clone();
D.push(new Vc(y,d,B,[U,a,I])),V[0].push([q,W,r]),D.push(new Vc(d,u,B,[a.clone(),e,I.clone()])),V[0].push([W.clone(),L,r.clone()])}if(h&&n>0)for(this.vertices.push(new hl(0,t,0)),l=0;Y>l;l++){var y=g[0][l],d=g[0][l+1],u=this.vertices.length-1,U=new hl(0,1,0),a=new hl(0,1,0),e=new hl(0,1,0),q=w[0][l].clone(),W=w[0][l+1].clone(),L=new kp(W.x,0);D.push(new Vc(y,d,u,[U,a,e],null,1));var A=l/Y*x,O=_(A),R=E(A),G=(l+1)/Y*x,N=_(G),X=E(G);V[0].push([new kp(.5+.5*O,.5+.5*R),new kp(.5+.5*N,.5+.5*X),new kp(.5,.5)])}if(o&&c>0)for(this.vertices.push(new hl(0,-t,0)),l=0;Y>l;l++){var y=g[K][l+1],d=g[K][l],u=T.length-1,U=new hl(0,-1,0),a=new hl(0,-1,0),e=new hl(0,-1,0),q=w[K][l+1].clone(),W=w[K][l].clone();D.push(new Vc(y,d,u,[U,a,e],null,2));var A=l/Y*x,O=_(A),R=E(A),G=(l+1)/Y*x,N=_(G),X=E(G);V[0].push([new kp(.5+.5*N,.5-.5*X),new kp(.5+.5*O,.5-.5*R),new kp(.5,.5)])}};_n.prototype=ji(Rf);var wc=function(r,z,N,t,Q,J,D){dq.call(this),D=D||.5,r=r||16,z=z||16,N=(N!==Z?N:0)-R,t=t!==Z?t:x,Q=Q!==Z?Q:0,J=J!==Z?J:R;var c,M,w=[],V=[],P=this.vertices,i=this.faces,o=this.faceVertexUvs;for(M=0;z>=M;M++){var q=[],C=[];for(c=0;r>=c;c++){var T=c/r,O=M/z,s=new hl;s.x=-D*_(N+T*t)*E(Q+O*J),s.y=D*_(Q+O*J),s.z=D*E(N+T*t)*E(Q+O*J),P.push(s),q.push(P.length-1),C.push(new kp(T,O))}w.push(q),V.push(C)}for(M=0;z>M;M++)for(c=0;r>c;c++){var K=w[M][c+1],l=w[M][c],b=w[M+1][c],G=w[M+1][c+1],I=P[K].clone().normalize(),j=P[l].clone().normalize(),A=P[b].clone().normalize(),e=P[G].clone().normalize(),Y=V[M][c+1].clone(),u=V[M][c].clone(),F=V[M+1][c].clone(),p=V[M+1][c+1].clone();g(P[K].y)===D?(Y.x=(Y.x+u.x)/2,i.push(new Vc(K,b,G,[I,A,e])),o[0].push([Y,F,p])):g(P[b].y)===D?(F.x=(F.x+p.x)/2,i.push(new Vc(K,l,b,[I,j,A])),o[0].push([Y,u,F])):(i.push(new Vc(K,l,G,[I,j,e])),o[0].push([Y,u,p]),i.push(new Vc(l,b,G,[j.clone(),A,e.clone()])),o[0].push([u.clone(),F,p.clone()]))}};wc.prototype=ji(Rf);var zp=function(X,f,a,W,e,b){dq.call(this),X=X||.33,f=f||.17,W=W||8,a=a||6,e=e||0,b=b||x;for(var s=new hl,g=[],d=[],r=0;W>=r;r++)for(var w=r/W*x+R,m=0;a>=m;m++){var A=m/a*b+e;s.x=X*_(A),s.z=-X*E(A);var k=new hl,C=X+f*_(w);k.x=C*_(A),k.z=-C*E(A),k.y=f*E(w),this.vertices.push(k),g.push(new kp(m/a,1-r/W)),d.push(k.clone().sub(s).normalize())}for(var r=1;W>=r;r++)for(var m=1;a>=m;m++){var h=(a+1)*r+m-1,n=(a+1)*(r-1)+m-1,t=(a+1)*(r-1)+m,p=(a+1)*r+m,j=new Vc(h,n,p,[d[h].clone(),d[n].clone(),d[p].clone()]);this.faces.push(j),this.faceVertexUvs[0].push([g[h].clone(),g[n].clone(),g[p].clone()]),j=new Vc(n,t,p,[d[n].clone(),d[t].clone(),d[p].clone()]),this.faces.push(j),this.faceVertexUvs[0].push([g[n].clone(),g[t].clone(),g[p].clone()])}this.computeFaceNormals()};zp.prototype=ji(Rf);var hs=function(t,_,d){return t?(dq.call(this),t=t instanceof Array?t:[t],this.addShapeList(t,_),Wg(this,d),this.computeFaceNormals(),void 0):(t=[],void 0)},wl=hs.prototype=ji(dq.prototype);wl.addShapeList=function(N,U){for(var p=N.length,y=0;p>y;y++){var $=N[y];this.addShape($,U)}},wl.addShape=function(W,o){function w(){if(o.bottom)for(var r=0;g>r;r++)Y=p[r],k(Y[2],Y[1],Y[0],!0);if(o.top)for(r=0;g>r;r++)Y=p[r],k(Y[0]+J*V,Y[1]+J*V,Y[2]+J*V,!1)}function e(){var B=0;for($(q,B),B+=q.length,M=0,R=L.length;R>M;M++)Q=L[M],$(Q,B),B+=Q.length}function $(N,G){for(var l,S,E=N.length;--E>=0;){l=E,S=E-1,0>S&&(S=N.length-1);var v=0,j=V;for(v=0;j>v;v++){var q=J*v,t=J*(v+1),I=G+l+q,y=G+S+q,u=G+S+t,A=G+l+t;b(I,y,u,A,N,v,j,l,S)}}}function i(T,m,g){E.vertices.push(new hl(T,m,g))}function k(b,C,R,m){b+=r,C+=r,R+=r,E.faces.push(new Vc(b,C,R,null,null,m?2:1));var O=m?j.generateBottomUV(E,W,o,b,C,R):j.generateTopUV(E,W,o,b,C,R);E.faceVertexUvs[0].push(O)}function b(x,H,Q,L,K,w,t,F,U){x+=r,H+=r,Q+=r,L+=r,E.faces.push(new Vc(x,H,L)),E.faces.push(new Vc(H,Q,L));var O=j.generateSideWallUV(E,W,K,o,x,H,Q,L,w,t,F,U);E.faceVertexUvs[0].push([O[0],O[1],O[3]]),E.faceVertexUvs[0].push([O[1],O[2],O[3]])}var m,I,K,F,c,O=o.amount,t=o.curveSegments||Fd,V=o.steps||1,G=o.extrudePath,s=!1,j=new En(o.repeatUVLength);G&&(m=G.getSpacedPoints(V),s=!0,I=o.frames!==Z?o.frames:new Gg.FrenetFrames(G,V,!1),K=new hl,F=new hl,c=new hl);var Q,M,R,E=this,r=this.vertices.length,C=W.extractPoints(t),x=C.shape,L=C.holes,a=!Ld.isClockWise(x);if(a){for(x=x.reverse(),M=0,R=L.length;R>M;M++)Q=L[M],Ld.isClockWise(Q)&&(L[M]=Q.reverse());a=!1}var p=Ld.triangulateShape(x,L),q=x;for(M=0,R=L.length;R>M;M++)Q=L[M],x=x.concat(Q);for(var y,Y,J=x.length,g=p.length,H=0;J>H;H++)y=x[H],s?(F.copy(I.normals[0]).multiplyScalar(y.x),K.copy(I.binormals[0]).multiplyScalar(y.y),c.copy(m[0]).add(F).add(K),i(c.x,c.y,c.z)):i(y.x,y.y,0);var D;for(D=1;V>=D;D++)for(H=0;J>H;H++)y=x[H],s?(F.copy(I.normals[D]).multiplyScalar(y.x),K.copy(I.binormals[D]).multiplyScalar(y.y),c.copy(m[D]).add(F).add(K),i(c.x,c.y,c.z)):i(y.x,y.y,O/V*D);w(),e()};var Gg=function(A,v,G,J,i){function L(e,D,v){return c.vertices.push(new hl(e,D,v))-1}dq.call(this),v=v||64,G=G||1,J=J||8,i=i||!1;var Y,y,z,h,w,M,j,r,g,Z,D,K,$,T,k,X,B,W,C,P,V=[],c=this,q=v+1,m=new hl,n=new Gg.FrenetFrames(A,v,i),d=n.tangents,p=n.normals,N=n.binormals;for(this.tangents=d,this.normals=p,this.binormals=N,g=0;q>g;g++)for(V[g]=[],h=g/(q-1),r=A.getPointAt(h),Y=d[g],y=p[g],z=N[g],Z=0;J>Z;Z++)w=Z/J*x,M=-G*_(w),j=G*E(w),m.copy(r),m.x+=M*y.x+j*z.x,m.y+=M*y.y+j*z.y,m.z+=M*y.z+j*z.z,V[g][Z]=L(m.x,m.y,m.z);for(g=0;v>g;g++)for(Z=0;J>Z;Z++)D=i?(g+1)%v:g+1,K=(Z+1)%J,$=V[g][Z],T=V[D][Z],k=V[D][K],X=V[g][K],B=new kp(g/v,Z/J),W=new kp((g+1)/v,Z/J),C=new kp((g+1)/v,(Z+1)/J),P=new kp(g/v,(Z+1)/J),this.faces.push(new Vc($,T,X)),this.faceVertexUvs[0].push([B,W,P]),this.faces.push(new Vc(T,k,X)),this.faceVertexUvs[0].push([W.clone(),C,P.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Gg.prototype=ji(Rf),Gg.FrenetFrames=function(m,O,Y){function L(){Q[0]=new hl,x[0]=new hl,I=Number.MAX_VALUE,S=g(k[0].x),t=g(k[0].y),U=g(k[0].z),I>=S&&(I=S,w.set(1,0,0)),I>=t&&(I=t,w.set(0,1,0)),I>=U&&w.set(0,0,1),$.crossVectors(k[0],w).normalize(),Q[0].crossVectors(k[0],$),x[0].crossVectors(k[0],Q[0])}var F,I,S,t,U,Z,R,w=new hl,k=[],Q=[],x=[],$=new hl,C=new bf,W=O+1,r=1e-4;for(this.tangents=k,this.normals=Q,this.binormals=x,Z=0;W>Z;Z++)R=Z/(W-1),k[Z]=m.getTangentAt(R),k[Z].normalize();for(L(),Z=1;W>Z;Z++)Q[Z]=Q[Z-1].clone(),x[Z]=x[Z-1].clone(),$.crossVectors(k[Z-1],k[Z]),$.length()>r&&($.normalize(),F=T(ic(k[Z-1].dot(k[Z]),-1,1)),Q[Z].applyMatrix4(C.makeRotationAxis($,F))),x[Z].crossVectors(k[Z],Q[Z]);if(Y)for(F=T(ic(Q[0].dot(Q[W-1]),-1,1)),F/=W-1,k[0].dot($.crossVectors(Q[0],Q[W-1]))>0&&(F=-F),Z=1;W>Z;Z++)Q[Z].applyMatrix4(C.makeRotationAxis(k[Z],F*Z)),x[Z].crossVectors(k[Z],Q[Z])};var fc=function(D,u,I,p){dq.call(this),u=u||18,I=I||0,p=p==t?x:p;for(var j=1/(D.length-1),K=1/u,J=0,G=u;G>=J;J++)for(var M=I+J*K*p,Q=_(M),q=E(M),W=0,T=D.length;T>W;W++){var h=D[W],B=new hl;B.x=Q*h.x-q*h.y,B.y=q*h.x+Q*h.y,B.z=h.z,this.vertices.push(B)}for(var Y=D.length,J=0,G=u;G>J;J++)for(var W=0,T=D.length-1;T>W;W++){var m=W+Y*J,z=m,N=m+Y,Q=m+1+Y,b=m+1,H=J*K,c=W*j,r=H+K,$=c+j;this.faces.push(new Vc(z,b,N)),this.faceVertexUvs[0].push([new kp(H,c),new kp(H,$),new kp(r,c)]),this.faces.push(new Vc(N,b,Q)),this.faceVertexUvs[0].push([new kp(r,c),new kp(H,$),new kp(r,$)])}this.mergeVertices(),Wg(this),this.computeFaceNormals(),this.computeVertexNormals()};fc.prototype=ji(Rf);var Yh=function(t,f){f=f||{};var G=Ug.generateShapes(t,f);f.amount=f.height!==Z?f.height:50,hs.call(this,G,f)};Yh.prototype=ji(wl);var Bg=p.Node=function(){Ag(Bg,this)},Zq={X:Cg,Y:kd,Z:Kh},Zg={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},jk="xzy",El=function(j,O,v){if(O){var n=O[0],w=O[1],d=O[2];"xzy"===v?(kd(j,w),Kh(j,d),Cg(j,n)):"xyz"===v?(Kh(j,d),kd(j,w),Cg(j,n)):"yxz"===v?(Kh(j,d),Cg(j,n),kd(j,w)):"yzx"===v?(Cg(j,n),Kh(j,d),kd(j,w)):"zxy"===v?(kd(j,w),Cg(j,n),Kh(j,d)):"zyx"===v?(Cg(j,n),kd(j,w),Kh(j,d)):(kd(j,w),Kh(j,d),Cg(j,n))}};Qr("Node",pc,{ms_ac:["rotationMode","tall"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:jk,_rotation:0,_rotationX:0,_rotationZ:0,_host:t,_position:{x:0,y:0},_tall:20,_elevation:0,getUIClass:function(){return af},get3dUIClass:function(){return fr},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(w,E){Ko(w,Hn(t,t,this.r3(),this.getRotationMode())),this.translate3d(w[0]*E,w[1]*E,w[2]*E)},translateFront:function(l){this.translate3dBy([0,0,1],l)},translateBack:function(I){this.translate3dBy([0,0,-1],I)},translateLeft:function(D){this.translate3dBy([-1,0,0],D)},translateRight:function(G){this.translate3dBy([1,0,0],G)},translateTop:function(Z){this.translate3dBy([0,1,0],Z)},translateBottom:function(p){this.translate3dBy([0,-1,0],p)},getPosition3d:function(){return[this._position.x,this._elevation,this._position.y]},setPosition3d:function(x,t,U){1===arguments.length&&(t=x[1],U=x[2],x=x[0]),this.p(x,U),this.setElevation(t)},translate3d:function(Y,e,s){1===arguments.length&&(e=Y[1],s=Y[2],Y=Y[0]),this.translate(Y,s),this.setElevation(this._elevation+e)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(a,Q,q){1===arguments.length&&(Q=a[1],q=a[2],a=a[0]),this.setSize(a,q),this.setTall(Q)},getRotation3d:function(){return[this._rotationX,-this._rotation,this._rotationZ]},setRotation3d:function(H,o,K){1===arguments.length&&(o=H[1],K=H[2],H=H[0]),this.setRotationX(H),this.setRotation(-o),this.setRotationZ(K)},setRotationY:function(y){this.setRotation(-y)},getRotationY:function(){return-this._rotation},lookAt:function(q,T){T=T||v;var S=this,V=id(q,S.p3()),g=Uk(V);T===v?(S.r3([-B(V[1]/g),-W(V[2],V[0])+P,0]),S.setRotationMode("xzy")):T===c?(S.r3(0,-W(V[2],V[0]),B(V[1]/g)),S.setRotationMode("zyx")):T===s?(S.r3(0,-W(V[2],V[0])+R,-B(V[1]/g)),S.setRotationMode("zyx")):T===y?(S.r3([-B(V[1]/g)+P,-W(V[2],V[0])+P,0]),S.setRotationMode("xzy")):T===a&&(S.r3([-B(V[1]/g)-P,-W(V[2],V[0])+P,0]),S.setRotationMode("xzy")),T===z&&(S.r3([-B(V[1]/g)+R,-W(V[2],V[0])+P,R]),S.setRotationMode("zxy"))},getLoopedEdges:function(){return this._loopedEdges},getEdges:function(){return this._edges},getAgentEdges:function(){return this._agentEdges},getHost:function(){return this._host},setHost:function(M){var x=this;if(x!==M&&x._host!==M){var j=x._host;j&&j._removeAttach(x),x._host=M,x._host&&x._host._addAttach(x),x.fp("host",j,M),x.onHostChanged(j,M)}},getAttaches:function(){return this._attaches},_addAttach:function(S){var $=this;$._attaches||($._attaches=new Me),$._attaches.add(S),$.fp("attaches",t,S)},_removeAttach:function(i){var b=this;b._attaches.remove(i),b._attaches.isEmpty()&&delete b._attaches,b.fp("attaches",i,t)},getSourceEdges:function(){return this._sourceEdges},getTargetEdges:function(){return this._targetEdges},_addSourceEdge:function(G){var K=this;K._allEdges||(K._allEdges=new Me),K._sourceEdges||(K._sourceEdges=new Me),K._allEdges.add(G),K._sourceEdges.add(G),K._resetEdgeSet()},_addTargetEdge:function(q){var $=this;$._allEdges||($._allEdges=new Me),$._targetEdges||($._targetEdges=new Me),$._allEdges.add(q),$._targetEdges.add(q),$._resetEdgeSet()},_removeSourceEdge:function(r){var A=this;A._allEdges.remove(r),A._sourceEdges.remove(r),A._allEdges.isEmpty()&&delete A._allEdges,A._sourceEdges.isEmpty()&&delete A._sourceEdges,A._resetEdgeSet()},_removeTargetEdge:function(b){var d=this;d._allEdges.remove(b),d._targetEdges.remove(b),d._allEdges.isEmpty()&&delete d._allEdges,d._targetEdges.isEmpty()&&delete d._targetEdges,d._resetEdgeSet()},_resetEdgeSet:function(){var s=this;if(delete s._loopedEdges,!s._allEdges||s._allEdges.isEmpty())return delete s._edges,void 0;var v;s._allEdges.each(function(T){T.isLooped()&&(v||(v={}),v[T._id]||(s._loopedEdges||(s._loopedEdges=new Me),s._loopedEdges.add(T),v[T._id]=T))}),v?(s._edges=new Me,s._allEdges.each(function(Z){v[Z._id]?"A"===v[Z._id]||(v[Z._id]="A",s._edges.add(Z)):s._edges.add(Z)})):s._edges=s._allEdges},hasAgentEdges:function(){return!!this._agentEdges&&!this._agentEdges.isEmpty()},getSourceAgentEdges:function(){return this._sourceAgentEdges},getTargetAgentEdges:function(){return this._targetAgentEdges},_addSourceAgentEdge:function(M){var O=this;O._sourceAgentEdges||(O._sourceAgentEdges=new Me),O._allAgentEdges||(O._allAgentEdges=new Me),O._sourceAgentEdges.add(M),O._allAgentEdges.add(M),O._resetAgentEdgeSet()},_addTargetAgentEdge:function(K){var z=this;z._targetAgentEdges||(z._targetAgentEdges=new Me),z._allAgentEdges||(z._allAgentEdges=new Me),z._targetAgentEdges.add(K),z._allAgentEdges.add(K),z._resetAgentEdgeSet()},_removeSourceAgentEdge:function(M){var B=this;B._sourceAgentEdges.remove(M),B._allAgentEdges.remove(M),B._sourceAgentEdges.isEmpty()&&delete B._sourceAgentEdges,B._allAgentEdges.isEmpty()&&delete B._allAgentEdges,B._resetAgentEdgeSet()},_removeTargetAgentEdge:function(Z){var l=this;l._targetAgentEdges.remove(Z),l._allAgentEdges.remove(Z),l._targetAgentEdges.isEmpty()&&delete l._targetAgentEdges,l._allAgentEdges.isEmpty()&&delete l._allAgentEdges,l._resetAgentEdgeSet()},_resetAgentEdgeSet:function(){var T=this;delete T._agentEdges;var N=T._allAgentEdges;if(N&&!N.isEmpty()){var f={};N.each(function(w){f[w._id]?T._agentEdges||(T._agentEdges=new Me):f[w._id]=w}),T._agentEdges?N.each(function(b){f[b._id]&&(T._agentEdges.add(b),delete f[b._id])}):T._agentEdges=N}},getImage:function(){return this._image},setImage:function(D){var z=this,C=z._image,K=z.getWidth(),U=z.getHeight();z._image=D,z.fp("image",C,D),z.fp(Zk,K,z.getWidth()),z.fp(ho,U,z.getHeight())},getElevation:function(){return this._elevation},setElevation:function(h){var M=this;if(!M._updatingElevation){M._updatingElevation=1;var K=M._elevation;M._elevation=h,M.fp(Pd,K,h),delete this._updatingElevation}},getRotation:function(){return this._rotation},setRotation:function(D){var Z=this;if(!Z._updatingRotation){Z._updatingRotation=1;var X=Z._rotation;Z._rotation=D,Z.fp(Ul,X,D),delete Z._updatingRotation}},getRotationX:function(){return this._rotationX},setRotationX:function(q){var k=this;if(!k._updatingRotationX){k._updatingRotationX=1;var D=k._rotationX;k._rotationX=q,k.fp("rotationX",D,q),delete k._updatingRotationX}},getRotationZ:function(){return this._rotationZ},setRotationZ:function(Q){var L=this;if(!L._updatingRotationZ){L._updatingRotationZ=1;var c=L._rotationZ;L._rotationZ=Q,L.fp("rotationZ",c,Q),delete L._updatingRotationZ}},getPosition:function(){return this._position},setPosition:function(o,$){var K=this;if(!K._updatingPosition){K._updatingPosition=1;var u;if(u=2===arguments.length?{x:o,y:$}:o,u.x!==K._position.x||u.y!==K._position.y){var L=K._position;K._position=u,K.fp(Ol,L,u)}delete K._updatingPosition}},translate:function(A,v){var N=this._position;this.p(N.x+A,N.y+v)},getWidth:function(){var P=this;if(P._width>=0)return P._width;var n=vn(P._image);return n?Do(n,P):20},setWidth:function(V){var T=this,I=T._width;T._width=V,T.fp(Zk,I,V)},getHeight:function(){var R=this;if(R._height>=0)return R._height;var j=vn(R._image);return j?xk(j,R):20},setHeight:function(n){var H=this,W=H._height;H._height=n,H.fp(ho,W,n)},setSize:function(w,U){var v=this;2===arguments.length?(v.setWidth(w),v.setHeight(U)):(v.setWidth(w.width),v.setHeight(w.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(z,N,W,d){var x=this;1===arguments.length?(x.p(z.x+z.width/2,z.y+z.height/2),x.setWidth(z.width),x.setHeight(z.height)):(x.p(z+W/2,N+d/2),x.setWidth(W),x.setHeight(d))},getRect:function(){var R=this,p=R.getWidth(),T=R.getHeight();return Mb({x:R._position.x-p/2,y:R._position.y-T/2,width:p,height:T},R._rotation)},getCorners:function(Y,N){Y==t&&(Y=0),N==t&&(N=Y);var J=this,U=J._position,O=J.getWidth()/2+Y,V=J.getHeight()/2+N,j=new dr(J._rotation,U.x,U.y);return[j.tf(-O,-V),j.tf(O,-V),j.tf(O,V),j.tf(-O,V)]},rotateAt:function(Q,I,G){var J=this,$=J._position,O=J._rotation,i=new dr(O,$.x,$.y).tf(Q,I),n=k(Q*Q+I*I),F=W($.y-i.y,$.x-i.x)+G;J.setRotation(O+G),J.p(i.x+n*_(F),i.y+n*E(F))},onParentChanged:function(){Bg.superClass.onParentChanged.apply(this,arguments),this._checkEdgeAgent()},_checkEdgeAgent:function(){this._edges&&this._edges.each(function(i){i._checkAgentNode()})},onPropertyChanged:function(t){var m=this;Bg.superClass.onPropertyChanged.call(m,t),m._attaches&&m._attaches.each(function(h){h.handleHostPropertyChange(t)}),m._agentEdges&&m._agentEdges.each(function(T){T.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function($){this.updateAttach($)},onStyleChanged:function(i){Bg.superClass.onStyleChanged.apply(this,arguments),dc[i]&&this.updateAttach()},updateAttach:function(s){var J=this;J._updatingAttach||jc||(J._updatingAttach=1,J.updateAttachImpl(s),delete J._updatingAttach)},updateAttachImpl:function(P){var Q,f,H,O,p,u,$=this,k=$._host,Y=P?P.property:t,c=P?P.oldValue:t,y=P?P.newValue:t;if(k instanceof sq){if(Y===Pd)$.setElevation($._elevation+y-c);else if(!P||Ic[Y]){if(Q=$.s("attach.row.index"),f=$.s("attach.column.index"),H=k.getCellRect(Q,f),!H)return;O=$.s("attach.row.span"),p=$.s("attach.column.span"),(1!==O||1!==p)&&(H=co(H,k.getCellRect(Q+O-1,f+p-1))),ne(H,$,"attach.padding",1),$.setRect(H)}}else if(k instanceof wg&&(u=$.s("attach.index"))>=0&&(!P||Eh[Y])){var C=$.s("attach.thickness");C!=t&&$.setHeight(k.getThickness()*C);var X=$.s("attach.offset"),J=k.getPoints(),g=J.size();if(g>u){var E=J.get(u),d=g===u+1?J.get(0):J.get(u+1),e=[d.x-E.x,d.y-E.y],R=Uk(e);if(R){$.s("attach.offset.relative")&&(X*=R),$.s("attach.offset.opposite")&&(X=R-X);var h={x:E.x+e[0]/R*X,y:E.y+e[1]/R*X},B=$.s("attach.gap");B&&($.s("attach.gap.relative")&&(B*=k.getThickness()),h=Hd(t,h,d,B)),$.p(h),$.setRotation(W(e[1],e[0]))}}}else P&&(Y===Ol?$.translate(y.x-c.x,y.y-c.y):Y===Pd?$.setElevation($._elevation+y-c):Pb[Y]&&$.syncRotation(k,Y,y-c))},syncRotation:function(S,B,i){var s=this,k=S.p3(),F=id(s.p3(),k),a=jl(),O=Zg[s.getRotationMode()],n=O[0],T=O[1],u=O[2],q=Zq[n],W=Zq[T],m=Zq[u];B===Ul&&(B="rotationY",i=-i),B===Ul+n?(m(a,S[mk+u]()),W(a,S[mk+T]()),q(a,i),W(a,-S[mk+T]()),m(a,-S[mk+u]()),s[jr+n](s[mk+n]()+i)):B===Ul+T?(m(a,S[mk+u]()),W(a,i),m(a,-S[mk+u]()),s[jr+T](s[mk+T]()+i)):B===Ul+u&&(m(a,i),s[jr+u](s[mk+u]()+i)),Ko(F,a),s.p3(k[0]+F[0],k[1]+F[1],k[2]+F[2])},isHostOn:function(e){var y=this;if(y._host&&e&&e._attaches)for(var X={},J=y._host;J&&J!==y&&!X[J._id];){if(J===e)return!0;X[J._id]=J,J=J._host}return!1},isLoopedHostOn:function(o){return this.isHostOn(o)&&o.isHostOn(this)},getSerializableProperties:function(){var q=Bg.superClass.getSerializableProperties.call(this);return op(q,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,width:1,height:1,tall:1,elevation:1}),q}});var Ci=p.Edge=function(A,d){var l=this;Ag(Ci,l),l.setSource(A),l.setTarget(d)};Qr("Edge",pc,{_icon:"edge_icon",getUIClass:function(){return qd},get3dUIClass:function(){return Nl},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._sourceAgent},getTargetAgent:function(){return this._targetAgent},setSource:function(O){var G=this;if(G._source!==O){var d=G._source;G._source=O,d&&d._removeSourceEdge(G),O&&O._addSourceEdge(G),G._checkAgentNode(),G.fp("source",d,O)}},setTarget:function(D){var F=this;if(F._target!==D){var g=F._target;F._target=D,g&&g._removeTargetEdge(F),D&&D._addTargetEdge(F),F._checkAgentNode(),F.fp("target",g,D)}},isLooped:function(){var r=this;return r._source===r._target&&!!r._source&&!!r._target},_checkAgentNode:function(){var W,A=this,$=Lc(A);A._sourceAgent!==$&&(W=this._sourceAgent,W&&W._removeSourceAgentEdge(A),A._sourceAgent=$,$&&$._addSourceAgentEdge(A),A.fp("sourceAgent",W,$),Xi(W,A._targetAgent),Xi($,A._targetAgent));var S=Oo(A);A._targetAgent!==S&&(W=A._targetAgent,W&&W._removeTargetAgentEdge(A),A._targetAgent=S,S&&S._addTargetAgentEdge(A),A.fp("targetAgent",W,S),Xi(W,A._sourceAgent),Xi(S,A._sourceAgent))},_setEdgeGroup:function(p){this._edgeGroup=p,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._edgeGroup},isEdgeGroupHidden:function(){var t=this;return t._edgeGroup&&t._edgeGroup.get(0)!==t&&!t.getStyle(Po)},getEdgeGroupSize:function(){return this._edgeGroup?this._edgeGroup.size():1},getEdgeGroupIndex:function(){return this._edgeGroup?this._edgeGroup.indexOf(this):0},isEdgeGroupAgent:function(){var o=this,H=o._edgeGroup;return H&&!o.getStyle(Po)&&H.size()>1&&o===H.get(0)},toggle:function(){var f=this._edgeGroup,R=!this.s(Po);f&&f.size()>1&&(f.each(function(s){s.s(Po,R)}),f.getSiblings().each(function(m){m!==f&&m.each(function(j){j.fp("edgeGroup",t,m)})}))},setStyle:function(S,X){(S===wq||"edge.segments"===S)&&(X=Ge(X)),Ci.superClass.setStyle.call(this,S,X)},onStyleChanged:function(w){Ci.superClass.onStyleChanged.apply(this,arguments),Od[w]&&Xi(this._targetAgent,this._sourceAgent)},getSerializableProperties:function(){var I=Ci.superClass.getSerializableProperties.call(this);return op(I,{source:1,target:1}),I}});var Oh=p.Group=function(){Ag(Oh,this)};Qr("Group",Bg,{_image:"group_image",_icon:"group_icon",_expanded:!1,getUIClass:function(){return ib},onChildAdded:function(){Oh.superClass.onChildAdded.apply(this,arguments),this.updatePositionFromChildren()},onChildRemoved:function(){Oh.superClass.onChildRemoved.apply(this,arguments),this.updatePositionFromChildren()},updatePositionFromChildren:function(){var l=this;if(!l._updatingChildrenPosition&&!jc){var t=l.getChildrenRect();t&&(l._updatingPositionFromChildren=1,l.p(kl(l.s("group.position"),t,l.getSize())),delete l._updatingPositionFromChildren)}},getChildrenRect:function(){var a,p=this;return p.eachChild(function(g){a=co(a,p.getChildRect(g))}),a},getChildRect:function(h){var H;return im(h)&&h.s(mi)&&(bg(h)&&h.isExpanded()&&h.eachChild(function(r){H=co(H,h.getChildRect(r))}),!H&&h.getRect&&(H=h.getRect())),H},setPosition:function(v,i){var S=this;if(!S._updatingChildrenPosition){var B;B=2===arguments.length?{x:v,y:i}:v,jc||S._updatingPositionFromChildren||(S._updatingChildrenPosition=1,qo(S._children,B.x-S._position.x,B.y-S._position.y),delete S._updatingChildrenPosition),Oh.superClass.setPosition.call(this,B)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._expanded},setExpanded:function(b){var c=this;if(c._expanded!==b){var C=c._expanded;c._expanded=b,c.fp("expanded",C,c._expanded),c._checkEdgeAgent()}},_checkEdgeAgent:function(){Oh.superClass._checkEdgeAgent.call(this),this.eachChild(function(l){im(l)&&l._checkEdgeAgent()})},onStyleChanged:function(P){Oh.superClass.onStyleChanged.apply(this,arguments),"group.position"===P&&this.updatePositionFromChildren()},getSerializableProperties:function(){var a=Oh.superClass.getSerializableProperties.call(this);return a.expanded=1,a}});var sq=p.Grid=function(){Ag(sq,this)};Qr("Grid",Bg,{IRotatable:!1,_icon:"grid_icon",_image:t,getUIClass:function(){return Sm},setRotation:function(){},getCellRect:function(H,F){var s=this,h=s.s("grid.row.count"),c=s.s("grid.column.count");if(0>=h||0>=c||0>H||H>=h||0>F||F>=c)return t;var K,U,B,$=s.getRect(),i=s.s("grid.row.percents"),l=s.s("grid.column.percents");if(ne($,s,"grid.border",-1),i&&i._as&&(i=i._as),l&&l._as&&(l=l._as),i&&i.length===h){for(B=0,K=0;H>K;K++)B+=$.height*i[K];$.y+=B,$.height=$.height*i[H]}else $.height=$.height/h,$.y+=$.height*H;if(l&&l.length===c){for(U=0,K=0;F>K;K++)U+=$.width*l[K];$.x+=U,$.width=$.width*l[F]}else $.width=$.width/c,$.x+=$.width*F;return Am($,-s.s("grid.gap")),$}});var wg=p.Shape=function(){Ag(wg,this),this._points=new Me};Qr("Shape",Bg,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Eo},get3dUIClass:function(){return Yb},getLength:function(z){return yf(mo(this._points,this._segments,z,this._closePath))},getSegments:function(){return this._segments},toSegments:function(){var u=this._segments;return u?new Me(u._as.slice(0)):u},setSegments:function(b){var X=this._segments;b=b?fd(b)?new Me(b.slice(0)):new Me(b._as.slice(0)):new Me,(X&&b&&X._as.join(",")!==b._as.join(",")||X!==b)&&(this._segments=b,this.fp("segments",X,b))},getPoints:function(){return this._points},toPoints:function(){var Y=this._points;return new Me(Y._as.slice(0))},setPoints:function(M){var F=this._points;M=M?fd(M)?new Me(M.slice(0)):new Me(M._as.slice(0)):new Me,(F&&M&&F._as.join(",")!==M._as.join(",")||F!==M)&&(this._points=M,this.fs(),this.fp("points",F,M))},addPoint:function(q,j){var g=this.toPoints();g.add(q,j),this.setPoints(g)},setPoint:function(R,n){var E=this.toPoints();E.set(R,n),this.setPoints(E)},removePointAt:function(w){var t=this.toPoints();t.removeAt(w),this.setPoints(t)},setWidth:function(z){var d=this;if(1>z&&(z=1),!d._updatingShape&&!jc&&d.getWidth()){d._updatingShape=1;var M=d._position.x,k=z/d.getWidth(),H=d.toPoints(),a=new Me;H.each(function(p){a.add({x:(p.x-M)*k+M,y:p.y,e:p.e})}),d.setPoints(a),d.fs(),delete d._updatingShape}wg.superClass.setWidth.call(d,z)},setHeight:function(k){var z=this;if(1>k&&(k=1),!z._updatingShape&&!jc&&z.getHeight()){z._updatingShape=1;var r=z._position.y,W=k/z.getHeight(),Y=z.toPoints(),R=new Me;Y.each(function(s){R.add({x:s.x,y:(s.y-r)*W+r,e:s.e})}),z.setPoints(R),z.fs(),delete z._updatingShape}wg.superClass.setHeight.call(z,k)},setPosition:function(Z,H){var b,W=this;if(!W._updatingShapePosition){if(W._updatingShapePosition=1,!W._updatingShape&&!jc){b=2===arguments.length?{x:Z,y:H}:Z;var _=b.x-W._position.x,M=b.y-W._position.y;if(0===_&&0===M)return delete W._updatingShapePosition,void 0;W._updatingShape=1;var f=W.toPoints(),s=new Me;f.each(function(q){s.add({x:q.x+_,y:q.y+M,e:q.e})}),W.setPoints(s),W.fs(),delete W._updatingShape}wg.superClass.setPosition.apply(W,arguments),delete W._updatingShapePosition}},fs:function(){this.fireShapeChange()},fireShapeChange:function(){var V=this;if(!V._updatingShape&&!jc){var J=Hi(V._points);J&&(V._updatingShape=1,V.setRect(J),delete V._updatingShape)}V.fp(zq,!1,!0)},getSerializableProperties:function(){var t=wg.superClass.getSerializableProperties.call(this);return t.segments=1,t.points=1,t.thickness=1,t.closePath=1,t}});var vf=p.Polyline=function(){Ag(vf,this),this.s({"shape.background":null,"shape.border.width":2})};Qr("Polyline",wg,{IRotatable:!1,_icon:"polyline_icon",get3dUIClass:function(){return vo},getUIClass:function(){return Fc},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setClosePath:function(){},setTall:function(q){var k=this;if(!k._updatingPolyline&&!jc&&k.getTall()){k._updatingPolyline=1;var Q=k._elevation,A=q/k.getTall();k._points.each(function(u){u.e=u.e==t?Q:(u.e-Q)*A+Q}),k.fs(),delete k._updatingPolyline}vf.superClass.setTall.call(k,q)},setElevation:function(H){var S=this;if(!S._updatingPolyline&&!jc){S._updatingPolyline=1;var e=H-S._elevation;S._points.each(function(Y){Y.e==t?Y.e=H:Y.e+=e}),S.fs(),delete S._updatingPolyline}vf.superClass.setElevation.apply(S,arguments)},fireShapeChange:function(){var N=this,U=N._points;if(!N._updatingPolyline&&!jc){var J=U.size();if(J){var l=1,s=U.get(0),I=N._elevation;s.e==t&&(s.e=I);for(var $=s.e,R=0;J>l;l++){s=U.get(l),s.e==t&&(s.e=I);var B=d($,s.e),Y=n($+R,s.e);$=B,R=Y-B}N._updatingPolyline=1,N.setTall(R),N.setElevation($+R/2),delete N._updatingPolyline}}vf.superClass.fireShapeChange.apply(N,arguments)}});var Db=p.SubGraph=function(){Ag(Db,this)};Qr("SubGraph",Bg,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_checkEdgeAgent:function(){Db.superClass._checkEdgeAgent.call(this),this.eachChild(function(B){im(B)&&B._checkEdgeAgent()})}}),p.EdgeGroup=function(O,y){this._edges=O,this._siblings=y;for(var i,e,Y=0,Q=O.size(),f=L[Po];Q>Y;Y++)if(i=O.get(Y).getStyle(Po,!1),i!=t){f=i;break}f==t&&(f=!0);var Z=b.edgeGroupAgentFunc;for(Z&&(e=Z(O),e&&e!==O.get(0)&&(O.remove(e),O.add(e,0))),Y=0;Q>Y;Y++)O.get(Y).s(Po,f)},Qr("EdgeGroup",X,{getEdges:function(){return this._edges},size:function(){return this._edges.size()},get:function(m){return this._edges.get(m)},indexOf:function(G){return this._edges.indexOf(G)},each:function(I,n){this._edges.each(I,n)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(W,q){this._siblings.each(function(Z){Z._edges.each(W,q)})}});var nr=p.JSONSerializer=function($){this.dm=this._dataModel=$};Qr("JSONSerializer",X,{serialize:function(x){return JSON.stringify(this.toJSON(),function(d,K){return Ud(K)?xd(K):K},x==t?2:x)},toJSON:function(){var A=this,t=A.dm,g=A.json={v:b.getVersion(),d:[],a:{}},I=t.getSerializableAttrs();for(var l in I){var i=t.a(l);i!==Z&&A[bc](l,i,g.a)}return bo(g.a)&&delete g.a,t.each(function(h){A.serializeData(h)}),g},isSerializable:function(){return!0},getProperties:function(C){return C.getSerializableProperties()},getStyles:function(H){return H.getSerializableStyles()},getAttrs:function(h){return h.getSerializableAttrs()},serializeData:function(E){var Q=this;if(Q.isSerializable(E)){var d,D,T,G,C=E.getClass(),K=new C,h={c:E.getClassName(),i:E.getId(),p:{},s:{},a:{}};Q.json.d.push(h),d=Q.getProperties(E);for(D in d)G=sk(D),E[G]&&(T=E[G](),T!==K[G]()&&Q[bc](D,T,h.p));d=Q.getStyles(E);for(D in d)T=E.s(D),T!==K.s(D)&&Q[bc](D,T,h.s);d=Q.getAttrs(E);for(D in d)T=E.a(D),T!==K.a(D)&&Q[bc](D,T,h.a);bo(h.p)&&delete h.p,bo(h.s)&&delete h.s,bo(h.a)&&delete h.a}},serializeValue:function(K,H,h){Go(H)?H={__a:H._as}:H instanceof pc&&(H={__i:H.getId()}),h[K]=H},deserialize:function(q,I,z){jc=!0;var L=this;q=L.json=ii(q)?JSON.parse(q):q,L.idMap={};for(var B=L.dm,p=new Me,M=new Me,Q=0,A=q.d.length;A>Q;Q++){var k=q.d[Q],$=Pe(k.c),E=new $,c=k.i;z&&c!=t&&(E._id=c),L.idMap[c]=E,p.add(E),M.add(k)}for(Q=0;A>Q;Q++)L.deserializeData(p.get(Q),M.get(Q));p.each(function(T){I&&!T.getParent()&&T.setParent(I),B.add(T)});for(var s in q.a)B.a(s,L[hm](q.a[s]));return jc=!1,p},deserializeData:function(g,S){for(var F in S.p)g[Xr(F)](this[hm](S.p[F]));for(F in S.s)g.s(F,this[hm](S.s[F]));for(F in S.a)g.a(F,this[hm](S.a[F]))},deserializeValue:function(a){if(me(a)){var P=a.__i;if(P!=t)return this.idMap[P];if(P=a.__a,fd(P))return new Me(P)}return a}}),op(fq,{serialize:function(h){return new nr(this).serialize(h)},toJSON:function(){return new nr(this).toJSON()},deserialize:function(y,L,d){return new nr(this).deserialize(y,L,d)}}),od.GraphView=function(z){var g=this;g._dirtyMap={},g._dirtyRects=new Me,g._uiMap={},g._visibleMap={},g._view=gc(1),g._canvas=Rd(g._view),g.dm(z?z:new fq),g.setEditable(!1),g.setScrollBarVisible(b.graphViewScrollBarVisible)},th("GraphView",X,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_zoom:1,ms_interaction:1,ms_ac:["layers",Bd,Xl,Hh,jq,"resettable","editInteractor",Di,"pannable","rectSelectable","autoScrollZone",np,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground"],_resettable:b.graphViewResettable,_pannable:b.graphViewPannable,_rectSelectable:b.graphViewRectSelectable,_autoScrollZone:b.graphViewAutoScrollZone,_rectSelectBackground:b.graphViewRectSelectBackground,_rectSelectBorderColor:b.graphViewRectSelectBorderColor,_editPointSize:b.graphViewEditPointSize,_editPointBorderColor:b.graphViewEditPointBorderColor,_editPointBackground:b.graphViewEditPointBackground,_scrollBarColor:$q,_scrollBarSize:uo,_autoHideScrollBar:ce,_autoMakeVisible:ug,setEditable:function(A){var O=this,J=od.XEditInteractor;A?O.setInteractors([new xc(O),J?new J(O):new Ze(O),new se(O),new vi(O),new il(O,{editable:!J})]):O.setInteractors([new xc(O),new se(O),new vi(O),new il(O,{editable:!1})])},getCanvas:function(){return this._canvas},createDataUI:function(j){var r=j.getUIClass();return r?new r(this,j):t},getDataUI:function(y){var B=this,W=B._uiMap[y._id];
return W===Z&&(W=B.createDataUI(y),B._uiMap[y._id]=W),W},invalidateAll:function(R){var t=this;if(R){for(var H in t._uiMap){var N=t._uiMap[H];N&&N.dispose()}t._uiMap={},t._visibleMap={},t._dirtyMap={},t._dirtyRects.clear(),t.redraw()}else t.dm().each(function(_){t.invalidateData(_)})},invalidateSelection:function(){var r=this;r.sm().each(function(E){r.invalidateData(E)})},invalidateData:function(c){var Y=this;Y._dirtyMap[c._id]=c,Y.invalidateRelativeDatas(c),Y.iv()},invalidateRelativeDatas:function(M){var X=this,u=X._dirtyMap;if(Oq(M)&&Jp[M.s(Jl)]){var w=M.getSourceAgent();w&&w.getAgentEdges().each(function(p){u[p._id]=p}),w=M.getTargetAgent(),w&&w.getAgentEdges().each(function(d){u[d._id]=d}),X.iv()}},redraw:function(O){var t=this;t._redrawAll||(O?t._dirtyRects.add(O):(t._redrawAll=1,t._dirtyRects.clear()),t.iv())},each:function(f,e){var T,x,m,H=0,O=this._layers,a=this._dataModel._datas._as,y=a.length;if(O)for(var U=O.length;U>H;H++){m=O[H];for(var Y=0;y>Y;Y++)if(T=a[Y],T._layer===m&&(x=e?f.call(e,T):f(T),x===!1))return}else for(;y>H;H++)if(T=a[H],x=e?f.call(e,T):f(T),x===!1)return},reverseEach:function(H,$){var d,C,N,q,e=this._layers,X=this._dataModel._datas._as,D=X.length;if(e)for(d=e.length-1;d>=0;d--){q=e[d];for(var s=D-1;s>=0;s--)if(C=X[s],C._layer===q&&(N=$?H.call($,C):H(C),N===!1))return}else for(d=D-1;d>=0;d--)if(C=X[d],N=$?H.call($,C):H(C),N===!1)return},getViewRect:function(){return this._viewRect},getContentRect:function(){var R=this,j=R._contentRect;return j||(R.each(function(b){R.isVisible(b)&&(j=co(j,R.getDataUIBounds(b)))}),R._contentRect=j?j:sl),R._contentRect},getScrollRect:function(){return co(this.getContentRect(),this._viewRect)},fitData:function(J,h,z,_,H){var D=this;if(!D.getWidth()||!D.getHeight())return H||td(D.fitData,D,[J,h,z,_,!0],200),void 0;D.makeVisible(J),D.validate();var O=D.getDataUIBounds(J);O&&(O=Nc(O),Am(O,z==t?20:z),D.fitRect(O,h,_))},fitContent:function(U,A,o,M){var j=this;if(!j.getWidth()||!j.getHeight())return M||td(j.fitContent,j,[U,A,o,!0],200),void 0;j.validate();var S=Nc(j.getContentRect());Am(S,A==t?20:A),j.fitRect(S,U,o)},fitRect:function(n,Y,q){var B=this,s=B.getWidth(),x=B.getHeight(),U=n.x+n.width/2,u=n.y+n.height/2,O=d(s/n.width,x/n.height),g=B._zoom,J=-U*g+s/2,R=-u*g+x/2;0===O||isNaN(O)||(q&&(O=d(1,O)),Y?B.setTranslate(J,R,{finishFunc:function(){B.setZoom(O,Y)}}):(B.setTranslate(J,R),B.setZoom(O)))},toCanvas:function(J){this.validateImpl();var P=this,w=P.getContentRect(),A=Rd(),$=P._zoom,p=w.x*$,I=w.y*$,Y=w.width*$,H=w.height*$;eh(A,Y,H,1);var E=Yc(A);return J&&hc(E,0,0,Y,H,J),Ap(E,-p,-I),E.scale($,$),P.draw(E),E.restore(),A},toDataURL:function(d,A){return this.toCanvas(d).toDataURL(A||"image/png",1)},getClipBounds:function(){return this._clipBounds},draw:function(O,S){var A,u,t=this;t.drawBottomPainters(O,S),t.each(function(H){t._visibleMap[H._id]&&(A=t.getDataUI(H),A&&(u=A.getBounds(),(!S||ch(S,u))&&A.draw(O)))}),t.drawTopPainters(O,S)},validateImpl:function(){var j,$,r,Z,p,l=this,f=l.tx(),M=l.ty(),h=l._zoom,I=l._canvas,T=this.getWidth(),i=this.getHeight(),v=l._viewRect,e={x:-f/h,y:-M/h,width:T/h,height:i/h},m={},Y=l._dirtyRects,L=l._dirtyMap,N=l._redrawAll,_=l._makeVisibleData;(T!==I.clientWidth||i!==I.clientHeight)&&(eh(I,T,i),N=1),N||lf(e,v)||(N=1),l._viewRect=e,l.each(function(j){$=j._id;var X=m[$]=l.isVisible(j);X!==l._visibleMap[$]&&(L[$]=j,r=l.getDataUI(L[$]),r&&r.onVisibleChanged(X),l.onVisibleChanged(j,X))},l);for($ in L)r=l.getDataUI(L[$]),r&&(!N&&l._visibleMap[$]&&(p=r.getBounds(),p&&Y.add(p)),r.invalidate()),l._invalidateContentRect=1;if(l._visibleMap=m,!N)for($ in L)m[$]&&(r=l.getDataUI(L[$]),r&&(p=r.getBounds(),p&&Y.add(p)));if(N?Z=e:(Y.each(function(t){ch(e,t)&&(Z=co(Z,t))}),Z&&(Am(Z,n(1,1/h)),Z.x=D(Z.x*h)/h,Z.y=D(Z.y*h)/h,Z.width=Q(Z.width*h)/h,Z.height=Q(Z.height*h)/h,Z=Bo(e,Z))),l._clipBounds=Z,Z&&(j=Yc(I),kk(j,f,M,h),j.beginPath(),j.rect(Z.x,Z.y,Z.width,Z.height),j.clip(),j.clearRect(Z.x,Z.y,Z.width,Z.height),l.draw(j,Z),j.restore(),delete l._clipBounds),l._dirtyMap={},Y.clear(),delete l._redrawAll,_&&T>0&&i>0){var r=l.getDataUI(_);if(r){var p=r.getBounds(),R=l._viewRect,u=R.x,S=R.y,d=R.width,E=R.height,h=l._zoom;p&&!ch(p,R)&&(p.x+p.width<u&&l.tx(-p.x*h),p.x>u+d&&l.tx(-(p.x+p.width-d)*h),p.y+p.height<S&&l.ty(-p.y*h),p.y>S+E&&l.ty(-(p.y+p.height-E)*h))}delete l._makeVisibleData}l._invalidateContentRect&&(delete l._invalidateContentRect,delete l._contentRect),l.updateScrollBar()},isScrollBarVisible:function(){return!!this._scrollBarDiv},setScrollBarVisible:function(Y){var v=this;Y!==v.isScrollBarVisible()&&(Y?(Zc(v._view,v._scrollBarDiv=gc()),Zc(v._scrollBarDiv,v._vBar=gc()),Zc(v._scrollBarDiv,v._hBar=gc())):(gi(v._scrollBarDiv),delete v._scrollBarDiv,delete v._vBar,delete v._hBar),v.fp("scrollBarVisible",!Y,Y))},showScrollBar:function(){var u=this;u._scrollBarDiv&&(u._scrollTimer||(N(function(){u.handleScrollTimeout()},on),u.iv()),u._scrollTimer=new Date)},handleScrollTimeout:function(){var D=this;if(D._scrollTimer){var r=new Date,Z=r.getTime();Z-D._scrollTimer.getTime()>=on?(delete D._scrollTimer,D.iv()):N(function(){D.handleScrollTimeout()},on)}},updateScrollBar:function(){var u=this,d=this._vBar,C=this._hBar;if(u._scrollBarDiv){if(u._autoHideScrollBar&&!u._scrollTimer)return d.style.visibility=Pp,C.style.visibility=Pp,void 0;var z=u.getScrollBarColor(),y=u._zoom,p=u.getScrollBarSize(),f=u.getViewRect(),I=u.getScrollRect(),r=f.height*y,w=I.height*y,N=f.width*y-p-2,V=r*((f.y-I.y)*y/w),$=r*(r/w),o=d.style;w-.5>r?(rc>$&&(V=V+$/2-rc/2,0>V&&(V=0),V+rc>r&&(V=r-rc),$=rc),fg(d,N,V,p,$),o.visibility=tb,o.background=z,o.borderRadius=p/2+Ur):o.visibility=Pp;var F=f.width*y,S=I.width*y,V=f.height*y-p-2,N=F*((f.x-I.x)*y/S),T=F*(F/S),o=C.style;S-.5>F?(rc>T&&(N=N+T/2-rc/2,0>N&&(N=0),N+rc>F&&(N=F-rc),T=rc),fg(C,N,V,T,p),o.visibility=tb,o.background=z,o.borderRadius=p/2+Ur):o.visibility=Pp}},setDataModel:function(o){var W=this,Z=W._dataModel,U=W._selectionModel;Z!==o&&(Z&&(Z.umm(W.handleDataModelChange,W),Z.umd(W.handleDataPropertyChange,W),Z.removeIndexChangeListener(W.handleIndexChange,W),U||Z.sm().ums(W.handleSelectionChange,W)),W._dataModel=o,o.mm(W.handleDataModelChange,W),o.md(W.handleDataPropertyChange,W),o.addIndexChangeListener(W.handleIndexChange,W),U?U._setDataModel(o):o.sm().ms(W.handleSelectionChange,W),W.invalidateAll(!0),W.fp(Cr,Z,o))},handleDataPropertyChange:function(u){this.invalidateData(u.data)},onPropertyChanged:function(v){var _=this,Y=v.property;_.redraw(),Lf[Y]?_.showScrollBar():Y===Di&&_.onCurrentSubGraphChanged(v)},onCurrentSubGraphChanged:function(){this.reset()},handleDataModelChange:function(T){var W=this,w=T.kind,G=T.data;if(W._invalidateContentRect=1,"add"===w)W.invalidateData(G),Oq(G)&&G.getEdgeGroup()&&G.getEdgeGroup().eachSiblingEdge(W.invalidateData,W);else if(w===Ve){W.invalidateRelativeDatas(G);var X=G._id,C=W._uiMap[X];if(C){if(W._visibleMap[X]){var q=C.getBounds();q&&W.redraw(q)}C.dispose(),delete W._uiMap[X],delete W._dirtyMap[X],delete W._visibleMap[X]}G===W._currentSubGraph&&W.setCurrentSubGraph(t)}else w===Yn&&(W.invalidateAll(!0),W.setCurrentSubGraph(t))},handleIndexChange:function(j){this.invalidateData(j.data)},adjustIndex:function(Y){var T=this;if(T.isVisible(Y)){for(var B=Y;B._parent&&T.isVisible(B._parent);)B=B._parent;B&&B!==Y&&T._dataModel.adjustIndex(B),T._dataModel.adjustIndex(Y)}},isMovable:function(q){var a=this;return Oq(q)&&q.getStyle(Jl)!==io?!1:q.s("2d.movable")?a._movableFunc?a._movableFunc(q):!0:!1},isSelectable:function(x){return x.s("2d.selectable")&&this.sm().isSelectable(x)},isEditable:function(u){var Y=this;if(!Y._editInteractor||!Y.isSelected(u))return!1;if(bg(u)){var r=Y.getDataUI(u);if(!r||r._groupInfo)return!1}return Oq(u)&&u.getStyle(Jl)!==io?!1:u.s("2d.editable")?Y._editableFunc?Y._editableFunc(u):!0:!1},handleDelete:function(){this._editInteractor&&this.removeSelection()},isPointEditable:function(O){return im(O)&&0!==O.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(O):!0},isRectEditable:function(H){return im(H)&&0!==H.getRotation()?!1:this._rectEditableFunc?this._rectEditableFunc(H):!0},isRotationEditable:function(U){return U.setRotation&&U.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(U):!0:!1},getRotationPoint:function(a){var i=ej(a.getRotation(),0,-a.getHeight()/2-(F?32:16)),O=a.p();return i.x+=O.x,i.y+=O.y,i},getLogicalPoint:function(o){var $=this;return yo(o,$._view,$.tx(),$.ty(),$._zoom,$._zoom)},getSelectedDataAt:function(p){var C=this;return this.getDataAt(p,function(w){return C.isSelected(w)})},getDataAt:function(b,q,g){b.target&&(b=this.lp(b));var i;return this.reverseEach(function(p){if(q?q(p):this.isSelectable(p)){if(this.rectIntersects(p,bk(b.x,b.y,g)))return i=p,!1}else;},this),i},getIconInfoAt:function(T,p){var J=this;if(T.target&&(T=J.lp(T)),p||(p=J.getDataAt(T)),p){var S=J.getDataUI(p);if(S&&S.iconsInfo){var x,i=S.iconsInfo,o=new Me;for(x in i.icons)o.add(x);for(var e=o.size()-1;e>=0;e--){x=o.get(e);for(var s=i.rects[x],b=s.rotation,Z=s.length-1;Z>=0;Z--){var V=s[Z],L=V.width,y=V.height,X={x:T.x-V.x-L/2,y:T.y-V.y-y/2};b!=t&&(X=ej(-b,X.x,X.y));var V={x:-L/2,y:-y/2,width:L,height:y};if(qn(V,X))return{key:x,index:Z,name:i.icons[x].names[Z],rect:s[Z],point:T,rotation:b,relativeRect:V,relativePoint:X,data:p}}}}}return t},getDatasInRect:function(s,V,G){G===Z&&(G=1);var e=this,_=new Me;return e.reverseEach(function(P){G&&!e.isSelectable(P)||(V?e.rectIntersects(P,s):e.rectContains(P,s))&&_.add(P)}),_},moveSelection:function(B,u){var i,x=this,T=x.dm();T&&(i=T.getHistoryManager()),i&&i.beginInteraction(),qo(x.sm().toSelection(x.isMovable,x),B,u),i&&i.endInteraction()},getDataUIBounds:function(i){var O=this.getDataUI(i);return O?O.getBounds():t},getBoundsForGroup:function(M){return M.s(mi)?this.getDataUIBounds(M):t},rectIntersects:function(G,S){this.validate();var m=t;if(this._visibleMap[G._id]){var W=this._uiMap[G._id];if(W){var K=W.getBounds();if(dn(S,K))m=!0;else if((S=Bo(S,K))&&(W.rectIntersects&&(m=W.rectIntersects(S)),m==t)){var l=S.x,V=S.y,g=S.width,Y=S.height,c=1,M=b.hitMaxArea,I=g*Y;I>M&&(c=M/I);var y=bb(g*c,Y*c);Ap(y,-l*c,-V*c),y.scale(c,c),W.draw(y);try{for(var B=0,o=y.getImageData(0,0,g*c,Y*c).data;B<o.length;B+=4)if(0!==o[B+3]){m=!0;break}y.restore()}catch(H){vb=t,m=!0}}}}return m?!0:!1},rectContains:function(K,V){if(this._visibleMap[K._id]){var m=this._uiMap[K._id];if(m)return dn(V,m.getBounds())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(X){var I=this,M=I._focusData,h=M&&I._uiMap[M._id],q=0,D=I._dataModel._datas;M&&M._enabled&&M._editable&&h&&h.onKeyDown&&h.onKeyDown(X)===!0||(9===X.keyCode&&(M&&(q=D.indexOf(M),Vm(X)?-1===--q&&(q=0):++q===D.size()&&(q=0)),I._focusData=M=D.get(q),I.sm().setSelection(M)),Jn(X)?I.selectAll():wo(X)&&I.isResettable()&&I.reset(),I.sm().isEmpty()||(mg(X)&&I.handleDelete(X),_c(X)&&(I.moveSelection(-1,0),I.fi({kind:"moveLeft"})),aj(X)&&(I.moveSelection(0,-1),I.fi({kind:"moveUp"})),Qj(X)&&(I.moveSelection(1,0),I.fi({kind:"moveRight"})),Nj(X)&&(I.moveSelection(0,1),I.fi({kind:"moveDown"}))))},handleScroll:function(x,c){Vk(x);var z=this.lp(x);c>0?this.scrollZoomIn(z):0>c&&this.scrollZoomOut(z)},handlePinch:function(y,x,r){x>r?this.pinchZoomIn(y):this.pinchZoomOut(y)},checkDoubleClickOnNote:function(J,j){var I=this,N=I.lp(J),g=I.getDataUI(j),d=g.note2Info;return d&&j.s("note2.toggleable")&&qn(d.clickRect,N)?(j.s(Kf,!j.s(Kf)),I.fi({kind:"toggleNote2",event:J,data:j}),!0):(d=g.noteInfo,d&&j.s("note.toggleable")&&qn(d.clickRect,N)?(j.s(rs,!j.s(rs)),I.fi({kind:"toggleNote",event:J,data:j}),!0):!1)},onVisibleChanged:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isSelectVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(o,V){var f=this,Q=f.getAutoScrollZone(),X=Q/f.getZoom(),u=Q/4,O=f._viewRect,W=f.lp(o),j={x:f.tx(),y:f.ty()};return W&&Q>0&&O&&(W.x-O.x<X?f.translate(u,0):O.x+O.width-W.x<X&&f.translate(-u,0),W.y-O.y<X?f.translate(0,u):O.y+O.height-W.y<X&&f.translate(0,-u)),j.x=f.tx()-j.x,j.y=f.ty()-j.y,V&&(V.x+=j.x,V.y+=j.y),j},getMoveMode:function(e,r){var n=r.s("2d.move.mode");return n?n:Oj["88"]?"x":Oj["89"]?"y":"xy"}});var gj=function(K,R){var g=this;g.gv=K,g.s=function(c){return R.getStyle(c)},g._data=R,g._rects=new Me};Ib(gj,X,{_bounds:t,ms_icons:1,onVisibleChanged:function(){},dispose:function(){},getSelectWidth:function(){var L=this,e=L.gv,M=L._data;return e.isSelectVisible(M)&&e.isSelected(M)?L.s("select.width"):0},getBodyColor:function(x){var o=this._data,$=this.gv.getBodyColor(o);return $?$:x?o.getStyle(x):t},getDashOffset:function(n){return this.s(n)},drawDash:function(E,k,v,N){var e=this.s,C=e(k+".dash.color");E.strokeStyle=C,E.lineWidth=v,E.stroke(),e(k+".dash.3d")&&bi(E,C,e(k+".dash.3d.color"),v,this.gv._zoom,e(k+".dash.3d.accuracy")),Cj(E,N)},invalidate:function(){this._bounds=t},getBounds:function(){var W=this;if(!W._bounds){W.labelInfo=W.label2Info=W.noteInfo=W.note2Info=W.iconsInfo=t,W._rects.clear(),W.prepareCreateBounds();var R=W._data,p=W.gv;W.editInfo=p.isEditable(R)?{rectEditable:p.isRectEditable(R),pointEditable:p.isPointEditable(R),rotationEditable:p.isRotationEditable(R)}:t,W._bounds=W.createBounds()}return W._bounds},prepareCreateBounds:function(){},getPosition:function(){return sl},addRect:function(g,n){g&&this._rects.add(Mb(g,n))},createBounds:function(){var S=this;S.updateLabel(wj,"getLabel"),S.updateLabel(Dm,"getLabel2"),S.updateNote(Er,"getNote"),S.updateNote(aq,"getNote2"),S.updateIcons(),S.editInfo&&S.updateEdit();var F;return S._rects.each(function(d){F=co(F,d)}),S._rects.clear(),F},draw:function(j){var L=this,v=L._data,E=L.gv,U=v.s("opacity");if(U!=t){var T=j.globalAlpha;j.globalAlpha=U}L.drawBody(j),E.isLabelVisible(v)&&(ui(j,L.labelInfo),ui(j,L.label2Info)),E.isNoteVisible(v)&&(ak(j,L.noteInfo),ak(j,L.note2Info)),L._drawIcons(j),U!=t&&(j.globalAlpha=T),L.editInfo&&E.isEditVisible(v)&&L.drawEdit(j)},drawBody:function(){},drawEdit:function(){},updateLabel:function(o,v){var h=this,b=h._data,E=h.gv,T=h.s,U=E[v](b);if(U!=t){var B=T(o+".scale"),d=T(o+".max"),n=T(o+".position"),z=h[o+"Info"]={label:U,scale:B,color:E[v+"Color"](b),font:T(o+".font"),opacity:T(o+".opacity"),rotation:h.getRotation(T(o+".rotation"),!1,n),background:E[v+"Background"](b)},L=_k(z,U);d>0&&d<L.width&&(z.labelWidth=L.width,L.width=d),1!==B&&(L.width*=B,L.height*=B);var s=h.getPosition(n,T(o+".offset.x"),T(o+".offset.y"),L,T(o+".position.fixed"));if(L.x=s.x-L.width/2,L.y=s.y-L.height/2,h.addRect(z.rect=L,z.rotation),1!==B){var k=L.width/B,G=L.height/B;z.rect={x:s.x-k/2,y:s.y-G/2,width:k,height:G}}}},updateNote:function(k,s){var w=this,D=w.gv,G=w._data,g=w.s,i=D[s](G);if(i!=t){var L,u,r=g(k+".scale"),W=w[k+"Info"]={note:i,scale:r,expanded:g(k+".expanded"),font:g(k+".font"),color:g(k+".color"),opacity:g(k+".opacity"),borderWidth:g(k+".border.width"),borderColor:g(k+".border.color"),background:D[s+"Background"](G)},A=w.getPosition(g(k+".position"),g(k+".offset.x"),g(k+".offset.y")),O=A.x,f=A.y;if(W.expanded){var M=g(k+".max"),V=_k(W,i);V.width+=6,V.height+=2,M>0&&M<V.width&&(W.labelWidth=V.width,V.width=M),L=V.width,u=V.height+8,W.clickRect={x:O-L*r/2,y:f-u*r,width:L*r,height:u*r*V.height/u}}else L=12,u=18,W.clickRect={x:O-L*r/2,y:f-u*r,width:L*r,height:u*r};W.rect={x:O-L/2,y:f-u*r/2-u/2,width:L,height:u};var p=n(1,r);w.addRect({x:O-L*r/2-p,y:f-u*r-p,width:L*r+2*p,height:u*r+2*p})}},updateEdit:function(){},_drawIcons:function(M){var Y=this,T=Y.iconsInfo;if(T){var P=Y.gv,b=Y._data,S=T.icons;for(var k in S){var H=S[k],B=T.rects[k];if(B){var Q=an(H.opacity,b,P),_=an(H.names,b,P),q=_?_.length:0,R=B.rotation;if(Q!=t){var o=M.globalAlpha;M.globalAlpha*=Q}for(var x=0;q>x;x++){var E=_[x],V=vn(E),z=B[x];if(R){var C=z.x+z.width/2,u=z.y+z.height/2;M.save(),Ap(M,C,u),$p(M,R),Ap(M,-C,-u)}yg(M,V,an(H.stretch,b,P),z.x,z.y,z.width,z.height,Y._data,Y.gv),R&&M.restore()}Q!=t&&(M.globalAlpha=o)}}}}});var af=function(F,S){Ag(af,this,[F,S])};Ib(af,gj,{_addBorderAndSelectRect:function(w,C){var m=this,t=m.s,N=w.rect;(w.borderColor=m.gv.getBorderColor(m._data))&&(w.borderType=t("border.type"),w.borderWidth=t("border.width"),w.borderPadding=t("border.padding"),C=n(C,w.borderPadding+w.borderWidth/2)),(w.selectWidth=m.getSelectWidth())&&(w.selectType=t("select.type"),w.selectColor=t("select.color"),w.selectPadding=t("select.padding"),C=n(C,w.selectPadding+w.selectWidth/2)),C>0&&(N=Nc(N),Am(N,C)),m.addRect(N)},_drawBorderAndSelect:function(i,Z,_){var _=Z.rect;if(Z.borderWidth>0){var p=Z.borderPadding;i.strokeStyle=Z.borderColor,i.lineWidth=Z.borderWidth,i.beginPath(),Fe(i,Z.borderType,{x:_.x-p,y:_.y-p,width:_.width+2*p,height:_.height+2*p}),i.stroke()}Z.selectWidth>0&&(p=Z.selectPadding,i.strokeStyle=Z.selectColor,i.lineWidth=Z.selectWidth,Fe(i,Z.selectType,{x:_.x-p,y:_.y-p,width:_.width+2*p,height:_.height+2*p}),i.stroke())},prepareCreateBounds:function(){var x=this,A=x.s,o=x._data,N=o.getStyle(zq),X=x.getBodyColor(),U=x._nodeInfo=N?{shape:N,shapeBackground:x.getBodyColor("shape.background"),shapeRepeatImage:vn(A("shape.repeat.image"),X),shapeBorderWidth:A("shape.border.width"),shapeBorderColor:A("shape.border.color"),shapeBorder3d:A("shape.border.3d"),shapeBorder3dColor:A("shape.border.3d.color"),shapeBorder3dAccuracy:A("shape.border.3d.accuracy"),shapeGradient:A("shape.gradient"),shapeGradientColor:A("shape.gradient.color"),shapeBorderPattern:A("shape.border.pattern"),shapeBorderCap:A("shape.border.cap"),shapeBorderJoin:A("shape.border.join")}:{img:vn(o.getImage(),X),bodyColor:X,stretch:A("image.stretch")};U.rect=o.getRect(),U.position=o.p(),U.rotation=o.getRotation(),N===Qm&&(U.shapeDepth=A("shape.depth")),x._addBorderAndSelectRect(U,N?Mg(t,U.shapeBorderWidth/2,U.shapeBorderJoin):0)},getPosition:function(L,a,R,$){var T=kl(L,this._nodeInfo.rect,$);return T.x+=a,T.y+=R,T},drawBody:function(c){var H=this,r=H.s,l=H.gv,x=H._data,y=H._nodeInfo,A=y.rect,X=A,e=y.position,t=y.rotation,P=y.shape;if(A.width>0&&A.height>0){if(t&&(c.save(),Ap(c,e.x,e.y),$p(c,t),Ap(c,-e.x,-e.y),X=x.getSize(),X.x=e.x-X.width/2,X.y=e.y-X.height/2),H.freeDraw)H.freeDraw(c,X,y);else if(P){var v,U,K,g,o=y.shapeBorderPattern,G=Uj(c,o),z=y.shapeBackground,S=y.shapeRepeatImage,i=y.shapeBorderWidth,s=y.shapeBorderColor,d=c.lineJoin,p=c.lineCap;if("roundRect"===P?v=r("shape.corner.radius"):"polygon"===P?v=r("shape.polygon.side"):"arc"===P&&(v=r("shape.arc.from"),U=r("shape.arc.to"),K=r("shape.arc.close"),g=r("shape.arc.oval")),c.lineJoin=y.shapeBorderJoin,c.lineCap=y.shapeBorderCap,z||S?(S?Xj(c,S):kg(c,z,y.shapeGradient,y.shapeGradientColor,X),Fe(c,P,X,v,U,K,g),c.fill(),c!==G&&Fe(G,P,X,v,U,K,g)):Fe(G,P,X,v,U,K,g),i>0&&(c.lineWidth=i,c.strokeStyle=s,c.stroke(),y.shapeBorder3d&&bi(c,s,y.shapeBorder3dColor,i,l._zoom,y.shapeBorder3dAccuracy)),Cj(c,o),r("shape.dash")){var T=r("shape.dash.width")||i;if(T>0){o=r("shape.dash.pattern");var G=Uj(c,o,H.getDashOffset("shape.dash.offset"));G!==c&&Fe(G,P,X,v,U,K,g),H.drawDash(c,"shape",T,o)}}bq(c,z,y.shapeDepth,X),c.lineJoin=d,c.lineCap=p}else yg(c,y.img,y.stretch,X.x,X.y,X.width,X.height,x,l,y.bodyColor);t&&c.restore()}H._drawBorderAndSelect(c,y)},updateEdit:function(){var _,g=this,S=g._data,t=g.gv,p=g.editInfo,o=t.getEditPointSize()/2+2;if(p.rectEditable&&(_=S.getRect(),Am(_,o)),p.rotationEditable){var H=p.rotationPoint=t.getRotationPoint(S);_=co(_,{x:H.x-o,y:H.y-o,width:2*o,height:2*o})}g.addRect(_)},drawEdit:function(P){var n=this,_=n.gv,F=n.editInfo,Y=n._data.getRect(),i=_.getEditPointSize(),N=F.rotationPoint;F.rectEditable&&(P.fillStyle=_.getEditPointBackground(),P.strokeStyle=_.getEditPointBorderColor(),P.lineWidth=1,[{x:Y.x,y:Y.y},{x:Y.x+Y.width/2,y:Y.y},{x:Y.x+Y.width,y:Y.y},{x:Y.x,y:Y.y+Y.height/2},{x:Y.x+Y.width,y:Y.y+Y.height/2},{x:Y.x,y:Y.y+Y.height},{x:Y.x+Y.width/2,y:Y.y+Y.height},{x:Y.x+Y.width,y:Y.y+Y.height}].forEach(function(n){hc(P,n.x-i/2,n.y-i/2,i,i),P.stroke()})),F.rotationEditable&&(P.fillStyle=_.getEditPointBorderColor(),P.strokeStyle=_.getEditPointBackground(),P.lineWidth=1,P.beginPath(),P.arc(N.x,N.y,i/2,0,x,!0),P.fill(),P.stroke())}});var qd=function(B,W){Ag(qd,this,[B,W])},kn=function(u,o,y,l){var g=Uk(u,o);return y=l?d(y,g):Fi(y,g),g?y/=g:y=0,{x:u.x+(o.x-u.x)*y,y:u.y+(o.y-u.y)*y}};Ib(qd,gj,{prepareCreateBounds:function(){var l,B=this,E=B._data,g=B.gv,n=B.s,O=n(Jl),h=E.isLooped(),s=n("edge.width"),Q=n("edge.center"),x=n("edge.offset"),q=g.getBorderColor(E),H=q?n("border.width"):0,o=B.getSelectWidth(),Y=E._sourceAgent,y=E._targetAgent,X=B._edgeInfo=Y&&y?{looped:h,type:O,width:s,center:Q,color:B.getBodyColor("edge.color"),borderColor:q,borderWidth:H,selectColor:o?n("select.color"):t,selectWidth:o,pattern:n("edge.pattern"),cap:n("edge.cap"),join:n("edge.join"),is3d:n("edge.3d"),edge3dColor:n("edge.3d.color"),edge3dAccuracy:n("edge.3d.accuracy")}:t;if(X){var C=b.getEdgeType(O);if(C){var p=C(E,ep(B,g,E,h,O),g,B._sameSourceWithFirstEdge);p.points&&p.points.size()>1&&(X.edgeTypeInfo=p,l=Hi(X.edgeTypeInfo.points))}else{var _=oc(g,Y,n("edge.source.position"),n("edge.source.offset.x"),n("edge.source.offset.y")),P=oc(g,y,n("edge.target.position"),n("edge.target.offset.x"),n("edge.target.offset.y"));if(O===io){var N=X.points=n(wq)||ll,F=N.size();if(X.segments=n("edge.segments"),!Q)if(x){var M=kn(_,F?N.get(0):P,x,F),w=kn(P,F?N.get(F-1):_,x,F);_=M,P=w}else{var A=Lb(g,Y),r=Lb(g,y),z=Vn(_,F?N.get(0):P,A);z&&(_={x:z[0],y:z[1]}),z=Vn(F?N.get(F-1):_,P,r),z&&(P={x:z[0],y:z[1]})}l=co(Hi(X.points),Hi(_,P))}else{var v=ep(B,g,E,h,O);if(B._sameSourceWithFirstEdge||(v=-v),h)_=Nc(_),_.x-=Y.getWidth()/2,X.radius=v,l={x:_.x-v,y:_.y-v,width:2*v,height:2*v};else{var a=Uk(_,P),f=Fi(x,a),M={x:f,y:v},w={x:a-f,y:v},V=W(P.y-_.y,P.x-_.x),m=X.mat=new dr(V);if(X.orienAngle=V,X.angle=P.x<_.x?V+R:V,X.rect={x:M.x,y:M.y,width:w.x-M.x,height:0},X.origin=_,M=m.tf(M),M.x+=_.x,M.y+=_.y,w=m.tf(w),w.x+=_.x,w.y+=_.y,Q){var S={x:a,y:0};S=m.tf(S),S.x+=_.x,S.y+=_.y,l=Hi([_,M,w,S]),X.c1=_,X.c2=S}else l=Hi(M,w);_=M,P=w}}X.sourcePoint=_,X.targetPoint=P}Mg(l,s/2+H+o,X.join),B.addRect(l)}},getRotation:function(y,b,N){y=y||0;var T=this._edgeInfo;if(T){var L,$=T.angle,V=T.points,A=T.edgeTypeInfo;if($!=t)return b?T.orienAngle+y:$+y;if(A){var k=A.points;return L=k.size(),Oe[N]?L&&0===L%2?fm(k.get(L/2-1),k.get(L/2),b,y):y:ue[N]?fm(k.get(0),k.get(1),b,y):fm(k.get(L-2),k.get(L-1),b,y)}if(V)return L=V.size(),Oe[N]?L&&0===L%2?fm(V.get(L/2-1),V.get(L/2),b,y):y:ue[N]?fm(T.sourcePoint,L?V.get(0):T.targetPoint,b,y):fm(L?V.get(L-1):T.sourcePoint,T.targetPoint,b,y)}return y},getPosition:function(c,s,Y,d,G){var K=this._edgeInfo;if(K){var w,H=K.type,R=K.points,M=K.edgeTypeInfo,S=K.sourcePoint,j=K.targetPoint;if(!H)return K.looped?{x:S.x-K.radius+s,y:S.y+Y}:(G&&S&&j&&(S.x>j.x||S.x===j.x&&S.y>j.y)&&(c=Up[c],Y=-Y),w=kl(c,K.rect,d),w.x+=s,w.y+=Y,w=K.mat.tf(w),w.x+=K.origin.x,w.y+=K.origin.y,w);if(R){var w,n=R.size();if(Oe[c]){if(n){var X=n%2;if(0===X)return om(R.get(n/2-1),R.get(n/2),c,s,Y,d,G);w=R.get((n-X)/2)}else w={x:(S.x+j.x)/2,y:(S.y+j.y)/2};return w=kl(c,{x:w.x,y:w.y,width:0,height:0},d),w.x+=s,w.y+=Y,w}return ue[c]?om(S,n?R.get(0):j,c,s,Y,d,G):om(n?R.get(n-1):S,j,c,s,Y,d,G)}if(M){var U=M.points,n=U.size();if(Oe[c]){var X=n%2;return 0===X?om(U.get(n/2-1),U.get(n/2),c,s,Y,d,G):(w=U.get((n-X)/2),w=kl(c,{x:w.x,y:w.y,width:0,height:0},d),w.x+=s,w.y+=Y,w)}return ue[c]?om(U.get(0),U.get(1),c,s,Y,d,G):om(U.get(n-2),U.get(n-1),c,s,Y,d,G)}}return sl},draw:function(e){this._edgeInfo&&qd.superClass.draw.call(this,e)},drawPath:function(t,S){t.beginPath();var E=S.type,C=S.points,e=S.segments,o=S.edgeTypeInfo;if(!E||C){var X=S.sourcePoint,d=X.x,m=X.y,M=S.targetPoint,H=M.x,W=M.y;if(E)if(e){var U=new Me({x:d,y:m});U.addAll(C),U.add({x:H,y:W}),fl(t,U,e)}else t.moveTo(d,m),C.each(function(i){t.lineTo(i.x,i.y)}),t.lineTo(H,W);else S.looped?t.arc(d,m,S.radius,0,x,!0):S.center?(t.moveTo(S.c1.x,S.c1.y),t.lineTo(d,m),t.lineTo(H,W),t.lineTo(S.c2.x,S.c2.y)):(t.moveTo(d,m),t.lineTo(H,W))}else o&&fl(t,o.points,o.segments)},drawBody:function(Y){var W=this,L=W.s,M=W._edgeInfo,x=M.width,k=M.selectWidth,y=M.borderWidth,V=M.color,g=Y.lineJoin,A=Y.lineCap,s=M.pattern;if(Y.lineJoin=M.join,Y.lineCap=M.cap,W.drawPath(Uj(Y,s),M),k&&(Y.strokeStyle=M.selectColor,Y.lineWidth=x+2*(y+k),Y.stroke()),y&&(Y.strokeStyle=M.borderColor,Y.lineWidth=x+2*y,Y.stroke()),Y.strokeStyle=V,Y.lineWidth=x,Y.stroke(),M.is3d&&bi(Y,V,M.edge3dColor,x,W.gv._zoom,M.edge3dAccuracy),Cj(Y,s),L("edge.dash")){s=L("edge.dash.pattern");var T=Uj(Y,s,W.getDashOffset("edge.dash.offset"));T!==Y&&W.drawPath(T,M),W.drawDash(Y,"edge",L("edge.dash.width")||x,s)}Y.lineJoin=g,Y.lineCap=A},updateEdit:function(){var W=this,b=W._edgeInfo;if(W.editInfo.pointEditable&&b&&b.points){var s=Hi(b.points);s&&(Am(s,W.gv.getEditPointSize()/2+2),W.addRect(s))}},drawEdit:function(u){var o=this,m=o.gv,k=o._edgeInfo;if(o.editInfo.pointEditable&&k&&k.points){var V=m.getEditPointSize()/2;u.fillStyle=m.getEditPointBackground(),u.strokeStyle=m.getEditPointBorderColor(),u.lineWidth=1,k.points.each(function(t){u.beginPath(),u.arc(t.x,t.y,V,0,x,!0),u.fill(),u.stroke()})}},getEdgeGroupGap:function(H,C){var z=this,U=z._data;if(z._sameSourceWithFirstEdge=!0,!U.getEdgeGroup())return H?U.s("edge.gap"):0;var g,u=0,y=0,n=0;if(U.getEdgeGroup().getSiblings().each(function(W){W.each(function(M){if(z.gv.isVisible(M)&&M.s(Jl)==C){var E=M.s("edge.gap");g?(y+=n/2+E/2,n=E):(g=M,n=E),M===U&&(u=y)}})}),H)return y-u+n;var v=u-y/2;return g&&U._sourceAgent!==g._sourceAgent&&(z._sameSourceWithFirstEdge=!1),v}});var ib=function(W,K){Ag(ib,this,[W,K])};Ib(ib,af,{prepareCreateBounds:function(){var U,g,N=this,P=N.s,_=N._data,v=N.gv;if(N._groupInfo=t,_.isExpanded()&&_.eachChild(function(o){var y=v.getBoundsForGroup(o);y&&(g||(g=[]),g.push(y),U=co(U,y))}),U){var z=v.getLabel(_),L=P("group.type");U=Th(L,g,U),ne(U,_,"group.padding",1);var m=N._groupInfo={type:L,rect:U,childrenRect:U};if(!L&&z!=t){var d,G=N.labelInfo={label:z,color:P("group.title.color"),font:P("group.title.font")},V=_k(G,z),b=V.width,A=V.height,F=P("group.title.align");b>U.width&&(U.width=b),G.rect={y:U.y-A,width:V.width,height:A},d=F===s?U.x:F===c?U.x+U.width-b:U.x+U.width/2-b/2,G.rect.x=d,m.titleRect={x:U.x,y:U.y-A,width:U.width,height:A+1},m.rect={x:U.x,y:U.y-A,width:U.width,height:U.height+A}}N._addBorderAndSelectRect(m,P("group.border.width")/2)}else ib.superClass.prepareCreateBounds.call(N)},getPosition:function(T,X,Z,j){var E=this._groupInfo;if(E){var U=kl(T,E.rect,j);return U.x+=X,U.y+=Z,U}return ib.superClass.getPosition.apply(this,arguments)},updateLabel:function(V,g){var y=this._groupInfo;(!y||y.type||"label2"===V)&&ib.superClass.updateLabel.call(this,V,g)},drawBody:function(S){var n=this,p=n._groupInfo;if(p){var Y=n._data,g=n.s,j=n.gv,a=p.type,F=p.rect,s=p.childrenRect,h=p.titleRect,f=n.getBodyColor(),d=vn(g("group.image"),f),l=g("group.image.stretch"),N=n.getBodyColor("group.background"),E=vn(g("group.repeat.image"),f),P=g("group.gradient"),V=g("group.gradient.color"),W=g("group.depth");if(a){var $=g("group.border.pattern"),A=g("group.border.width"),e=S.lineJoin,i=S.lineCap;if(S.lineJoin=g("group.border.join"),S.lineCap=g("group.border.cap"),d){if(S.save(),Fe(S,a,F),S.clip(),yg(S,d,l,F.x,F.y,F.width,F.height,Y,j,f),S.restore(),A>0){var O=Uj(S,$);Fe(O,a,F),S.lineWidth=A,S.strokeStyle=g("group.border.color"),S.stroke(),Cj(S,$)}}else{var O=Uj(S,$);N||E?(E?Xj(S,E):kg(S,N,P,V,F),Fe(S,a,F),S.fill(),S!==O&&Fe(O,a,F)):Fe(O,a,F),A>0&&(S.lineWidth=A,S.strokeStyle=g("group.border.color"),S.stroke()),Cj(S,$),a===Qm&&bq(S,N,W,F)}S.lineJoin=e,S.lineCap=i}else if(d?yg(S,d,l,s.x,s.y,s.width,s.height,Y,j,n.getBodyColor()):(N||E)&&(E?Xj(S,E):kg(S,N,P,V,s),Fe(S,Qm,s),S.fill(),bq(S,N,W,s)),h){var R=g("group.title.background");hc(S,h.x,h.y,h.width,h.height,R),bq(S,R,W,h)}n._drawBorderAndSelect(S,p)}else ib.superClass.drawBody.call(n,S)}});var Eo=function(t,n){Ag(Eo,this,[t,n])};Ib(Eo,af,{prepareCreateBounds:function(){var y=this,B=y._data,f=y.s,J=y.gv,C=B.getPoints(),e=J.getBorderColor(B),w=e?f("border.width"):0,U=y.getSelectWidth(),u=f("shape.border.width"),E=B.getRect(),i=J.getBodyColor(B),n=y._shapeInfo=C.isEmpty()?t:{rect:E,rotation:B.getRotation(),position:B.p(),points:C,segments:B.getSegments(),bodyColor:i,borderColor:e,borderWidth:w,border3d:f("shape.border.3d"),border3dColor:f("shape.border.3d.color"),border3dAccuracy:f("shape.border.3d.accuracy"),selectColor:U?f("select.color"):t,selectWidth:U,shapeBackground:f("shape.background"),shapeRepeatImage:vn(f("shape.repeat.image"),i),shapeBorderWidth:u,shapeBorderColor:f("shape.border.color"),shapeGradient:f("shape.gradient"),shapeGradientColor:f("shape.gradient.color"),shapeBorderPattern:f("shape.border.pattern"),shapeBorderCap:f("shape.border.cap"),shapeBorderJoin:f("shape.border.join")};if(n){var q=u/2+w+U;q&&(E=Nc(E),Mg(E,q,n.shapeBorderJoin)),this.addRect(E)}},getPosition:function(W,l,N,H){var q=this._shapeInfo;if(q){var O=kl(W,q.rect,H);return O.x+=l,O.y+=N,O}return sl},draw:function(d){this._shapeInfo&&Eo.superClass.draw.call(this,d)},drawBody:function(J){var q,Y=this,n=Y.s,c=Y._shapeInfo,N=c.position,D=c.rotation,b=c.bodyColor,g=c.borderWidth,C=c.selectWidth,M=c.shapeBackground,Q=c.shapeRepeatImage,U=c.shapeBorderWidth,X=c.points,o=c.segments,a=Y._data.isClosePath();D&&(J.save(),Ap(J,N.x,N.y),$p(J,D),Ap(J,-N.x,-N.y));var k=c.shapeBorderPattern,i=Uj(J,k),O=J.lineJoin,z=J.lineCap;if(J.lineJoin=c.shapeBorderJoin,J.lineCap=c.shapeBorderCap,M||Q?(Q?Xj(J,Q):(q=b?b:M,kg(J,q,c.shapeGradient,c.shapeGradientColor,c.rect)),fl(J,X,o,a),J.fill(),i!==J&&fl(i,X,o,a)):fl(i,X,o,a),C&&(J.strokeStyle=c.selectColor,J.lineWidth=U+2*(g+C),J.stroke()),g&&(J.strokeStyle=c.borderColor,J.lineWidth=U+2*g,J.stroke()),U&&(q=c.shapeBorderColor,!M&&b&&(q=b),J.strokeStyle=q,J.lineWidth=U,J.stroke(),c.border3d&&bi(J,q,c.border3dColor,U,Y.gv._zoom,c.border3dAccuracy)),Cj(J,k),n("shape.dash")){var p=n("shape.dash.width")||U;if(p>0){k=n("shape.dash.pattern");var i=Uj(J,k,Y.getDashOffset("shape.dash.offset"));i!==J&&fl(i,X,o,a),Y.drawDash(J,"shape",p,k)}}J.lineJoin=O,J.lineCap=z,D&&J.restore()},updateEdit:function(){var K=this;if(Eo.superClass.updateEdit.call(K),K.editInfo.pointEditable){var o=K._data.getRect();Am(o,K.gv.getEditPointSize()/2+2),K.addRect(o)}},drawEdit:function(m){var I=this;if(Eo.superClass.drawEdit.call(I,m),I.editInfo.pointEditable){var F=I.gv,g=F.getEditPointSize()/2;m.fillStyle=F.getEditPointBackground(),m.strokeStyle=F.getEditPointBorderColor(),m.lineWidth=1,I._data.getPoints().each(function(H){m.beginPath(),m.arc(H.x,H.y,g,0,x,!0),m.fill(),m.stroke()})}}});var Fc=function(y,A){Ag(Fc,this,[y,A])};Ib(Fc,Eo,{getRotation:function($,g,x){$=$||0;var H=this._data.getPoints(),Q=H.size();return Q>1?Oe[x]?Q&&0===Q%2?fm(H.get(Q/2-1),H.get(Q/2),g,$):$:ue[x]?fm(H.get(0),H.get(1),g,$):fm(H.get(Q-2),H.get(Q-1),g,$):$},getPosition:function(g,r,i,z,n){var q=this._data.getPoints(),C=q.size();if(C>1){if(Oe[g]){var w=C%2;if(0===w)return om(q.get(C/2-1),q.get(C/2),g,r,i,z,n);var K=q.get((C-w)/2),N={x:K.x,y:K.y,width:0,height:0};return K=kl(g,N,z),K.x+=r,K.y+=i,K}return ue[g]?om(q.get(0),q.get(1),g,r,i,z,n):om(q.get(C-2),q.get(C-1),g,r,i,z,n)}return sl}});var Sm=function(x,T){Ag(Sm,this,[x,T])};Ib(Sm,af,{prepareCreateBounds:function(){var i=this;Sm.superClass.prepareCreateBounds.call(i);var H=i.s,L=i._nodeInfo;i._gridInfo=L.img||L.shape?t:{background:i.getBodyColor("grid.background"),depth:H("grid.depth"),rect:L.rect,cellDepth:H("grid.cell.depth"),cellBorderColor:H("grid.cell.border.color"),rowCount:H("grid.row.count"),columnCount:H("grid.column.count"),block:H("grid.block"),blockColor:H("grid.block.color"),blockPadding:H("grid.block.padding"),blockWidth:H("grid.block.width")}},drawBody:function(p){var E=this,R=E._gridInfo;if(!R)return Sm.superClass.drawBody.call(E,p),void 0;var P,l,b=E._data,q=R.background,Y=R.rect,v=R.block,G=R.blockColor,$=R.blockPadding,B=R.blockWidth,z=R.cellDepth,r=R.cellBorderColor,H=R.rowCount,j=R.columnCount;if(q)if(hc(p,Y.x,Y.y,Y.width,Y.height,q),bq(p,q,R.depth,Y),z)for(P=0;H>P;P++)for(l=0;j>l;l++)Y=b.getCellRect(P,l),Y&&bq(p,q,z,Y);
else if(r){for(p.beginPath(),P=0;H>P;P++)for(l=0;j>l;l++)Y=b.getCellRect(P,l),Y&&p.rect(Y.x,Y.y,Y.width,Y.height);p.strokeStyle=r,p.lineWidth=1,p.stroke()}if("h"===v)for(P=0;H>P;P++)Y=co(b.getCellRect(P,0),b.getCellRect(P,j-1)),Am(Y,$),Ji(p,G,Y.x,Y.y,Y.width,Y.height,B);else if("v"===v)for(l=0;j>l;l++)Y=co(b.getCellRect(0,l),b.getCellRect(H-1,l)),Am(Y,$),Ji(p,G,Y.x,Y.y,Y.width,Y.height,B);E._drawBorderAndSelect(p,E._nodeInfo)}});var Yp=od.Interactor=function(E){this.gv=this._graphView=E};th("Interactor",X,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(p){this.gv.fi(p)},setCursor:function(b){F||(this.getView().style.cursor=b)},startDragging:function(N){var d=this;d._lastClientPoint=Rg(N),d._lastLogicalPoint=d.gv.lp(N),ns(d,N)},clearDragging:function(){var R=this;R._lastClientPoint=R._lastLogicalPoint=R._logicalPoint=t},autoScroll:function(E){return this.gv.autoScroll(E,this._lastClientPoint)}});var vi=od.DefaultInteractor=function(W){Ag(vi,this,[W])};th("DefaultInteractor",Yp,{handle_mousedown:function(Y){Vk(Y);var E=this,Z=E.gv,D=Z.getDataAt(Y);Z.setFocus(Y)&&!Z._editing&&(Zp(Y)?Z.handleDoubleClick(Y,D):Z.handleClick(Y,D),Z.isPannable()&&!D&&kf(Y)&&!is(Y)&&(E._tx=Z.tx(),E._ty=Z.ty(),E.startDragging(Y)))},handleWindowMouseUp:function(Z){var V=this,g=V.gv;g._panning&&(delete g._panning,g.onPanEnded(),V.fi({kind:"endPan",event:Z})),delete V._tx,delete V._ty,V.clearDragging()},handleWindowMouseMove:function(Z){var $=this,e=$.gv,R=$._lastClientPoint;$.fi({kind:e._panning?"betweenPan":"beginPan",event:Z}),e._panning=1,e.setTranslate($._tx+Z.clientX-R.x,$._ty+Z.clientY-R.y)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta)},handle_DOMMouseScroll:function(Y){2===Y.axis&&this.gv.handleScroll(Y,-Y.detail)},handle_keydown:function(N){this.gv.handleKeyDown(N)}});var xc=od.SelectInteractor=function(X){Ag(xc,this,[X])};th("SelectInteractor",Yp,{draw:function(){var S=this,u=S.gv,H=u.getZoom(),$=S.mark,F=S.div;F||(F=S.div=gc(),Zc(S.getView(),F));var N={};N.x=$.x*H+u.tx(),N.y=$.y*H+u.ty(),N.width=$.width*H,N.height=$.height*H,fg(F,N),this.intersects()?(F.style.border="",F.style.background=u.getRectSelectBackground()):(F.style.background="",F.style.border="1px solid "+u.getRectSelectBorderColor())},handle_mousedown:function(g){var M=this,z=M.gv;if(M.pendingCS=t,!z._editing){var i=z.getDataAt(g),V=z.sm();i?is(g)?V.co(i)?V.rs(i):V.as(i):V.co(i)||V.ss(i):is(g)||!z.isPannable()?kf(g)&&(is(g)||V.cs(),z.isRectSelectable()&&(M.startDragging(g),z._selectingData=1)):M.pendingCS=Rg(g)}},handle_mouseup:function(q){var z=this,Q=z.pendingCS;Q&&(Uk(Q,Rg(q))<=1&&z.gv.sm().cs(),z.pendingCS=t)},handleWindowMouseUp:function(H){this.clear(H)},handleWindowMouseMove:function(V){var Q=this,R=Q.gv;Q._logicalPoint=R.lp(V),Q.mark?(Q.fi({kind:"betweenRectSelect",event:V}),Q.autoScroll(V),Q.redraw()):Q.fi({kind:"beginRectSelect",event:V}),Q.mark=Hi(Q._lastLogicalPoint,Q._logicalPoint),Q.redraw()},intersects:function(){var Y=this,o=Y._lastLogicalPoint,i=Y._logicalPoint;return o.x>i.x||o.y>i.y},clear:function(X){var E=this,a=E.gv,I=E.mark;if(E.pendingCS=t,E._lastLogicalPoint){if(I){if(0!==I.width&&0!==I.height){var J=a.getDatasInRect(I,E.intersects());if(!J.isEmpty()){var s=a.sm(),P=s.toSelection();J.each(function(T){s.co(T)?P.remove(T):P.add(T)}),s.ss(P)}}gi(E.div),delete E.div,delete E.mark,E.redraw(),E.fi({kind:"endRectSelect",event:X}),a.onRectSelectEnded()}E.clearDragging(),delete a._selectingData}},redraw:function(){var k=this;k._draw||(k._draw=1,N(function(){k.mark&&k.draw(),delete k._draw},16))}});var se=od.MoveInteractor=function(p){Ag(se,this,[p])};th("MoveInteractor",Yp,{handle_mousedown:function(y){var x=this,Z=x.gv;if(kf(y)&&!Z._editing){var C=Z.getSelectedDataAt(y);C?(x._data=C,Z.handleMouseDown&&Z.handleMouseDown(y,C),x.startDragging(y),Z.isMovable(C)&&(Z._moving=1)):Z._focusData=t}},handleWindowMouseUp:function(X){var C=this,V=C.gv;V.handleMouseUp&&V.handleMouseUp(X,C._data),C.clear(X)},handleWindowMouseMove:function(J){var U=this,y=U.gv,M=U._data,F=y.getDataModel(),l=F.getHistoryManager();if((!y.checkLiveDrag||!y.checkLiveDrag(J,M))&&y._moving){var X=U._logicalPoint?"betweenMove":"beginMove",V={kind:X,event:J},I=U._logicalPoint=y.lp(J);l&&"beginMove"===X&&l.beginInteraction();var N=I.x-U._lastLogicalPoint.x,r=I.y-U._lastLogicalPoint.y,g=y.getMoveMode(J,M);g&&("x"===g?r=0:"y"===g?N=0:"xy"!==g&&(N=r=0)),y.moveSelection(N,r),U._lastLogicalPoint=I,U.autoScroll(J),U.fi(V)}},clear:function(C){var g=this,o=g.gv,e=o.getDataModel(),w=e.getHistoryManager();g._lastLogicalPoint&&(g._lastLogicalPoint=g._data=o._moving=t,g._logicalPoint&&(g.fi({kind:"endMove",event:C}),o.onMoveEnded(),w&&w.endInteraction()),g.clearDragging())}});var Ze=od.EditInteractor=function(T){Ag(Ze,this,[T])};th("EditInteractor",Yp,{ms_edit:1,setUp:function(){var a=this;Ze.superClass.setUp.call(a),F||a.gv.setEditInteractor(a)},tearDown:function(){Ze.superClass.tearDown.call(this),F||this.gv.setEditInteractor(t)},clear:function(){var a=this,L=a.gv;L._editing&&(L._editing=a._rotationNode=a._node=a._edge=a._shape=a._rect=a._direction=a._index=t,a.clearDragging(),a.setCursor(M))},handle_mousedown:function(r){var Q=this,i=Q.gv.dm(),j=i.getHistoryManager(),S=Q._index,v=Q._node,z=Q._shape,T=Q._edge,k=Q._rotationNode,h=Q._direction;kf(r)&&Q.gv._editing&&(v&&h?(Q._rect=v.getRect(),Q.startDragging(r),j&&j.beginInteraction(),Q.fi({kind:"beginEditRect",event:r,data:v,direction:h})):z&&S>=0?(Q.startDragging(r),j&&j.beginInteraction(),Q.fi({kind:"beginEditPoint",event:r,data:z,index:S})):T&&S>=0?(Q.startDragging(r),j&&j.beginInteraction(),Q.fi({kind:"beginEditPoint",event:r,data:T,index:S})):k&&(Q.startDragging(r),j&&j.beginInteraction(),Q.fi({kind:"beginEditRotation",event:r,data:k})))},handleWindowMouseUp:function(z){this.endEdit(z),this.clear()},handleWindowMouseMove:function(F){this.betweenEdit(F)},handle_mousemove:function(c){if(!Fh){var j=this,z=j.gv;j.checkEdit(c,z.getSelectedDataAt(c))?z._editing=1:j.clear()}}});var il=od.TouchInteractor=function(n,r){r=r||{},r.selectable===Z&&(r.selectable=!0),r.movable===Z&&(r.movable=!0),r.pannable===Z&&(r.pannable=!0),r.pinchable===Z&&(r.pinchable=!0),r.editable===Z&&(r.editable=!0),this.params=r,Ag(il,this,[n])};th("TouchInteractor",Yp,{ms_edit:1,setUp:function(){var f=this;il.superClass.setUp.call(f),F&&f.params.editable&&f.gv.setEditInteractor(f)},tearDown:function(){var S=this;il.superClass.tearDown.call(S),F&&S.params.editable&&S.gv.setEditInteractor(t)},clear:function(F){var G=this,s=G.gv,z=s.dm().getHistoryManager();s._moving&&(G.fi({kind:"endMove",event:F}),delete s._moving,s.onMoveEnded(),z&&z.endInteraction()),s._panning&&(G.fi({kind:"endPan",event:F}),delete s._panning,s.onPanEnded()),s._pinching&&(G.fi({kind:"endPinch",event:F}),delete s._pinching,s.onPinchEnded()),s._editing&&(G.endEdit(F),G._rotationNode=G._node=G._edge=G._shape=G._rect=G._direction=G._index=s._editing=t),G._moving=G._panning=G._pinching=G._editing=G.pendingCS=G._data=G._beginHistory=t,G.clearDragging()},handle_touchstart:function(J){var q=this;if(!q.gv._editing){Vk(J),q.pendingCS=t;var X=q.params,v=q.gv,E=v.sm(),p=v.getDataAt(J),W=Sn(J);if(1===W)Zp(J)?v.handleDoubleClick(J,p):(v.handleClick(J,p),p&&(v.handleMouseDown&&v.handleMouseDown(J,p),q._data=p)),X.selectable||(p=t),p?(E.co(p)||E.ss(p),X.editable&&v.isEditable(p)&&q.checkEdit(J,p,!0)?(q._editing=1,q.startDragging(J)):X.movable&&v.isMovable(p)&&(q._moving=1,q.startDragging(J))):(q.pendingCS=Rg(J),X.pannable&&v.isPannable()&&(q._panning=1,q.startDragging(J),q._translate={x:v.tx(),y:v.ty()}));else if(X.pinchable&&2===W){q._pinching=1,q.startDragging(J);var b=v.getView(),j=v.getZoom(),P=b.getBoundingClientRect(),w=J.touches[0],r=J.touches[1],k={x:(w.clientX+r.clientX)/2-P.left,y:(w.clientY+r.clientY)/2-P.top};k.x-=v.tx(),k.y-=v.ty(),k.x/=j,k.y/=j,q._p=k,q._d=ir(J)}}},handle_touchend:function(n){var C=this,o=C.gv,F=C.pendingCS,d=C._data;F&&(Uk(F,Rg(n))<=1&&o.sm().cs(),C.pendingCS=t),d&&o.handleMouseUp&&o.handleMouseUp(n,d)},handleWindowTouchEnd:function(J){this.clear(J)},handleWindowTouchMove:function(y){var N=this,_=N.gv,L=_.dm().getHistoryManager(),q=Sn(y);if(1===q){if(N._editing&&(L&&!N._beginHistory&&(N._beginHistory=1,L.beginInteraction()),_._editing=1,N.betweenEdit(y)),N._moving)L&&!N._beginHistory&&(N._beginHistory=1,L.beginInteraction()),N.handleMove(y);else if(N._panning){var Q=Rg(y);_.setTranslate(N._translate.x+Q.x-N._lastClientPoint.x,N._translate.y+Q.y-N._lastClientPoint.y),N.fi({kind:_._panning?"betweenPan":"beginPan",event:y}),_._panning=1}}else if(2===q&&N._pinching){var h=ir(y);_.handlePinch(N._p,h,N._d),N._d=h,N.fi({kind:_._pinching?"betweenPinch":"beginPinch",event:y}),_._pinching=1}},handleMove:function(s){var S=this,f=S.gv,v=f.lp(s);f.checkLiveDrag&&f.checkLiveDrag(s,S._data)||(f.moveSelection(v.x-S._lastLogicalPoint.x,v.y-S._lastLogicalPoint.y),S._lastLogicalPoint=v,S.autoScroll(s),S.fi({kind:f._moving?"betweenMove":"beginMove",event:s}),f._moving=1)}});var ek="directional",nl="point",Fg="spot",Qe="light.color";op(b,{graph3dViewAttributes:t,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:R/60,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:el,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:R/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:function(X,Y){Le[X]=Y},getShape3dModel:function(n){return Le[n]},createMatrix:function(q,u){fd(q)||(q=[q]);for(var f=q.length-1;f>=0;f--){var s=q[f];u=Hn(s.mat,s.s3,s.r3,s.rotationMode,s.t3,u)}return u},transformVec:function(T,K){return Ko(T,K)},createBoxModel:function(){return{vs:jj,ns:vd,uv:Sh,is:Fq}},createRoundRectModel:function(X,V){return _j.roundRect(X,V)},createStarModel:function(X,L){return _j.star(X,L)},createRectModel:function(I,n){return _j.rect(I,n)},createTriangleModel:function(P,X){return _j.triangle(P,X)},createRightTriangleModel:function(F,P){return _j.rightTriangle(F,P)},createParallelogramModel:function(A,k){return _j.parallelogram(A,k)},createTrapezoidModel:function(C,t){return _j.trapezoid(C,t)},createSmoothSphereModel:function(I,S,u,s,z,L,D){return ie(new wc(I,S,u,s,z,L,D))},createSphereModel:function(O,r,B,Q,G,o){return O?Rb(O,r,B,Q,G,o):b.createSmoothSphereModel()},createSmoothConeModel:function(f,m,G,W,U){return vr(f,m,G,W,U)},createConeModel:function(H,l,Q,k,i,J){return H?be(H,l,Q,k,i,J):vr(J)},createSmoothCylinderModel:function(l,c,a,f,E,P,X,g){return ie(new _n(l,c,a,f,E,P,X,g))},createCylinderModel:function(x,U,N,d,O,$,P){return x?zd(x,U,N,d,O,$,P):Ne($,P)},createSmoothTorusModel:function(w,N,J,b,c,O){return ie(new zp(w,N,J,b,c,O))},createTorusModel:function(g,w,X,S,b,d,z){return g?Cd(g,w,X,S,b,d,z):zi(d,z)},createExtrusionModel:function(i,J,R,O,T,G,q,v){return dh(i,J,R,O,T,G,q,v)},createSmoothRingModel:function(b,i,M,F,N,R){for(var j=[],G=0;G<b.length-1;G+=2)j.push({x:b[G],y:b[G+1]});for(b=mo(j,i,M)[0],j=[],G=0;G<b.length;G++){var I=b[G];j.push(new hl(I.x,0,I.y))}return ie(new fc(j,R,F,N))},createRingModel:function($,l,A,v,S,T,o,J,m,X){for(var R=[],r=0;r<$.length-1;r+=2)R.push({x:$[r],y:$[r+1]});T=T||b.shapeSide,o=o||0,J=J||T;var s,C,H,e,f,W,D,n,I,i,r,k,p,h,q,K,d,u,a=[],N=[],c=m?[]:t,U=m?[]:t,G=X?[]:t,L=X?[]:t,F=v?[]:t,w=v?[]:t,Z=S?[]:t,B=S?[]:t,$=mo(R,l,A),P=yf($),g=0,O=2*Math.PI/T;return $.forEach(function(x){if(H=x.length,H>1){if(e=x[0],v)for(W=e.x,n=e.y,r=o;J>r;r++)k=r+1,p=r*O,h=k*O,q=_(p),K=E(p),d=_(h),u=E(h),F.push(q*W,n,-K*W,d*W,n,-u*W,0,n,0),w.push(.5-.5*q,.5-.5*K,.5-.5*d,.5-.5*u,.5,.5);for(i=0;H>i;i++){for(f=x[i],W=e.x,D=f.x,n=e.y,I=f.y,s=g/P,g+=Uk(e,f),C=g/P,r=o;J>r;r++)k=r+1,p=r*O,h=k*O,q=_(p),K=E(p),d=_(h),u=E(h),a.push(q*D,I,-K*D,d*D,I,-u*D,q*W,n,-K*W,d*D,I,-u*D,d*W,n,-u*W,q*W,n,-K*W),N.push(r/T,C,k/T,C,r/T,s,k/T,C,k/T,s,r/T,s),m&&r===o&&(c.push(0,n,0,0,I,0,q*D,I,-K*D,q*D,I,-K*D,q*W,n,-K*W,0,n,0),U.push(0,.5-n,0,.5-I,2*D,.5-I,2*D,.5-I,2*W,.5-n,0,.5-n)),X&&k===J&&(G.push(0,n,0,d*D,I,-u*D,0,I,0,d*D,I,-u*D,0,n,0,d*W,n,-u*W),L.push(1,.5-n,1-2*D,.5-I,1,.5-I,1-2*D,.5-I,1,.5-n,1-2*W,.5-n));e=f}if(S)for(W=e.x,n=e.y,r=o;J>r;r++)k=r+1,p=r*O,h=k*O,q=_(p),K=E(p),d=_(h),u=E(h),Z.push(d*W,n,-u*W,q*W,n,-K*W,0,n,0),B.push(.5-.5*d,.5+.5*u,.5-.5*q,.5+.5*K,.5,.5)}}),{vs:a,uv:N,bottom_vs:Z,bottom_uv:B,top_vs:F,top_uv:w,from_vs:c,from_uv:U,to_vs:G,to_uv:L}}},!0),op(L,{"3d.move.mode":Z,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":Z,"edge.gradient.color":Z,"edge.source.t3":Z,"edge.target.t3":Z,"light.type":nl,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":R/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":wr,"wf.short":!1,"wf.mat":Z,batch:Z,"transparent.mask":!1,brightness:Z,"select.brightness":.7,"repeat.uv.length":Z,"label.face":v,"label.t3":Z,"label.r3":Z,"label.texture.scale":2,"label.rotationMode":jk,"label.light":!1,"label.blend":Z,"label.reverse.flip":!1,"label.reverse.color":gl,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":v,"label2.t3":Z,"label2.r3":Z,"label2.texture.scale":2,"label2.rotationMode":jk,"label2.light":!1,"label2.blend":Z,"label2.reverse.flip":!1,"label2.reverse.color":gl,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":v,"note.t3":Z,"note.r3":Z,"note.texture.scale":2,"note.rotationMode":jk,"note.light":!1,"note.blend":Z,"note.reverse.flip":!1,"note.reverse.color":gl,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":v,"note2.t3":Z,"note2.r3":Z,"note2.texture.scale":2,"note2.rotationMode":jk,"note2.light":!1,"note2.blend":Z,"note2.reverse.flip":!1,"note2.reverse.color":gl,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Z,"shape3d.color":Wm,"shape3d.top.color":Z,"shape3d.bottom.color":Z,"shape3d.from.color":Z,"shape3d.to.color":Z,"shape3d.image":Z,"shape3d.top.image":Z,"shape3d.bottom.image":Z,"shape3d.from.image":Z,"shape3d.to.image":Z,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Z,"shape3d.side.to":Z,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Z,"shape3d.opacity":Z,"shape3d.reverse.flip":!1,"shape3d.reverse.color":gl,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Z,"shape3d.uv.scale":Z,"shape3d.top.uv.offset":Z,"shape3d.top.uv.scale":Z,"shape3d.bottom.uv.offset":Z,"shape3d.bottom.uv.scale":Z,"shape3d.from.uv.offset":Z,"shape3d.from.uv.scale":Z,"shape3d.to.uv.offset":Z,"shape3d.to.uv.scale":Z,"shape3d.top.cap":Z,"shape3d.bottom.cap":Z,"shape3d.start.angle":0,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"all.light":!0,"all.visible":!0,"all.color":Wm,"all.image":Z,"all.blend":Z,"all.opacity":Z,"all.reverse.flip":!1,"all.reverse.color":gl,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Z,"all.uv.offset":Z,"all.uv.scale":Z,"all.discard.selectable":!0,mat:Z,"left.mat":Z,"right.mat":Z,"top.mat":Z,"bottom.mat":Z,"front.mat":Z,"back.mat":Z},!0);var Zl,qi=!1,Jq=[0,0,0,1/255],ki={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:s,2:c,3:y,4:a,5:v,6:z}},tm=function(V,I,L,f){if(I.getFaceVisible(V,L)){Ef(I,Gk(V,I.getFaceMat(V,L)||I.getMat(V)));var t=I._gl;I.getFaceReverseCull(V,L)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),Bb(t,I._prg.uFixPickReverseColor,ki[L]),Dj(t,f,6),Ei(I)}},Gj=function(m){return m instanceof kc},Cp=function(Y){return[Y.x,Y.e||0,Y.y]},_m=function(Y,U,T){for(var U=xr(U),f=U[0],Q=U[1],t=U[2];T--;)Y.push(f,Q,t)},ap=function(f,B,M){for(var B=xr(B),q=B[0],k=B[1],i=B[2],P=B[3];M--;)f.push(q,k,i,P)},dj=function(Q,x,J){if(x)for(var e,j,P,s=x[0],V=x[1],L=x[2],w=x[4],S=x[5],f=x[6],X=x[8],W=x[9],m=x[10],A=x[12],R=x[13],v=x[14],B=J.length,F=0,F=0;B>F;F+=3)e=J[F],j=J[F+1],P=J[F+2],Q.push(s*e+w*j+X*P+A,V*e+S*j+W*P+R,L*e+f*j+m*P+v);else jb(Q,J)},ub=function(A,u){var S=u.s("light.intensity"),L=xr(u.s(Qe)),K=L[0],P=L[1],U=L[2];1!==S&&(K*=S,P*=S,U*=S),A.push(K,P,U,u.s("light.disabled")?1:0)},Sd=function(F,w,S){Bb(w,S.uHeadlightRange,F._headlightRange);var f=F._headlightIntensity,u=xr(F._headlightColor);1!==f&&(u=[u[0]*f,u[1]*f,u[2]*f]),Bb(w,S.uHeadlightColor,[u[0],u[1],u[2],F._headlightDisabled?1:0]);var b=F._points,v=F._spots,H=F._dirs;if(b.length){var U=[],$=[],n=[];b.forEach(function(F){ub(U,F),jb($,F.p3()),n.push(F.s("light.range"))}),w.uniform4fv(S.uPointColor,U),w.uniform1fv(S.uPointRange,n),w.uniform3fv(S.uPointPosition,$)}if(v.length){var i=[],g=[],m=[],I=[],D=[],t=[];v.forEach(function(x){ub(i,x),jb(g,x.p3()),jb(m,x.s("light.center")),I.push(x.s("light.range")),D.push(_(x.s("light.angle")/2)),t.push(x.s("light.exponent"))}),w.uniform4fv(S.uSpotColor,i),w.uniform1fv(S.uSpotRange,I),w.uniform1fv(S.uSpotAngle,D),w.uniform1fv(S.uSpotExponent,t),w.uniform3fv(S.uSpotPosition,g),w.uniform3fv(S.uSpotCenter,m)}if(H.length){var R=[],B=[];H.forEach(function(M){ub(R,M),jb(B,M.p3())}),w.uniform4fv(S.uDirColor,R),w.uniform3fv(S.uDirPosition,B)}},pf=function(v){return v>0&&0===(v-1&v)},Bp=function(i){return i=n(0,d(R,i)),i=n(gh,d(R-gh,i))},tn=function(){return.05+S()/2},Jg=function(D,i,J,b){var E,K=D.getEye();return D.isOrtho()?(E=id(D.getCenter(),K),E[0]+=b[0],E[1]+=b[1],E[2]+=b[2]):E=K,bn(i,J,b,E)},bn=function(D,C,p,N){var S=oi(D,C),Q=id(N,p,!0),_=oi(Q,C);if(g(_)<gh)return t;var h=(S-oi(p,C))/_;return[p[0]+Q[0]*h,p[1]+Q[1]*h,p[2]+Q[2]*h]},Bf=function(V,M){return{x:2*V.x-M.x,y:2*V.y-M.y}},Hd=function(q,P,H,m){var d,O;if(!q)return d=W(P.y-H.y,H.x-P.x),{x:P.x+m*E(d),y:P.y+m*_(d)};if(!H)return d=W(q.y-P.y,P.x-q.x),{x:P.x+m*E(d),y:P.y+m*_(d)};var b=id([q.x,q.y,0],[P.x,P.y,0],!0),V=id([H.x,H.y,0],[P.x,P.y,0],!0),J=-(b[0]+V[0])/2,f=-(b[1]+V[1])/2,U=k(J*J+f*f);return gh>U?(d=W(q.y-P.y,P.x-q.x),{x:P.x+m*E(d),y:P.y+m*_(d)}):(d=T(oi(b,V))/2,O=b[1]*V[0]-b[0]*V[1]>0?-1:1,J/=U,f/=U,U=m/E(d),{x:P.x+O*U*J,y:P.y+O*U*f})},Nb=function(j){var S=j[1],l=j[2],Z=j[3],y=j[6],n=j[7],H=j[11];j[1]=j[4],j[2]=j[8],j[3]=j[12],j[4]=S,j[6]=j[9],j[7]=j[13],j[8]=l,j[9]=y,j[11]=j[14],j[12]=Z,j[13]=n,j[14]=H},Lr=function(n){var i=n[0],o=n[1],L=n[2],v=n[3],I=n[4],p=n[5],C=n[6],k=n[7],f=n[8],S=n[9],c=n[10],P=n[11],q=n[12],r=n[13],Q=n[14],G=n[15],T=i*p-o*I,g=i*C-L*I,O=i*k-v*I,V=o*C-L*p,B=o*k-v*p,u=L*k-v*C,l=f*r-S*q,m=f*Q-c*q,W=f*G-P*q,X=S*Q-c*r,F=S*G-P*r,H=c*G-P*Q,b=T*H-g*F+O*X+V*W-B*m+u*l;return b?(b=1/b,n[0]=(p*H-C*F+k*X)*b,n[1]=(L*F-o*H-v*X)*b,n[2]=(r*u-Q*B+G*V)*b,n[3]=(c*B-S*u-P*V)*b,n[4]=(C*W-I*H-k*m)*b,n[5]=(i*H-L*W+v*m)*b,n[6]=(Q*O-q*u-G*g)*b,n[7]=(f*u-c*O+P*g)*b,n[8]=(I*F-p*W+k*l)*b,n[9]=(o*W-i*F-v*l)*b,n[10]=(q*B-r*O+G*T)*b,n[11]=(S*O-f*B-P*T)*b,n[12]=(p*m-I*X-C*l)*b,n[13]=(i*X-o*m+L*l)*b,n[14]=(r*g-q*V-Q*T)*b,n[15]=(f*V-S*g+c*T)*b,void 0):t},Rq=function(N,O){if(O){var z=O[0],t=O[1],Z=O[2];N[12]=N[0]*z+N[4]*t+N[8]*Z+N[12],N[13]=N[1]*z+N[5]*t+N[9]*Z+N[13],N[14]=N[2]*z+N[6]*t+N[10]*Z+N[14],N[15]=N[3]*z+N[7]*t+N[11]*Z+N[15]}},Qi=function($,T){if(T){var B=T[0],F=T[1],b=T[2];$[0]=$[0]*B,$[1]=$[1]*B,$[2]=$[2]*B,$[3]=$[3]*B,$[4]=$[4]*F,$[5]=$[5]*F,$[6]=$[6]*F,$[7]=$[7]*F,$[8]=$[8]*b,$[9]=$[9]*b,$[10]=$[10]*b,$[11]=$[11]*b}},tq=function(t,k,h){var C=k[0],S=k[1],M=k[2],b=k[3],Z=k[4],V=k[5],p=k[6],c=k[7],v=k[8],m=k[9],P=k[10],N=k[11],L=k[12],s=k[13],U=k[14],E=k[15],G=h[0],q=h[1],Q=h[2],u=h[3];return t[0]=G*C+q*Z+Q*v+u*L,t[1]=G*S+q*V+Q*m+u*s,t[2]=G*M+q*p+Q*P+u*U,t[3]=G*b+q*c+Q*N+u*E,G=h[4],q=h[5],Q=h[6],u=h[7],t[4]=G*C+q*Z+Q*v+u*L,t[5]=G*S+q*V+Q*m+u*s,t[6]=G*M+q*p+Q*P+u*U,t[7]=G*b+q*c+Q*N+u*E,G=h[8],q=h[9],Q=h[10],u=h[11],t[8]=G*C+q*Z+Q*v+u*L,t[9]=G*S+q*V+Q*m+u*s,t[10]=G*M+q*p+Q*P+u*U,t[11]=G*b+q*c+Q*N+u*E,G=h[12],q=h[13],Q=h[14],u=h[15],t[12]=G*C+q*Z+Q*v+u*L,t[13]=G*S+q*V+Q*m+u*s,t[14]=G*M+q*p+Q*P+u*U,t[15]=G*b+q*c+Q*N+u*E,t},Om=function(v,L,s,Y){var x,w,A,C,X,$,e,c,B,a,j=L[0],W=L[1],I=L[2],p=Y[0],u=Y[1],T=Y[2],D=s[0],O=s[1],d=s[2];return g(j-D)<gh&&g(W-O)<gh&&g(I-d)<gh?xj(v):(e=j-D,c=W-O,B=I-d,a=1/k(e*e+c*c+B*B),e*=a,c*=a,B*=a,x=u*B-T*c,w=T*e-p*B,A=p*c-u*e,a=k(x*x+w*w+A*A),a?(a=1/a,x*=a,w*=a,A*=a):(x=0,w=0,A=0),C=c*A-B*w,X=B*x-e*A,$=e*w-c*x,a=k(C*C+X*X+$*$),a?(a=1/a,C*=a,X*=a,$*=a):(C=0,X=0,$=0),v[0]=x,v[1]=C,v[2]=e,v[3]=0,v[4]=w,v[5]=X,v[6]=c,v[7]=0,v[8]=A,v[9]=$,v[10]=B,v[11]=0,v[12]=-(x*j+w*W+A*I),v[13]=-(C*j+X*W+$*I),v[14]=-(e*j+c*W+B*I),v[15]=1,v)},ae=function(_,T,t,S,D){var U=1/f(T/2),x=1/(S-D);return _[0]=U/t,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=U,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=(D+S)*x,_[11]=-1,_[12]=0,_[13]=0,_[14]=2*D*S*x,_[15]=0,_},ef=function(E,Z,e,b,N,J,H){var t=1/(Z-e),Q=1/(b-N),s=1/(J-H);return E[0]=-2*t,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*Q,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*s,E[11]=0,E[12]=(Z+e)*t,E[13]=(N+b)*Q,E[14]=(H+J)*s,E[15]=1,E},Jf=function(A,W){return Om(W?W:jl(),A._eye,A._center,A._up)},tf=function(t){var n=t.getAspect(),w=t._near,$=t._far,M=jl();if(t._ortho){var V=t._orthoWidth/2,R=V/n;ef(M,-V,V,-R,R,w,$)}else ae(M,t._fovy,n,w,$);return M},dk=function(D,z){if(!D)return t;var H=0,E=1,e=2,b=[],Q=0,F=D.length,l=F/3;if(z){for(;F>Q;Q++)b[Q]=0;for(Q=0;Q<z.length;Q+=3){var X=[],B=[],o=[];X[H]=D[3*z[Q+1]+H]-D[3*z[Q]+H],X[E]=D[3*z[Q+1]+E]-D[3*z[Q]+E],X[e]=D[3*z[Q+1]+e]-D[3*z[Q]+e],B[H]=D[3*z[Q+2]+H]-D[3*z[Q+1]+H],B[E]=D[3*z[Q+2]+E]-D[3*z[Q+1]+E],B[e]=D[3*z[Q+2]+e]-D[3*z[Q+1]+e],o[H]=X[E]*B[e]-X[e]*B[E],o[E]=X[e]*B[H]-X[H]*B[e],o[e]=X[H]*B[E]-X[E]*B[H];for(var P=0;3>P;P++)b[3*z[Q+P]+H]+=o[H],b[3*z[Q+P]+E]+=o[E],b[3*z[Q+P]+e]+=o[e]}}else for(Q=0;l>Q;Q+=3){var X=[],B=[],o=[];X[H]=D[3*(Q+1)+H]-D[3*Q+H],X[E]=D[3*(Q+1)+E]-D[3*Q+E],X[e]=D[3*(Q+1)+e]-D[3*Q+e],B[H]=D[3*(Q+2)+H]-D[3*(Q+1)+H],B[E]=D[3*(Q+2)+E]-D[3*(Q+1)+E],B[e]=D[3*(Q+2)+e]-D[3*(Q+1)+e],o[H]=X[E]*B[e]-X[e]*B[E],o[E]=X[e]*B[H]-X[H]*B[e],o[e]=X[H]*B[E]-X[E]*B[H];for(var P=0;3>P;P++)b[3*(Q+P)+H]=o[H],b[3*(Q+P)+E]=o[E],b[3*(Q+P)+e]=o[e]}for(Q=0;F>Q;Q+=3){var $=[];$[H]=b[Q+H],$[E]=b[Q+E],$[e]=b[Q+e];var S=k($[H]*$[H]+$[E]*$[E]+$[e]*$[e]);0===S&&(S=gh),$[H]=$[H]/S,$[E]=$[E]/S,$[e]=$[e]/S,b[Q+H]=$[H],b[Q+E]=$[E],b[Q+e]=$[e]}return new ab(b)},gs=function(e,l,f){if(f||(f=e.createTexture()),l){var D=e.TEXTURE_2D,N=e.LINEAR,o=e.REPEAT,T=e.CLAMP_TO_EDGE,k=e.TEXTURE_MIN_FILTER;bm(e,f),e.texImage2D(D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),Rm(e,e.TEXTURE_MAG_FILTER,N),pf(l.width)&&pf(l.height)?(Rm(e,e.TEXTURE_WRAP_S,o),Rm(e,e.TEXTURE_WRAP_T,o),Rm(e,k,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(D)):(Rm(e,e.TEXTURE_WRAP_S,T),Rm(e,e.TEXTURE_WRAP_T,T),Rm(e,k,N)),bm(e,t)}return f},yj=function(Q){Q._gl&&Q._prg&&(Q._gl.deleteProgram(Q._prg),Q._prg=t)},Op=function(o,Z,E,M){var F=o.createShader(E);return o.shaderSource(F,M),o.compileShader(F),o.attachShader(Z,F),F},us=function(V){return V.createBuffer()},bm=function(G,V){G.bindTexture(G.TEXTURE_2D,V)},Ac=function(Z,V){Z.bindFramebuffer(Z.FRAMEBUFFER,V)},Rm=function(R,z,D){R.texParameteri(R.TEXTURE_2D,z,D)},Mc=function(v,z){if(z){var z=xr(z);v.clearColor(z[0],z[1],z[2],z[3])}},Lg=function(Y,r){Bb(Y,r.uFix,!0),Um(Y,r.aNormal)},Xh=function(i,h){Bb(i,h.uFix,!1),Dd(i,h.aNormal)},Fl=function(o,T,q,K,j,d,k,a){o._picking||(q?(Bb(o,T.uBlend,!0),Bb(o,T.uBlendColor,q)):Bb(o,T.uBlend,!1),Bb(o,T.uLight,K==t?!0:K),Ud(j)&&1!==j&&Bb(o,T.uPartOpacity,j),Bb(o,T.uReverseFlip,d==t?!1:d),Bb(o,T.uFixPickReverseColor,k||gl)),a?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE)},rn=function(g,m){g._picking||Bb(g,m.uPartOpacity,1)},Nd=function(Y,C,y,T,X,B,S,v){if(y){Bb(Y,C.uTexture,!0),Bb(Y,C.uDiscardSelectable,ed(T)?T:!0),Dd(Y,C.aUv),en(Y,X,B,C.aUv,2),Y.activeTexture(Y.TEXTURE0),bm(Y,y),Y.uniform1i(C.uSampler,0);var e=[0,0,1,1];S&&(e[0]=S[0],e[1]=S[1]),v&&(e[2]=v[0],e[3]=v[1]),Bb(Y,C.uOffsetScale,e)}},em=function(R,g,q){q&&(bm(R,t),Um(R,g.aUv),Bb(R,g.uTexture,!1))},Ej=function(C,u,b,P,U,s){b&&!w&&C.lineWidth(b),P&&!C._picking&&Bb(C,u.uFixPickReverseColor,P),U&&en(C,U,s,u.aPosition)},qf=function(Y,S,p,$){Zl&&($=Y[Zl]),Y.drawArrays($==t?Y.TRIANGLES:$,S,p)},Dj=function(c,S,W,v){Zl&&(v=c[Zl]),c.drawElements(v==t?c.TRIANGLES:v,W,c.UNSIGNED_SHORT,S==t?0:2*S)},en=function(x,i,p,m,I){var E=x.ARRAY_BUFFER;x.bindBuffer(E,i),p&&x.bufferData(E,p,x.STATIC_DRAW),m!=t&&x.vertexAttribPointer(m,I?I:3,x.FLOAT,!1,0,0)},Zn=function(b,U,w){var E=b.ELEMENT_ARRAY_BUFFER;b.bindBuffer(E,U),w&&b.bufferData(E,w,b.STATIC_DRAW)},Bb=function(L,X,Z){if(Z!=t&&X!=t){Z=xr(Z);var O=Z.length;3===O?L.uniform3fv(X,Z):4===O?L.uniform4fv(X,Z):16===O?L.uniformMatrix4fv(X,!1,Z):ed(Z)?L.uniform1i(X,Z?1:0):2===O?L.uniform2fv(X,Z):L.uniform1f(X,Z)}},Dd=function(l,q){q!=t&&q>=0&&l.enableVertexAttribArray(q)},Um=function(f,I){I!=t&&I>=0&&f.disableVertexAttribArray(I)},Ei=function(r,a){var S=r.getGL(),v=r._prg;r._mvMatrix=r._stack.pop(),a&&(Bb(S,v.uMVMatrix,r._mvMatrix),r._nMatrix=a,Bb(S,v.uNMatrix,a))},hb=function(f,T){return T||(T=jl()),Tn(T,f),Lr(T),Nb(T),T},Ef=function(n,w){var j=n.getGL(),i=n._prg,r=n._mvMatrix;w&&(n._stack.push(pn(r)),tq(r,r,w)),Bb(j,i.uMVMatrix,r),Bb(j,i.uNMatrix,hb(r,n._nMatrix))},ys=function(C,_,n,h,d,k){if(n){if(h){var p=n.value++,$=[(255&p>>24)/255,(255&p>>16)/255,(255&p>>8)/255,(255&p)/255];n[p]={data:d,part:k}}else $=Jq;return Bb(C,_.uFixPickReverseColor,$),$}},Rk=function(){var x={center:function(f,b,o,Y,v){var m=b[1]/2,S={x:-b[0]/2,y:m,width:b[0],height:b[1]},C=kl(f,S,o);return[C.x+Y,2*m-C.y-v,tn()]},front:function(T,y,$,k,N){var C=y[1]/2,X={x:-y[0]/2,y:C,width:y[0],height:y[1]},q=kl(T,X,$);return[q.x+k,2*C-q.y-N,y[2]/2+tn()]},back:function(q,o,r,A,V){var h=o[0]/2,C=o[1]/2,X={x:h,y:C,width:o[0],height:o[1]},d=kl(q,X,r);return[2*h-d.x-A,2*C-d.y-V,-o[2]/2-tn()]},left:function(P,M,t,n,l){var Z=M[1]/2,D={x:-M[2]/2,y:Z,width:M[2],height:M[1]},z=kl(P,D,t);return[-M[0]/2-tn(),2*Z-z.y-l,z.x+n]},right:function(O,c,F,Q,x){var X=c[2]/2,l=c[1]/2,$={x:X,y:l,width:c[2],height:c[1]},U=kl(O,$,F);return[c[0]/2+tn(),2*l-U.y-x,2*X-U.x-Q]},top:function(C,q,w,J,h){var x={x:-q[0]/2,y:-q[2]/2,width:q[0],height:q[2]},H=kl(C,x,w);return[H.x+J,q[1]/2+tn(),H.y+h]},bottom:function(D,Q,e,N,k){var u=Q[2]/2,F={x:-Q[0]/2,y:u,width:Q[0],height:Q[2]},z=kl(D,F,e);return[z.x+N,-Q[1]/2-tn(),2*u-z.y-k]}};return function(V,h,A,W,Y,M){return x[W](V,h,A,Y||0,M||0)}}(),te=function(Q,t,g,S,O,w,F,A,l,E){if(O&&(t[0]+=O[0],t[1]+=O[1],t[2]+=O[2]),Rq(Q,g),A){var v=jl();if(El(v,l,E),Ko(t,v),Rq(Q,t),Q.auto=A,Q.pos=Ko([0,0,0],Q),w){var I=Q.mat2=jl();El(I,w,F)}}else El(Q,l,E),Rq(Q,t),S===s?kd(Q,-P):S===c?kd(Q,P):S===y?Cg(Q,-P):S===a?Cg(Q,P):S===z&&kd(Q,R),El(Q,w,F);return Q},Ym=function(V,l){var f=l.auto,q=l.mat2,U=V.gv;if(f){var r=id(V.gv.getEye(),l.pos),X=jl();kd(X,R/2+W(-r[2],r[0])),"y"!==f&&Cg(X,-W(r[1],k(r[2]*r[2]+r[0]*r[0]))),q&&tq(X,X,q),X=tq(jl(),l,X),Ef(U,X)}else Ef(U,l)},ke=function(F,j,L,V,r){var H=F.s,Q=F.gv,I=Q.getGL(),E=Q._prg,B=Q._buffer,h=Q._texture;gs(I,vb,h),Ym(F,L),Fl(I,E,H(j+".blend"),H(j+".light"),H(j+".opacity"),H(j+".reverse.flip"),H(j+".reverse.color"),H(j+".reverse.cull")),Nd(I,E,h,r,B.uv,Cl),en(I,B.vs,V,E.aPosition),en(I,B.ns,Gb,E.aNormal),Zn(I,B.is,Uc),Dj(I,0,Uc.length),em(I,E,h),rn(I,E),Ei(Q)},ym=function(a,u,K){var N=a.gv,d=a.data,r=a[u]={blend:N.getBodyColor(d)||N.getFaceBlend(d,u),light:N.getFaceLight(d,u),color:N.getFaceColor(d,u),opacity:N.getFaceOpacity(d,u),transparent:N.getFaceTransparent(d,u),reverseFlip:N.getFaceReverseFlip(d,u),reverseColor:N.getFaceReverseColor(d,u),reverseCull:N.getFaceReverseCull(d,u),texture:N.getFaceImage(d,u),discardSelectable:N.getFaceDiscardSelectable(d,u)};if("csg"!==u){r.uv=N.getFaceUv(d,u)||K&&K[u+"Uv"],r.uvScale=N.getFaceUvScale(d,u)||K&&K[u+"UvScale"],r.uvOffset=N.getFaceUvOffset(d,u)||K&&K[u+"UvOffset"];var C=N.getFaceMat(d,u);C&&(r.mat=Gk(d,C))}return r},or=function(l,b,m,U,W){if(U){if(!W(U.transparent))return;var e=l.data,y=l.gv,h=y._buffer,v=y.getTexture(U.texture,e);Nd(b,m,v,U.discardSelectable,h.uv,U.tuv,U.uvOffset,U.uvScale),Fl(b,m,U.blend,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),Bb(b,m.uDiffuse,U.color),en(b,h.vs,U.vs,m.aPosition),en(b,h.ns,U.ns,m.aNormal),qf(b,0,U.vs.length/3),rn(b,m),em(b,m,v)}},po=function(l,E,w,x,T,a){var L,v,O,U,i,z,N,h,m,S,Z,V=[x-E,T-w],$=l?l.length:0;for(O=0;$>O;O++){for(U=2,L=l[O],i=L[0],z=L[1];U+1<L.length;){if(N=L[U],h=L[U+1],v=Af(E,w,x,T,i,z,N,h,!0)){m=[N-i,h-z],S=Uk(m),m[0]/=S,m[1]/=S,S=oi(V,m),S=S>0?a:-a,Z=[m[0]*S,m[1]*S];break}i=N,z=h,U+=2}if(Z)break}if(Z)for(x=E+Z[0],T=w+Z[1],O=0;$>O;O++)for(U=2,L=l[O],i=L[0],z=L[1];U+1<L.length;){if(N=L[U],h=L[U+1],v=Af(E,w,x,T,i,z,N,h,!0))return[0,0];i=N,z=h,U+=2}return Z?Z:[x-E,T-w]},ve=p.graph3d={},Mq=function(E,p,e){Ib(J+".graph3d."+E,p,e)},wi="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~!gjeof$!~~<*^j]opjujtpQupqTw!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEupqTw<**1/2!-^j]sfuofDupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQupqTw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~<**1/2!-^j]opjujtpQuojpQv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQuojpQw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<*opjujtpQsje!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEsjEw<**1/2!-1/1!-1/1!-1/1)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQsjEv)5dfw!+!yjsubNxfjWv)4dfw!>!opjujtpQsje!4dfw|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]sfuofDupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]opjujtpQsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ",Ui="~~<eJ!>!spmpDhbsG`mh!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTw)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEw)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~<1/2!>!b/spmpDwv|ftmf~<esbdtje|*5/1!=!b/spmpDwv)gj|ftmf~~<esbdtje|*1/1!>>!b/spmpDwv)gj|*uofsbqtobsUv)gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUv!mppc!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
op(b,{setBatchInfo:function(C,O){xg[C]=O},getBatchInfo:function(A){return xg[A]}},!0);var yr=[1,1,1],lh=[1,0,0,0,0,1,0,1,1,1,1,0],Lm=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],oj=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],ec=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ds=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],rp=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Jk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],zm=function(f,M){Uo(f,M),Cf(f,M,"_wireframeModelMap","_wireframeIndexMap"),Cf(f,M,"_polylineModelMap","_polylineIndexMap")},Uo=function(M,D){if(D){var h,_,W=D._id,Y=M._batchModelMap,s=M._batchIndexMap,o=s[W];if(o){_=o.batch,h=Y[_];var G=o.begin,v=o.size,R=3*G,A=3*v,t=4*G,x=4*v,q=h.vs,N=h.uv,d=h.cs,T=h.bs,z=h.rs,Q=h.ds,V=o.index;if(h.invalidate=!0,delete s[W],Q.splice(V,1),Ii(Q))delete Y[_];else{for(;V<Q.length;V++)o=s[Q[V]._id],o.index--,o.begin-=v;q.splice(R,A),h.ns.splice(R,A),h.ps.splice(t,x),N&&N.splice(2*G,2*v),d&&d.splice(t,x),T&&T.splice(R,A),z&&z.splice(G,v)}}}else M._batchIndexMap={},M._batchModelMap={}},Cf=function(v,o,w,q){if(o){var P,s,l=o._id,W=v[w],$=v[q],L=$[l];if(L){s=L.batch,P=W[s];var t=L.begin,I=L.size,U=3*t,G=3*I,E=4*t,J=4*I,K=P.ds,j=L.index;if(P.invalidate=!0,delete $[l],K.splice(j,1),Ii(K))delete W[s];else{for(;j<K.length;j++)L=$[K[j]._id],L.index--,L.begin-=I;P.vs.splice(U,G),P.cs.splice(E,J),P.ps.splice(E,J),P.ls&&P.ls.splice(t,I)}}}else v[w]={},v[q]={}},jd=function(W,V,T,D){if(!D)return t;var N=V[D];if(!N){var f=xg[D]||$i,h=f.image?[]:t;N=V[D]={vs:[],ns:[],uv:h,cs:h?t:f.color?t:[],bs:f.blend?[]:t,ps:[],rs:f.brightness?[]:t,ds:[]}}return N.invalidate=!0,W[T._id]={index:N.ds.length,begin:N.vs.length/3,batch:D},N.ds.push(T),N},Gr=function(z,K){return K!=t&&1!==K?[z[0]*K,z[1]*K,z[2]*K,z[3]]:z},we=function(X,g,U){var I=X.getBrightness(g),r=xr(U.color||"white"),W=r[3]<1,A=Math.ceil(U.width)||1,E=(W?"T":"O")+A,P=X._wireframeIndexMap,t=X._wireframeModelMap,d=t[E];d||(d=t[E]={vs:[],cs:[],ps:[],ds:[],T:W,W:A}),d.invalidate=!0;var Y=d.vs,x=d.cs,D=d.ds,m=P[g._id]={index:D.length,begin:Y.length/3,batch:E};D.push(g),dj(Y,Gk(g,U.mat),U.short?Cs:mq);var J=m.size=Y.length/3-m.begin;ap(x,Gr(r,I),J)},gd=function(m,G,p,i,B,e,S,g,j){var l=m.getBrightness(G);l==t&&(l=1);var T=Gr(xr(i),l),X=T[3]<1;e=Math.ceil(e)||1;var I=(X?"T":"O")+e;if(S){var x=S[0],d=(S[1]||x)+x;I+="-"+x+"-"+d,j&&(I+="-"+Xc(j)+"-"+l,j=Gr(xr(j),l))}var q=m._polylineIndexMap,E=m._polylineModelMap,F=E[I];F||(F=E[I]={vs:[],cs:[],ps:[],ds:[],ls:S?[]:t,T:X,W:e},S&&(F.D=x,F.G=d,F.A=j)),F.invalidate=!0;var Y,V=F.vs,J=F.cs,o=F.ds,M=F.ls,f=q[G._id]={index:o.length,begin:V.length/3,batch:I};o.push(G),jb(V,p);var W,y=f.size=V.length/3-f.begin,H=p.length,s=0,K=[];if(S||B)for(Y=0;H>Y;Y+=6)W=Uk([p[Y],p[Y+1],p[Y+2]],[p[Y+3],p[Y+4],p[Y+5]]),K.push(W),s+=W;if(s&&B){var v,a=Gr(xr(B),l),n=[a[0]-T[0],a[1]-T[1],a[2]-T[2],a[3]-T[3]],u=0;for(Y=0;H>Y;Y+=6)v=u/s,ap(J,[T[0]+n[0]*v,T[1]+n[1]*v,T[2]+n[2]*v,T[3]+n[3]*v],1),u+=K[Y/6],v=u/s,ap(J,[T[0]+n[0]*v,T[1]+n[1]*v,T[2]+n[2]*v,T[3]+n[3]*v],1)}else ap(J,T,y);if(S)for(u=g||0,Y=0;H>Y;Y+=6)M.push(u),u+=K[Y/6],M.push(u)},Xo=function(D,c,Z){if(c)for(var W=4*c.begin,b=Z[c.batch].ps,P=0;P<c.size;P++)b[W++]=D[0],b[W++]=D[1],b[W++]=D[2],b[W++]=D[3]},nj=function(h,L){var D=L+["32"],G=h[L],l=h[D];G?l&&l.length===G.length?l.set(G):h[D]=new ab(G):delete h[D]},Rj=function(H,k,h,$,M,e,y,V,N){if(fd(h))h.forEach(function(t){Rj(H,k,t,$,M,e,y,V,N)});else if(ii(h))Rj(H,k,rk($,h),$,M,e,y,V,N);else if(me(h)){var Y,p=an(h.mat,k,H),q=an(h.s3,k,H),J=an(h.t3,k,H),G=an(h.r3,k,H);if((q||G||J||p)&&(Y=Hn(p,q,G,an(h.rotationMode,k,H),J),e.push(Y)),h.shape3d)Rj(H,k,h.shape3d,$,M,e,y,V,h);else{N=N||$i;var Q=e[0],I=e.length,j=$("shape3d.color",h.color,N.color);if(M||(M=$("shape3d.blend",h.blend,N.blend)),I>1){Q=pn(Q);for(var f=1;I>f;f++)tq(Q,Q,e[f])}h.vs&&$(ai,h.visible,N.visible)&&As(Q,y,V,h.vs,h.uv,h.is,M,j),h.top_vs&&$(_q,h.topVisible,N.topVisible)&&As(Q,y,V,h.top_vs,h.top_uv,h.top_is,M,$("shape3d.top.color",h.topColor,N.topColor)||j),h.bottom_vs&&$(Qp,h.bottomVisible,N.bottomVisible)&&As(Q,y,V,h.bottom_vs,h.bottom_uv,h.bottom_is,M,$("shape3d.bottom.color",h.bottomColor,N.bottomColor)||j),h.from_vs&&$(Jo,h.fromVisible,N.fromVisible)&&As(Q,y,V,h.from_vs,h.from_uv,h.from_is,M,$("shape3d.from.color",h.fromColor,N.fromColor)||j),h.to_vs&&$(Ih,h.toVisible,N.toVisible)&&As(Q,y,V,h.to_vs,h.to_uv,h.to_is,M,$("shape3d.to.color",h.toColor,N.toColor)||j)}Y&&e.pop()}},As=function(u,H,c,Y,X,y,N,R){var e,h=H.cs,M=H.uv,B=H.bs;if(y){e=y.length;for(var o=0;e>o;o++){var z=y[o];dj(c,u,[Y[3*z],Y[3*z+1],Y[3*z+2]]),M&&jb(M,[X[2*z],X[2*z+1]])}}else e=Y.length/3,dj(c,u,Y),M&&jb(M,X);h&&ap(h,R,e),B&&(N?_m(B,N,e):jb(B,yr,e))},Nq=function(f,l,t,e){var A=[];e?Rj(f.gv,f.data,e,f.s,f.getBodyColor(),[l],t,A):(mr(f,s,l,t,A),mr(f,c,l,t,A),mr(f,v,l,t,A),mr(f,z,l,t,A),mr(f,y,l,t,A),mr(f,a,l,t,A),mr(f,"csg",l,t,A)),A.length&&(jb(t.vs,A),jb(t.ns,dk(A)))},mr=function(N,W,w,z,f){var V=N[W];if(V){var J=V.tuv;if(J){var o,C,g,U,y=V.uvScale,a=V.uvOffset;if(y)for(o=J.length,C=y[0],g=y[1],U=0;o>U;U+=2)J[U]*=C,J[U+1]*=g;if(a)for(o=J.length,C=a[0],g=a[1],U=0;o>U;U+=2)J[U]+=C,J[U+1]+=g}As(w,z,f,V.vs,J,t,V.blend,V.color)}},Ki=function(r,M,Y,k,o,e,O,K){var f,R=Y.cs,S=Y.uv,W=Y.bs;if(r.getFaceVisible(M,e)){var I=r.getFaceMat(M,e);if(I&&(o=Gk(M,I)),dj(O,o,K),R&&ap(R,r.getFaceColor(M,e),6),S){var D=r.getFaceUv(M,e)||k[e+"Uv"],H=r.getFaceUvScale(M,e)||k[e+"UvScale"],g=r.getFaceUvOffset(M,e)||k[e+"UvOffset"];D=D?[D[6],D[7],D[0],D[1],D[2],D[3],D[2],D[3],D[4],D[5],D[6],D[7]]:lh;var z=D[0],h=D[1],P=D[2],y=D[3],x=D[4],i=D[5],N=D[6],$=D[7],V=D[8],_=D[9],q=D[10],C=D[11];if(H){var t=H[0],c=H[1];z*=t,h*=c,P*=t,y*=c,x*=t,i*=c,N*=t,$*=c,V*=t,_*=c,q*=t,C*=c}if(g){var G=g[0],T=g[1];z+=G,h+=T,P+=G,y+=T,x+=G,i+=T,N+=G,$+=T,V+=G,_+=T,q+=G,C+=T}S.push(z,h,P,y,x,i,N,$,V,_,q,C)}W&&(f=r.getBodyColor(M)||r.getFaceBlend(M,e),f?_m(W,f,6):jb(W,yr,6))}},Pc=function(G,w,V,S){var i=G.getGL(),R=G._prg,U=G._buffer;if(!bo(w)){Ef(G),Lg(i,R);for(var u in w){var Y=w[u];if(!(S&&!Y.T||!S&&Y.T)){Y.invalidate?(Y.invalidate=!1,nj(Y,"vs"),nj(Y,"cs"),nj(Y,"ls"),nj(Y,"ps")):V&&nj(Y,"ps");var M=Y.vs32,L=V?Y.ps32:Y.cs32;Ej(i,R,Y.W,t,U.vs,M);var T=Y.D,c=!G._dashDisabled&&T;c&&(Bb(i,R.uDash,!0),Bb(i,R.uDashDistance,T),Bb(i,R.uDashGapDistance,Y.G),Dd(i,R.aLineDistance),en(i,U.lineDistance,Y.ls32,R.aLineDistance,1),Bb(i,R.uDiffuse,Y.A||ye));var e=!G._batchColorDisabled;e&&(Bb(i,R.uBatchColor,!0),Dd(i,R.aBatchColor),en(i,U.batchColor,L,R.aBatchColor,4)),qf(i,0,M.length/3,i.LINES),e&&(Bb(i,R.uBatchColor,!1),Um(i,R.aBatchColor)),c&&(Bb(i,R.uDash,!1),Um(i,R.aLineDistance))}}Xh(i,R)}},yh=function(f,n,O){var w,D,u,M,X,V,B,c,$,q,W,N=f.getGL(),K=f._prg,b=f._buffer,j=f._batchModelMap;if(!bo(j)){Ef(f);for(w in j)if(D=xg[w]||$i,!(O&&!D.transparent||!O&&D.transparent)&&(u=j[w],n||!D.transparentMask)){var e=O&&D.autoSort!==!1&&(f._eyeChanged||u.invalidate);if(u.invalidate?(u.invalidate=!1,nj(u,"vs"),nj(u,"ns"),nj(u,"cs"),nj(u,"rs"),nj(u,"ps"),nj(u,"bs"),nj(u,"uv")):n&&nj(u,"ps"),X=u.vs32,V=n?u.ps32:u.cs32,$=u.uv32,B=u.bs32,c=u.rs32,W=X.length/3,e&&(u.is=$n(X,f.getEye())),W){M=D.light,q=f.getTexture(D.image),Fl(N,K,t,D.light,D.opacity,D.reverseFlip,D.reverseColor,D.reverseCull),V?f._batchColorDisabled||(Bb(N,K.uBatchColor,!0),Dd(N,K.aBatchColor),en(N,b.batchColor,V,K.aBatchColor,4)):Bb(N,K.uDiffuse,D.color);var A=B&&!f._batchBlendDisabled;A&&(Bb(N,K.uBatchBlend,!0),Dd(N,K.aBatchBlend),en(N,b.batchBlend,B,K.aBatchBlend));var a=c&&!f._batchBrightnessDisabled;a&&(Bb(N,K.uBatchBrightness,!0),Dd(N,K.aBatchBrightness),en(N,b.batchBrightness,c,K.aBatchBrightness,1)),$&&Nd(N,K,q,D.discardSelectable,b.uv,$,D.uvOffset,D.uvScale),en(N,b.vs,X,K.aPosition),en(N,b.ns,u.ns32,K.aNormal),u.is?(Zn(N,b.is,u.is),Dj(N,0,W)):qf(N,0,W),$&&em(N,K,q),V&&!f._batchColorDisabled&&(Bb(N,K.uBatchColor,!1),Um(N,K.aBatchColor)),A&&(Bb(N,K.uBatchBlend,!1),Um(N,K.aBatchBlend)),a&&(Bb(N,K.uBatchBrightness,!1),Um(N,K.aBatchBrightness)),rn(N,K)}}}},$n=function(w,u){for(var c=w.length/3,p=new Array(c),J=c/3,C=new Array(J),P=0;J>P;P++)C[P]=P;C.sort(function(I,U){var i=9*I,K=[(w[i]+w[i+3]+2*w[i+6])/4,(w[i+1]+w[i+4]+2*w[i+7])/4,(w[i+2]+w[i+5]+2*w[i+8])/4];i=9*U;var d=[(w[i]+w[i+3]+2*w[i+6])/4,(w[i+1]+w[i+4]+2*w[i+7])/4,(w[i+2]+w[i+5]+2*w[i+8])/4],r=Uk(u,K)-Uk(u,d);return r>0?-1:0>r?1:0});for(var P=0;J>P;P++){var q=3*P,$=3*C[P];p[q]=$,p[q+1]=$+1,p[q+2]=$+2}return new km(p)},Cl=new ab([0,0,0,1,1,1,1,0]),Gb=new ab([0,0,1,0,0,1,0,0,1,0,0,1]),Uc=new km([0,1,2,2,3,0]),jj=new ab([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Fq=new km([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Sh=new ab([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Wh=new ab([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),vd=dk(jj,Fq),mq=(new ab([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new km([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),Cs=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Rb=function(Z,r,Q,f,F,S){S=S||16,Z=Z||16,r=r||0,Q=Q||Z;var A,e,$,y,q,H,G,M,a=.5,i=[],p=[],v=x/Z,N=R/S;for(A=0;S>A;A++)for(q=A+1,y=A*N,M=q*N,e=r;Q>e;e++)H=e+1,$=e*v,G=H*v,i.push(a*E(y)*_($),a*_(y),-a*E(y)*E($),a*E(M)*_(G),a*_(M),-a*E(M)*E(G),a*E(y)*_(G),a*_(y),-a*E(y)*E(G),a*E(y)*_($),a*_(y),-a*E(y)*E($),a*E(M)*_($),a*_(M),-a*E(M)*E($),a*E(M)*_(G),a*_(M),-a*E(M)*E(G)),p.push(e/Z,A/S,H/Z,q/S,H/Z,A/S,e/Z,A/S,e/Z,q/S,H/Z,q/S);if(f)for($=r*v,A=0;S>A;A++)q=A+1,y=A*N,M=q*N,i.push(0,0,0,a*E(M)*_($),a*_(M),-a*E(M)*E($),a*E(y)*_($),a*_(y),-a*E(y)*E($)),p.push(0,.5,r/Z,q/S,r/Z,A/S);if(F)for($=Q*v,A=0;S>A;A++)q=A+1,y=A*N,M=q*N,i.push(0,0,0,a*E(y)*_($),a*_(y),-a*E(y)*E($),a*E(M)*_($),a*_(M),-a*E(M)*E($)),p.push(1,.5,Q/Z,A/S,Q/Z,q/S);return{vs:i,uv:p}},zi=function(K,B,I){K=K||.17,B=B||12,I=I||18,0>K?K=0:K>.25&&(K=.25);var Z,Q,r,q,U,o,p,H=.5,f=[],X=[],N=[],Y=x/I,$=x/B,W=H-K;for(Q=0;B>=Q;Q++)for(q=-R+Q*$,o=_(q),U=E(q),Z=0;I>=Z;Z++)r=Z*Y,p=W+K*o,f.push(_(r)*p,U*K,-E(r)*p),X.push(Z/I,1-Q/B);for(Q=0;B>Q;Q++){var y=Q*(I+1),h=(Q+1)*(I+1);for(Z=0;I>Z;Z++)N.push(y+Z,h+Z+1,h+Z,y+Z,y+Z+1,h+Z+1)}return{vs:f,uv:X,is:N}},Cd=function(q,p,o,K,Y,e,X){X=X||12,q=q||18,p=p||0,o=o||q,e=e||.17,0>e?e=0:e>.25&&(e=.25);var s,u,l,O,I,M,g,m,t,V,v=.5,D=[],k=[],W=x/q,S=x/X,c=v-e;for(l=0;X>l;l++)for(O=l+1,g=-R+l*S,m=-R+O*S,s=p;o>s;s++)u=s+1,I=s*W,M=u*W,t=c+e*_(g),V=c+e*_(m),D.push(_(I)*t,E(g)*e,-E(I)*t,_(M)*t,E(g)*e,-E(M)*t,_(M)*V,E(m)*e,-E(M)*V,_(I)*t,E(g)*e,-E(I)*t,_(M)*V,E(m)*e,-E(M)*V,_(I)*V,E(m)*e,-E(I)*V),k.push(s/q,1-l/X,u/q,1-l/X,u/q,1-O/X,s/q,1-l/X,u/q,1-O/X,s/q,1-O/X);if(K){var d=[],P=[];for(l=0;X>l;l++)O=l+1,g=-R+l*S,m=-R+O*S,I=p*W,t=c+e*_(g),V=c+e*_(m),d.push(_(I)*t,E(g)*e,-E(I)*t,_(I)*V,E(m)*e,-E(I)*V,_(I)*c,0,-E(I)*c),P.push(.5+.5*_(g),.5-.5*E(g),.5+.5*_(m),.5-.5*E(m),.5,.5)}if(Y){var r=[],h=[];for(l=0;X>l;l++)O=l+1,g=-R+l*S,m=-R+O*S,I=o*W,t=c+e*_(g),V=c+e*_(m),r.push(_(I)*t,E(g)*e,-E(I)*t,_(I)*c,0,-E(I)*c,_(I)*V,E(m)*e,-E(I)*V),h.push(.5-.5*_(g),.5-.5*E(g),.5,.5,.5-.5*_(m),.5-.5*E(m))}return{vs:D,uv:k,from_vs:d,from_uv:P,to_vs:r,to_uv:h}},Ne=function(X,y){for(var J,D,t,v=.5,c=16,C=[],F=[],Q=[],O=x/c,i=0;c>=i;i++)J=i*O,D=_(J)*v,t=E(J)*v,C.push(D,-v,t,D,v,t),F.push(1-i/c,1,1-i/c,0);for(i=0;c>i;i++)Q.push(2*i,2*i+1,2*i+3,2*i,2*i+3,2*i+2);if(y){var m=[],h=[],B=[];for(m.push(0,-v,0),h.push(.5,.5),i=0;c>=i;i++)J=i*O,D=_(J),t=E(J),m.push(D*v,-v,-t*v),h.push(.5+.5*D,.5+.5*t);for(i=0;c>i;i++)B.push(0,i+2,i+1)}if(X){var R=[],n=[],U=[];for(R.push(0,v,0),n.push(.5,.5),i=0;c>=i;i++)J=i*O,D=_(J),t=E(J),R.push(D*v,v,-t*v),n.push(.5+.5*D,.5-.5*t);for(i=0;c>i;i++)U.push(0,i+1,i+2)}return{vs:C,uv:F,is:Q,bottom_vs:m,bottom_uv:h,bottom_is:B,top_vs:R,top_uv:n,top_is:U}},zd=function(o,L,f,s,F,B,q){o=o||12,L=L||0,f=f||o;for(var Q,I,k,M,r,N,c,O,l=.5,u=[],y=[],H=x/o,G=L;f>G;G++)Q=G+1,I=G*H,k=Q*H,M=_(I)*l,r=E(I)*l,N=_(k)*l,c=E(k)*l,u.push(M,-l,-r,N,-l,-c,M,l,-r,N,-l,-c,N,l,-c,M,l,-r),y.push(G/o,1,Q/o,1,G/o,0,Q/o,1,Q/o,0,G/o,0);if(q){var D=[],A=[];for(G=L;f>G;G++)I=H*G,k=H*(G+1),M=_(I),r=E(I),N=_(k),c=E(k),D.push(M*l,-l,-r*l,0,-l,0,N*l,-l,-c*l),A.push(.5+.5*M,.5+.5*r,.5,.5,.5+.5*N,.5+.5*c)}if(B){var v=[],Z=[];for(G=L;f>G;G++)I=H*G,k=H*(G+1),M=_(I),r=E(I),N=_(k),c=E(k),v.push(M*l,l,-r*l,N*l,l,-c*l,0,l,0),Z.push(.5+.5*M,.5-.5*r,.5+.5*N,.5-.5*c,.5,.5)}return s&&(I=H*L,M=_(I)*l,r=E(I)*l,O=L/o,u.push(0,l,0,0,-l,0,M,-l,-r,M,-l,-r,M,l,-r,0,l,0),y.push(0,0,0,1,O,1,O,1,O,0,0,0)),F&&(I=H*f,M=_(I)*l,r=E(I)*l,O=f/o,u.push(0,-l,0,0,l,0,M,l,-r,M,l,-r,M,-l,-r,0,-l,0),y.push(1,1,1,0,O,0,O,0,O,1,1,1)),{vs:u,uv:y,bottom_vs:D,bottom_uv:A,top_vs:v,top_uv:Z}},vr=function(W,k,i,$,v){k=k||18,i=i||0,$=$==t?x:$,v=v==t?.5:v;for(var Y,L,z,B,C,A,g=[0,.5,.75,.875,.9375],T=[],u=[],m=[],M=$/k,V=0;V<g.length;V++){var r=0===V%2?0:.5;for(Y=0;k>=Y;Y++)L=(Y+r)*M+i,z=1-g[V],T.push(_(L)*v*z,-v+2*g[V]*v,-E(L)*v*z),u.push((Y+r)/k,z)}for(V=0;V<g.length-1;V++){var K=V*(k+1),U=(V+1)*(k+1);for(Y=0;k>Y;Y++)m.push(K+Y,U+Y+1,U+Y,K+Y,K+Y+1,U+Y+1)}for(A=T.length/3-(k+1),Y=0;k>Y;Y++)T.push(0,v,0),u.push((Y+.5)/k,0);for(Y=0;k>Y;Y++)m.push(A+Y,A+Y+1,A+(k+1)+Y);if(W){var d=[],X=[],y=[];for(d.push(0,-v,0),X.push(.5,.5),Y=0;k>=Y;Y++)L=Y*M+i,B=_(L),C=E(L),d.push(B*v,-v,-C*v),X.push(.5+.5*B,.5+.5*C);for(Y=0;k>Y;Y++)y.push(0,Y+2,Y+1)}return{vs:T,uv:u,is:m,bottom_vs:d,bottom_uv:X,bottom_is:y}},be=function(o,p,U,P,g,W){o=o||16,p=p||0,U=U||o;for(var G=.5,X=[],L=[],F=x/o,a=p;U>a;a++){var N=a+1,e=F*a,c=F*N;X.push(_(e)*G,-G,-E(e)*G,_(c)*G,-G,-E(c)*G,0,G,0),L.push(a/o,1,N/o,1,(a+N)/2/o,0)}if(W){var Y=[],h=[];for(a=p;U>a;a++){e=F*a,c=F*(a+1);var B=_(e),f=E(e),C=_(c),Z=E(c);Y.push(B*G,-G,-f*G,0,-G,0,C*G,-G,-Z*G),h.push(.5+.5*B,.5+.5*f,.5,.5,.5+.5*C,.5+.5*Z)}}return P&&(e=F*p,X.push(0,G,0,0,-G,0,_(e)*G,-G,-E(e)*G),L.push(0,0,0,1,p/o,1)),g&&(e=F*U,X.push(0,-G,0,0,G,0,_(e)*G,-G,-E(e)*G),L.push(1,1,1,0,U/o,1)),{vs:X,uv:L,bottom_vs:Y,bottom_uv:h}},dh=function(y,t,H,R,o,w,j,P){for(var A=[],M=0;M<y.length-1;M+=2)A.push({x:y[M],y:y[M+1]});return Bl(A,t,H,R,o,w,j,P,!1)},_j={roundRect:function(E,u){return dh([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],E,u,3)},star:function(e,Y){return dh([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],e,Y)},rect:function(e,V){return dh([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],e,V)},triangle:function(q,h){return dh([0,-.5,.5,.5,-.5,.5],[1,2,2,5],q,h)},rightTriangle:function(Q,j){return dh([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Q,j)},parallelogram:function(x,V){return dh([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],x,V)},trapezoid:function(M,n){return dh([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],M,n)}},kb={sphere:1,cylinder:1,cone:1,torus:1},Jj={torus:1,sphere:1},Zm=op(Nc(_j),{cylinder:1}),Re=op(Nc(_j),{cylinder:1,cone:1}),$m=function(z,V,L){var A,M=an(z.mat,L,V),b=an(z.s3,L,V),R=an(z.t3,L,V),F=an(z.r3,L,V);return(b||F||R||M)&&(A=pn(V._nMatrix),Ef(V,Hn(M,b,F,an(z.rotationMode,L,V),R))),A},Yd=function(b,p,M,G,U,n,i){if(fd(M))M.forEach(function(H){Yd(b,p,H,G,U,n,i)});else if(ii(M))Yd(b,p,rk(G,M),G,U,n,i);else if(me(M))if(M.shape3d){var _=$m(M,b,p);Yd(b,p,M.shape3d,G,U,n,M),_&&Ei(b,_)}else gk(b,p,M,G,U,n,i)},gk=function(a,n,J,w,q,d,F){if(F=F||$i,!d||d(w("shape3d.transparent",J.transparent,F.transparent))){var $=$m(J,a,n);Wf(J);var W=a._gl,B=a._prg,y=a._buffer,u=w("shape3d.color",J.color,F.color);q||(q=w("shape3d.blend",J.blend,F.blend)),Fl(W,B,q,w("shape3d.light",J.light,F.light),w("shape3d.opacity",J.opacity,F.opacity),w("shape3d.reverse.flip",J.reverseFlip,F.reverseFlip),w("shape3d.reverse.color",J.reverseColor,F.reverseColor),w("shape3d.reverse.cull",J.reverseCull,F.reverseCull)),J.vs&&w(ai,J.visible,F.visible)&&Ae(W,B,y,u,a.getTexture(w("shape3d.image",J.image,F.image),n),w("shape3d.discard.selectable",J.discardSelectable,F.discardSelectable),J.vs,J.uv,J.ns,J.is,w("shape3d.uv.offset",J.uvOffset,F.uvOffset),w("shape3d.uv.scale",J.uvScale,F.uvScale)),J.top_vs&&w(_q,J.topVisible,F.topVisible)&&Ae(W,B,y,w("shape3d.top.color",J.topColor,F.topColor)||u,a.getTexture(w("shape3d.top.image",J.topImage,F.topImage),n),w("shape3d.top.discard.selectable",J.topDiscardSelectable,F.topDiscardSelectable),J.top_vs,J.top_uv,J.top_ns,J.top_is,w("shape3d.top.uv.offset",J.topUvOffset,F.topUvOffset),w("shape3d.top.uv.scale",J.topUvScale,F.topUvScale)),J.bottom_vs&&w(Qp,J.bottomVisible,F.bottomVisible)&&Ae(W,B,y,w("shape3d.bottom.color",J.bottomColor,F.bottomColor)||u,a.getTexture(w("shape3d.bottom.image",J.bottomImage,F.bottomImage),n),w("shape3d.bottom.discard.selectable",J.bottomDiscardSelectable,F.bottomDiscardSelectable),J.bottom_vs,J.bottom_uv,J.bottom_ns,J.bottom_is,w("shape3d.bottom.uv.offset",J.bottomUvOffset,F.bottomUvOffset),w("shape3d.bottom.uv.scale",J.bottomUvScale,F.bottomUvScale)),J.from_vs&&w(Jo,J.fromVisible,F.fromVisible)&&Ae(W,B,y,w("shape3d.from.color",J.fromColor,F.fromColor)||u,a.getTexture(w("shape3d.from.image",J.fromImage,F.fromImage),n),w("shape3d.from.discard.selectable",J.fromDiscardSelectable,F.fromDiscardSelectable),J.from_vs,J.from_uv,J.from_ns,J.from_is,w("shape3d.from.uv.offset",J.fromUvOffset,F.fromUvOffset),w("shape3d.from.uv.scale",J.fromUvScale,F.fromUvScale)),J.to_vs&&w(Ih,J.toVisible,F.toVisible)&&Ae(W,B,y,w("shape3d.to.color",J.toColor,F.toColor)||u,a.getTexture(w("shape3d.to.image",J.toImage,F.toImage),n),w("shape3d.to.discard.selectable",J.toDiscardSelectable,F.toDiscardSelectable),J.to_vs,J.to_uv,J.to_ns,J.to_is,w("shape3d.to.uv.offset",J.toUvOffset,F.toUvOffset),w("shape3d.to.uv.scale",J.toUvScale,F.toUvScale)),rn(W,B),$&&Ei(a,$)}},Ae=function(R,d,F,X,P,t,Q,p,x,O,j,f){Q&&(Bb(R,d.uDiffuse,X),p&&Nd(R,d,P,t,F.uv,p,j,f),en(R,F.vs,Q,d.aPosition),en(R,F.ns,x,d.aNormal),O?(Zn(R,F.is,O),Dj(R,0,O.length)):qf(R,0,Q.length/3),p&&em(R,d,P))},rk=function(W,o){if(o||(o=W(cg)),!o)return t;if(me(o))return o;var Z=Le[o];if(Z)return Z;var K=o;if(kb[o]){var I=W("shape3d.side"),Y=W("shape3d.side.from"),S=W("shape3d.side.to"),x=W(Jo),O=W(Ih);3>I?(I=0,Y=0,S=0,x=!1,O=!1):((Y==t||0>Y)&&(Y=0),(S==t||S>I)&&(S=I),0===Y&&S===I&&(x=!1,O=!1)),K+="-"+I+"-"+Y+"-"+S+"-"+x+"-"+O}if(Zm[o]){var U=W(_q);K+="-"+U}if(Re[o]){var i=W(Qp);K+="-"+i}if("torus"===o){var q=W("shape3d.torus.radius");0>q?q=0:q>.25&&(q=.25),K+="-"+q}if(Jj[o]){var z=W(cp);K+="-"+z}return Z=Ik[K],Z||("box"===o?Z=b.createBoxModel():_j[o]?Z=_j[o](U,i):"sphere"===o?Z=b.createSphereModel(I,Y,S,x,O,z):o===Hp?Z=b.createCylinderModel(I,Y,S,x,O,U,i):"cone"===o?Z=b.createConeModel(I,Y,S,x,O,i):"torus"===o&&(Z=b.createTorusModel(I,Y,S,x,O,q,z)),Ik[K]=Z),Z},Wf=function(){var I=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv"],H=["is","top_is","bottom_is","from_is","to_is"];return function(E){E&&!E._complete_&&(E._complete_=!0,E.vs&&Ii(E.ns)&&(E.ns=dk(E.vs,E.is)),E.top_vs&&Ii(E.top_ns)&&(E.top_ns=dk(E.top_vs,E.top_is)),E.bottom_vs&&Ii(E.bottom_ns)&&(E.bottom_ns=dk(E.bottom_vs,E.bottom_is)),E.from_vs&&Ii(E.from_ns)&&(E.from_ns=dk(E.from_vs,E.from_is)),E.to_vs&&Ii(E.to_ns)&&(E.to_ns=dk(E.to_vs,E.to_is)),I.forEach(function(p){var Y=E[p];fd(Y)&&(E[p]=new ab(Y))}),H.forEach(function(_){var F=E[_];fd(F)&&(E[_]=new km(F))}))}}(),vm=function(b,S){var X=b[S];fd(X)&&(b[S]=new ab(X))};op(nk,{ms_line:function(y){y.getPartMat=function(Z,R,J,w,E,s,u,v,b){var r=this.info;if(r){var I,y,T,n,p,K,M=jl();if(Oe[R]?(I=r.p3,y=r.c1,T=r.c2):ue[R]?(y=r.s1||r.c1,T=r.s2||r.c2):(y=r.t1||r.c1,T=r.t2||r.c2),I)K=Rk(R,yq,J,w,v,b);else{var N=id(T,y),e=Uk(y,T);n=[0,-W(N[2],N[0]),B(N[1]/e)],p="zyx",I=[(y[0]+T[0])/2,(y[1]+T[1])/2,(y[2]+T[2])/2],K=Rk(R,[e,0,0],J,w,v,b)}return te(M,K,I,w,E,s,u,Z,n,p)}return Tf},y.drawBody=function(E,h,r){var b=this,v=b.shapeModel;if(v){var $=b.gv;Ef($),Yd($,b.data,v,b.s,b.getBodyColor(),r)}},y.createLineModel=function(s,H,I,c,X){for(var W=this,u=W.s,T=gn(s,H,u(cp)),E=[],J=0;J<T.length;J++){var l=T[J],Z=l.length;if(Z>1){var D=l[0];E.push(D.x,D.y,D.z);for(var O=1;Z-1>O;O++)D=l[O],E.push(D.x,D.y,D.z),E.push(D.x,D.y,D.z);D=l[Z-1],E.push(D.x,D.y,D.z)}}var a,e,A,B=u(c+".color"),$=u(X),d=0;return $&&(e=u(X+".color"),a=u(X+".pattern"),d=u(X+".offset"),A=B),gd(W.gv,W.data,E,e||B,A?t:u(c+".gradient.color"),I,a||u(c+".pattern"),d,A),T},y.createTubeModel=function(s,X,c,P){for(var N=this,l=N.s,u=l("shape3d.side")||$c,d=l("shape3d.start.angle"),m=l(_q)?l("shape3d.top.cap"):t,W=l(Qp)?l("shape3d.bottom.cap"):t,D="flat"===m,f="flat"===W,x=D&&(P?P.uv:l("shape3d.top.image")),a=f&&(P?P.uv:l("shape3d.bottom.image")),w=P?P.uv:l("shape3d.image"),j={vs:[],uv:w?[]:t,top_vs:D?[]:t,top_uv:x?[]:t,bottom_vs:f?[]:t,bottom_uv:a?[]:t},Q=gn(s,X,l(cp),c),S=0,F=Q.length;F>S;S++)Fk(j,Q[S],l(vc),c,u,d,m,W);if(P){var A=[];Rj(N.gv,N.data,j,l,N.getBodyColor(),[],P,A),A.length&&(jb(P.vs,A),jb(P.ns,dk(A)))}else N.shapeModel=j;return Q},y.getCache=function(){var b=this.info;if(b){var L=b.list;if(L){var $=b.cache;return $||($=b.cache=qe(L)),$}}return t}}});var Ck=function(P,M){for(var Q,t=0,j=P.length,F=0,c=j-1;c>=F;)if(t=D(F+(c-F)/2),Q=P[t].length-M,0>Q)F=t+1;else{if(!(Q>0)){c=t;break}c=t-1}t=c;var b=P[t],T=b.point;return t===j-1||b.length===M||(T=(new hl).subVectors(P[t+1].point,T).normalize().multiplyScalar(M-b.length).add(T)),{point:T,tangent:b.tangent}},qe=function(s){for(var h,t,U=[],O=0,M=0;M<s.length;M++){for(var T=s[M],o=0;o<T.length;o++){h=T[o],t&&(O+=t.distanceTo(h));var g=new hl,A=T[o+1];A?g.subVectors(A,h):t?g.subVectors(h,t):g.x=1,g.normalize(),U.push({point:h,length:O,tangent:g}),t=h}t=null}return U},gn=function(s,H,g,e){g=g||_e;for(var x=[],q=0,j=s.size();j>q;q++){var M=s.get(q);x.push(new hl(M.x,M.e||0,M.y))}Go(H)&&(H=H._as);for(var v,I,R,b,W,w=[],S=0,k=0,Y=H?H.length:j;Y>k;k++)if(W=H?H[k]:0===k?1:2,1===W)w.push(R=[]),R.push(x[S++]);else if(2===W||5===W)if(b=2===W?x[S++]:R[0],e){var F=H?H[k+1]:Y>k+1?2:t;if(2===F||5===F){var C=R[R.length-1],$=2===F?x[S]:R[0],G=(new hl).subVectors(C,b),X=(new hl).subVectors($,b),N=G.length(),z=X.length();if(e>N/2&&e>z/2)R.push(b);else for(G.multiplyScalar(d(e,N/2)/N).add(b),X.multiplyScalar(d(e,z/2)/z).add(b),v=new Xk(G,b,X).getPoints(g),I=0;g>=I;I++)R.push(v[I])}else R.push(b)}else R.push(b);else if(3===W)for(v=new Xk(R[R.length-1],x[S++],x[S++]).getPoints(g),I=1;g>=I;I++)R.push(v[I]);else if(4===W)for(v=new yk(R[R.length-1],x[S++],x[S++],x[S++]).getPoints(g),I=1;g>=I;I++)R.push(v[I]);return w},tp=function(y){for(var Y,u,m=new hl,x=[],E=[],_=[],U=0,O=y.length;O>U;U++)Y=y[U],u=y[U+1],u?m.subVectors(u,Y):m.subVectors(Y,y[U-1]),x.push(m.normalize().clone());var P,H,n,C,t=new hl,j=new hl,q=new bf,D=1e-4,w=Number.MAX_VALUE,L=x[0],V=E[0]=new hl,S=_[0]=new hl;for(H=g(L.x),n=g(L.y),C=g(L.z),w>=H&&(w=H,t.set(1,0,0)),w>=n&&(w=n,t.set(0,1,0)),w>=C&&t.set(0,0,1),j.crossVectors(L,t).normalize(),V.crossVectors(L,j),S.crossVectors(L,V),U=1;O>U;U++)E[U]=E[U-1].clone(),_[U]=_[U-1].clone(),j.crossVectors(x[U-1],x[U]),j.length()>D&&(j.normalize(),P=T(ic(x[U-1].dot(x[U]),-1,1)),E[U].applyMatrix4(q.makeRotationAxis(j,P))),_[U].crossVectors(x[U],E[U]);return{B:_,T:x,N:E}},Fk=function(){var N=function(x){for(var P=1;P<arguments.length;P++){var D=arguments[P];x.push(D.x,D.y,D.z)}},c=function(r){for(var o=1;o<arguments.length;o++){var z=arguments[o].uv;r.push(z[0],z[1])}},W=function(V,Z,O,n,d){var p=-n*_(d),b=n*E(d);return new hl(V.x+p*O.x+b*Z.x,V.y+p*O.y+b*Z.y,V.z+p*O.z+b*Z.z)},T=function(L,p,S,k,K,h,J){for(var g=[],o=x/K,I=0;K>=I;I++){var M=W(L,p,S,k,I*o+h);g.push(M),J!=t&&(M.uv=[J,I/K])}return g},u=function(i,Y,R,X,t,m,$,v){var P=Y?i.top_vs:i.bottom_vs;if(P)for(var b=Y?i.top_uv:i.bottom_uv,o=x/$,u=0;$>u;u++){var d,A;Y?(d=u*o+v,A=(u+1)*o+v):(A=u*o+v,d=(u+1)*o+v),N(P,W(R,X,t,m,d),W(R,X,t,m,A),R),b&&b.push(.5-.5*_(d),.5-.5*E(d),.5-.5*_(A),.5-.5*E(A),.5,.5)}};return function(Y,P,f,J,y,I,z,i){var x=P.length;if(x>1){var w,d,l,s,o,W,m,C=tp(P),H=C.T,G=C.N,$=C.B;"flat"===z&&u(Y,!0,P[0],$[0],G[0],J,y,I),"flat"===i&&u(Y,!1,P[x-1],$[x-1],G[x-1],J,y,I);var j,U,M=[],n=Q(y/2),q="round"===z,e="round"===i,V=P[0],O=H[0],p=$[0],L=G[0],D=P[x-1],A=H[x-1],S=$[x-1],v=G[x-1];if(q){for(l=1;n>=l;l++)G.splice(0,0,L),$.splice(0,0,p),H.splice(0,0,O),U=-l/n*J,P.splice(0,0,O.clone().multiplyScalar(U).add(V)),M[n-l]=k(J*J-U*U);x+=n}if(e){for(l=1;n>=l;l++)G.push(v),$.push(S),H.push(A),U=l/n*J,P.push(A.clone().multiplyScalar(U).add(D)),M[P.length-1]=k(J*J-U*U);x+=n}if(Y.uv){var r=0,b=0,a=[];for(f&&(r=f),o=P[0],a[0]=0,l=1;x>l;l++)s=P[l],a[l]=o.distanceTo(s),o=s,f||(r+=a[l]);for(j=[],l=0;x>l;l++)b+=a[l],j[l]=r?b/r:0}for(l=0;x>l;l++){if(s=P[l],W=$[l],m=G[l],w=T(s,W,m,M[l]===Z?J:M[l],y,I,j?j[l]:t),d)for(var X=0;y>X;X++){var K=d[X],B=d[X+1]||d[0],_=w[X],E=w[X+1]||w[0];N(Y.vs,B,K,_,_,E,B),Y.uv&&c(Y.uv,B,K,_,_,E,B)}d=w}}}}(),kc=p.Light=function(){Ag(kc,this),this.s(Qe,L[Qe]),this.s(cg,"sphere"),this.s3(20,20,20)};Qr("Light",Bg,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(A,v,D){kc.superClass.onStyleChanged.apply(this,arguments),A===Qe&&this.s("shape3d.color",D)}});var Pg=ve.Graph3dView=function(w,R){var k=this;k._attributes=R||b.graph3dViewAttributes,k._uiMap={},k._view=gc(1);var W=k._canvas=Rd(k._view);W.addEventListener("webglcontextlost",function(c){c.preventDefault(),yj(k),k._gl=t,k._pickHelper.texture=t,k._contextLost=!0},!1),W.addEventListener("webglcontextrestored",function(){k._contextLost=!1,k.iv()},!1),k._batchIndexMap={},k._batchModelMap={},k._wireframeIndexMap={},k._wireframeModelMap={},k._polylineIndexMap={},k._polylineIndexMap={},k._stack=[],k._mvMatrix=jl(),k._nMatrix=jl(),k._pickHelper=new qq(k),k._editHelper=new Zd(k),k._gridHelper=new Yi(k),k._axisHelper=new ij(k),k._eyeChanged=!0,k._eye=Nc(b.graph3dViewEye),k._center=Nc(b.graph3dViewCenter),k._up=Nc(b.graph3dViewUp),k._lightChanged=!1,k._points=[],k._spots=[],k._dirs=[],k.dm(w?w:new fq),k.setInteractors([new os(k)])},vj={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1};Mq("Graph3dView",X,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,ms_interaction:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Di,Hh,"firstPersonMode",np,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Y,r,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_devicePixelRatio:Z,_boundaries:Z,_moveStep:b.graph3dViewMoveStep,_rotateStep:b.graph3dViewRotateStep,_pannable:b.graph3dViewPannable,_rotatable:b.graph3dViewRotatable,_walkable:b.graph3dViewWalkable,_resettable:b.graph3dViewResettable,_zoomable:b.graph3dViewZoomable,_firstPersonMode:b.graph3dViewFirstPersonMode,_mouseRoamable:b.graph3dViewMouseRoamable,_gridVisible:b.graph3dViewGridVisible,_gridSize:b.graph3dViewGridSize,_gridGap:b.graph3dViewGridGap,_gridColor:b.graph3dViewGridColor,_originAxisVisible:b.graph3dViewOriginAxisVisible,_centerAxisVisible:b.graph3dViewCenterAxisVisible,_axisXColor:b.graph3dViewAxisXColor,_axisYColor:b.graph3dViewAxisYColor,_axisZColor:b.graph3dViewAxisZColor,_ortho:b.graph3dViewOrtho,_orthoWidth:b.graph3dViewOrthoWidth,_fovy:b.graph3dViewFovy,_near:b.graph3dViewNear,_far:b.graph3dViewFar,_headlightColor:b.graph3dViewHeadlightColor,_headlightIntensity:b.graph3dViewHeadlightIntensity,_headlightRange:b.graph3dViewHeadlightRange,_headlightDisabled:b.graph3dViewHeadlightDisabled,_rectSelectable:b.graph3dViewRectSelectable,_rectSelectBackground:b.graph3dViewRectSelectBackground,_editSizeColor:b.graph3dViewEditSizeColor,_autoMakeVisible:ug,_fogDisabled:b.graph3dViewFogDisabled,_fogColor:b.graph3dViewFogColor,_fogNear:b.graph3dViewFogNear,_fogFar:b.graph3dViewFogFar,_dashDisabled:b.graph3dViewDashDisabled,_batchColorDisabled:b.graph3dViewBatchColorDisabled,_batchBlendDisabled:b.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:b.graph3dViewBatchBrightnessDisabled,setEye:function(Q,K,T){1===arguments.length&&(K=Q[1],T=Q[2],Q=Q[0]);var p=this._eye;p[0]=Q,p[1]=K,p[2]=T,this.fp(Y,t,p)},setCenter:function(v,z,a){1===arguments.length&&(z=v[1],a=v[2],v=v[0]);var j=this._center;j[0]=v,j[1]=z,j[2]=a,this.fp(r,t,j)},setUp:function(q,S,L){1===arguments.length&&(S=q[1],L=q[2],q=q[0]);var Y=this._up;Y[0]=q,Y[1]=S,Y[2]=L,this.fp("up",t,Y)},isTransparentMask:function(E){return E.s("transparent.mask")},getAspect:function(){var s=this,W=s._aspect;return W?W:s.getWidth()/s.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(l){var u=this,N=u._dataModel,V=u._selectionModel;N!==l&&(N&&(N.umm(u.handleDataModelChange,u),N.umd(u.handleDataPropertyChange,u),V||N.sm().ums(u.handleSelectionChange,u)),u._dataModel=l,l.mm(u.handleDataModelChange,u),l.md(u.handleDataPropertyChange,u),V?V._setDataModel(l):l.sm().ms(u.handleSelectionChange,u),u.invalidateAll(!0),u.invalidateLight(),u.fp(Cr,N,l))},handleDataPropertyChange:function(P){var z=P.data;this.invalidateData(z),Gj(z)&&"s:light.type"===P.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(L){var $=this,w=L.property;$.iv(),$._pvMatrix=t,"eye"===w?$._eyeChanged=!0:"devicePixelRatio"===w?$.draw(t,$._devicePixelRatio||_p):vj[w]&&yj($)},createData3dUI:function(O){var o=O.get3dUIClass();return o?new o(this,O):t},getData3dUI:function(D){var K=this._uiMap[D._id];return K===Z&&(K=this.createData3dUI(D),this._uiMap[D._id]=K),K},invalidateAll:function(G){var c=this;if(G){for(var A in c._uiMap){var Z=c._uiMap[A];Z&&Z.dispose()}c._uiMap={},c.iv(),zm(c)}else c.dm().each(function(Z){c.invalidateData(Z)})},invalidateSelection:function(){var k=this;k.sm().each(function(v){k.invalidateData(v)})},invalidateData:function(C){var y=this,v=y.getData3dUI(C);v&&(v.iv(),y.iv()),zm(y,C)},invalidateBatch:function(c){var W=this,C=W._batchModelMap,p=C[c];p&&(p.ds.forEach(function(w){var t=W.getData3dUI(w);t&&t.iv(),delete W._batchIndexMap[w._id]}),delete C[c],W.iv())},handleDataModelChange:function(k){var M=this,U=k.kind,y=k.data;if("add"===U)M.invalidateData(y),Oq(y)&&y.getEdgeGroup()&&y.getEdgeGroup().eachSiblingEdge(M.invalidateData,M),Gj(y)&&M.invalidateLight();else if(U===Ve){var D=y._id,X=M._uiMap[D];X&&(X.dispose(),delete M._uiMap[D],M.iv()),y===M._currentSubGraph&&M.setCurrentSubGraph(t),zm(M,y),Gj(y)&&M.invalidateLight()}else U===Yn&&(M.invalidateAll(!0),M.setCurrentSubGraph(t),zm(M),M.invalidateLight())},toCanvas:function(S){var F=this,J=F.getGL();if(F.validate(),S){var g=J.getParameter(J.COLOR_CLEAR_VALUE);Mc(J,S)}F.draw(t,1);var e=F.getWidth(),k=F.getHeight(),r=new Uint8Array(4*e*k),d=Rd(),v=d.getContext("2d");
J.readPixels(0,0,e,k,J.RGBA,J.UNSIGNED_BYTE,r),eh(d,e,k,1);for(var G=v.getImageData(0,0,e,k),K=G.data,s=0;s<K.length;s+=4){var z=s/4,c=D(z/e),m=z-c*e;z=4*((k-1-c)*e+m),K[z]=r[s],K[z+1]=r[s+1],K[z+2]=r[s+2],K[z+3]=r[s+3]}return v.putImageData(G,0,0),S&&Mc(J,g),F.draw(t,F._devicePixelRatio||_p),d},toDataURL:function(A,_){var l=this,O=l.getGL();if(l.validate(),A){var c=O.getParameter(O.COLOR_CLEAR_VALUE);Mc(O,A)}l.draw(t,1);var L=l._canvas.toDataURL(_||"image/png",1);return A&&Mc(O,c),l.draw(t,l._devicePixelRatio||_p),L},getGL:function(){var I=this,K=I._gl,x=I._prg;if(!K)try{I._textureMap={},K=I._gl=I._canvas.getContext("webgl",I._attributes)||I._canvas.getContext("experimental-webgl",I._attributes),I._buffer={vs:us(K),ns:us(K),is:us(K),uv:us(K),batchColor:us(K),batchBlend:us(K),batchBrightness:us(K),lineDistance:us(K)},I._texture=gs(K);var g=I._cube={vs:us(K),ns:us(K),is:us(K),uv:us(K)};en(K,g.vs,jj),en(K,g.ns,vd),en(K,g.uv,Sh),Zn(K,g.is,Fq)}catch(A){}if(K&&!x){if(x=I._prg=K.createProgram(),!x)return t;var d=I._dirs.length,Y=I._spots.length,u=I._points.length,Q=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uTransparent","uTexture","uSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];d&&Q.push("uDirColor","uDirPosition"),Y&&Q.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotCenter"),u&&Q.push("uPointColor","uPointRange","uPointPosition"),Mc(K,[0,0,0,0]),K.clearDepth(1),K.enable(K.DEPTH_TEST),K.depthFunc(K.LEQUAL),K.enable(K.BLEND),K.blendFunc(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA),qi||(wi=ag(wi),Ui=ag(Ui),qi=!0);var S=["#define MAX_DIR "+d,"#define MAX_SPOT "+Y,"#define MAX_POINT "+u,I._fogDisabled?"":"#define FOG",I._dashDisabled?"":"#define DASH",I._batchColorDisabled?"":"#define BATCHCOLOR",I._batchBlendDisabled?"":"#define BATCHBLEND",I._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),R=Op(K,x,K.VERTEX_SHADER,wi.replace("PREFIX",S)),l=Op(K,x,K.FRAGMENT_SHADER,Ui.replace("PREFIX",S));w?Q.push("aPosition"):(x.aPosition=0,K.bindAttribLocation(x,0,"aPosition")),K.linkProgram(x),Q.forEach(function(p){x[p]=/^u/.test(p)?K.getUniformLocation(x,p):K.getAttribLocation(x,p)}),K.useProgram(x),K.deleteShader(R),K.deleteShader(l)}return K},getBrightness:function(W){var Q=W.s("brightness"),w=this.isSelected(W)?W.s("select.brightness"):t;return Q==t?w:w==t?Q:Q*w},getWireframe:function(R){var N=R.s("wf.visible");return N===!0||"selected"===N&&this.isSelected(R)?{color:R.s("wf.color"),width:R.s("wf.width"),"short":R.s("wf.short"),mat:R.s("wf.mat")}:void 0},getBodyColor:function(z){return z.s("body.color")},getMat:function($){return $.getMat?$.getMat():$.s("mat")},getFaceMat:function(z,p){return z.getFaceMat?z.getFaceMat(p):z.s(p+".mat")},getFaceBlend:function(M,G){return M.s(G+".blend")||M.s("all.blend")},getFaceColor:function(r,p){return r.s(p+".color")||r.s("all.color")},getFaceImage:function(_,k){return _.s(k+".image")||_.s("all.image")},getFaceDiscardSelectable:function(o,c){var z=o.s(c+".discard.selectable");return z==t?o.s("all.discard.selectable"):z},getFaceUv:function(c,x){return c.s(x+".uv")||c.s("all.uv")},getFaceUvOffset:function(D,n){return D.s(n+".uv.offset")||D.s("all.uv.offset")},getFaceUvScale:function(z,O){return z.s(O+".uv.scale")||z.s("all.uv.scale")},getFaceLight:function(g,B){var m=g.s(B+".light");return m==t?g.s("all.light"):m},getFaceVisible:function(h,M){var W=h.s(M+".visible");return W==t?h.s("all.visible"):W},getFaceOpacity:function(r,c){var f=r.s(c+".opacity");return f==t?r.s("all.opacity"):f},getFaceTransparent:function(F,f){var H=F.s(f+".transparent");return H==t?F.s("all.transparent"):H},getFaceReverseColor:function(y,q){return y.s(q+".reverse.color")||y.s("all.reverse.color")},getFaceReverseFlip:function(p,U){var A=p.s(U+".reverse.flip");return A==t?p.s("all.reverse.flip"):A},getFaceReverseCull:function(O,m){var F=O.s(m+".reverse.cull");return F==t?O.s("all.reverse.cull"):F},getTextureMap:function(){return this._textureMap},deleteTexture:function(U){var A=this,Q=A._textureMap[U];Q&&(delete A._textureMap[U],A.getGL().deleteTexture(Q))},getTexture:function(Q,V){if(!Q)return t;var p=this,D=p.getGL(),s=p._textureMap[Q];if(!s){var S=vn(Q);if(S)if(S.tagName){if(S.dynamic)return gs(D,S,p._texture);s=p._textureMap[Q]=gs(D,S)}else{var R=Do(S,V),M=xk(S,V);if(R>=1&&M>=1){var U=bb(R,M);return Bk(U,S,0,0,R,M,V,p),U.restore(),gs(D,vb,p._texture)}}}return s},redraw:function(){this.iv()},validateImpl:function(){var w=this;if(w._lightChanged){w._lightChanged=!1;var X=[],p=[],J=[];w.dm().each(function(t){if(Gj(t)){var r=t.s("light.type");r===nl?X.push(t):r===Fg?p.push(t):r===ek&&J.push(t)}}),(X.length!==w._points.length||p.length!==w._spots.length||J.length!==w._dirs.length)&&yj(w),w._points=X,w._spots=p,w._dirs=J}w.draw(),w._pickHelper.iv()},draw:function(O,I){var $=this;if(!$._contextLost){var S,b;O&&(O instanceof Bg?b=O:S=O);var g=$._canvas,n=$.getWidth(),i=$.getHeight(),D=$.getGL(),G=$._prg;if(D){if(I?O||eh(g,n,i,I):(I=$._devicePixelRatio||_p,O||n===g.clientWidth&&i===g.clientHeight||eh(g,n,i,I)),D.viewport(0,0,n*I,i*I),$._centerInfo=t,D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT),Bb(D,G.uBrightness,1),Bb(D,G.uOpacity,1),Bb(D,G.uPartOpacity,1),D._picking=!!O,Bb(D,G.uPick,!!O),Bb(D,G.uTexture,!1),Bb(D,G.uFix,!1),Bb(D,G.uTransparent,!1),Bb(D,G.uBatchColor,!1),Bb(D,G.uBatchBlend,!1),Bb(D,G.uBatchBrightness,!1),O||(Sd($,D,G),$._fogDisabled||(Bb(D,G.uFogColor,$._fogColor),Bb(D,G.uFogNear,$._fogNear),Bb(D,G.uFogFar,$._fogFar))),Dd(D,G.aPosition),Dd(D,G.aNormal),Um(D,G.aUv),Um(D,G.aBatchColor),Um(D,G.aBatchBlend),Um(D,G.aBatchBrightness),Um(D,G.aLineDistance),Bb(D,G.uPMatrix,tf($)),Bb(D,G.uViewMatrix,Jf($,$._mvMatrix)),b){var u=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),Um(D,G.aNormal),en(D,$._cube.vs,t,G.aPosition),Zn(D,$._cube.is),tm(b,$,s,0),tm(b,$,v,6),tm(b,$,c,12),tm(b,$,z,18),tm(b,$,y,24),tm(b,$,a,30),Dd(D,G.aNormal),Mc(D,u)}else if(S){S.value=2;var u=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),$.drawDatas(D,G,S),yh($,S),Pc($,$._polylineModelMap,S),Pc($,$._wireframeModelMap,S),Bb(D,G.uTransparent,!0),$.drawDatas(D,G,S,!0),yh($,S,!0),Pc($,$._polylineModelMap,S,!0),Pc($,$._wireframeModelMap,S,!0),Bb(D,G.uTransparent,!1),D.disable(D.DEPTH_TEST),$._editHelper.draw(D,G,S),D.enable(D.DEPTH_TEST),Mc(D,u)}else D.disable(D.BLEND),$._gridHelper.draw(D,G),$.drawDatas(D,G),yh($),Pc($,$._polylineModelMap),Pc($,$._wireframeModelMap),D.enable(D.BLEND),D.depthMask(!1),Bb(D,G.uTransparent,!0),$.drawDatas(D,G,t,!0),yh($,t,!0),Pc($,$._polylineModelMap,t,!0),Pc($,$._wireframeModelMap,t,!0),Bb(D,G.uTransparent,!1),D.depthMask(!0),D.disable(D.BLEND),D.disable(D.DEPTH_TEST),$._axisHelper.draw(D,G),$._editHelper.draw(D,G),D.enable(D.DEPTH_TEST);en(D,t),Zn(D,t),$._eyeChanged=!1}}},drawDatas:function(W,a,z,J){var B=this,o=function(l){return J?l:!l};B.dm().each(function(X){if(B.isVisible(X)){if(!z&&B.isTransparentMask(X))return;var b=B.getData3dUI(X);b&&b.draw(W,a,z,o)}})},getLogicalPoint:function(V){return yo(V,this._view)},getHitFaceInfo:function(y){y.target&&(y=this.lp(y));var w=this.getDataInfoAt(y);if(w){var Q=this._pickHelper.face(w.data,bk(y.x,y.y));if(Q)return{data:w.data,face:Q}}return t},getDataAt:function(n){var F=this.getDataInfoAt(n);return F?F.data:t},getDataInfoAt:function(v,T){return v.target&&(v=this.lp(v)),this._pickHelper.get(bk(v.x,v.y,T),!0)},getDatasInRect:function(L){return this._pickHelper.get(L)},setEditable:function(W){var s=this,V=s._editable;s._editable=W,this.fp(sn,V,W)},isEditable:function(r){var q=this;return q._editable?im(r)?r.s("3d.editable")?q._editableFunc?q._editableFunc(r):!0:!1:!1:!1},isSelectable:function(V){return V.s("3d.selectable")&&this.sm().isSelectable(V)},isMovable:function(c){var t=this;return Oq(c)&&c.getStyle(Jl)!==io?!1:c.s("3d.movable")?t._movableFunc?t._movableFunc(c):!0:!1},isSizeEditable:function(g){return im(g)?this._sizeEditableFunc?this._sizeEditableFunc(g):!0:!1},isRotationEditable:function(z){return im(z)&&z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(z):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(U){this.setZoom(Sk,U)},zoomOut:function(y){this.setZoom(1/Sk,y)},setZoom:function(m,w){if(1!==m){var i=this;if(i._ortho)return i.setOrthoZoom(m,w),void 0;i._zoomAnim&&i._zoomAnim.stop(!0);var h=1/m,$=i._eye,l=i._center,D=l[0]+($[0]-l[0])*h-$[0],Z=l[1]+($[1]-l[1])*h-$[1],T=l[2]+($[2]-l[2])*h-$[2];if(!(Uk($,l)<i._moveStep&&1>h)){if(w=Yq(w)){var K=Nc($);return w.action=function(g){i.fi({kind:i._zooming?"betweenZoom":"beginZoom"}),i._zooming=1,$[0]=K[0]+D*g,$[1]=K[1]+Z*g,$[2]=K[2]+T*g,i.fp(Y,t,$)},w.innerFunc=function(){delete i._zoomAnim,delete i._zooming,i.fi({kind:"endZoom"}),i.onZoomEnded()},i._zoomAnim=yc(w)}$[0]+=D,$[1]+=Z,$[2]+=T,i.fp(Y,t,$)}}},setOrthoZoom:function(S,w){if(1!==S){var F=this;F._zoomAnim&&F._zoomAnim.stop(!0);var R=F._orthoWidth,V=R/S-R;if(!(R<F._moveStep&&S>1))return(w=Yq(w))?(w.action=function(h){F.fi({kind:F._zooming?"betweenZoom":"beginZoom"}),F._zooming=1,F.setOrthoWidth(R+V*h)},w.innerFunc=function(){delete F._zoomAnim,delete F._zooming,F.fi({kind:"endZoom"}),F.onZoomEnded()},F._zoomAnim=yc(w)):(F.setOrthoWidth(R/S),void 0)}},getPositionInfo:function(h){var z=this,T=z._eye,t=z._center,y=z.getAspect(),a=h?oi(id(t,T,!0),id(h,T)):Uk(T,t);if(z._ortho){var M=z._orthoWidth;return{length:a,height:M/y,width:M}}var X=2*f(z._fovy/2)*a;return{length:a,height:X,width:X*y}},getCenterInfo:function(){var D=this;return D._centerInfo||(D._centerInfo=D.getPositionInfo()),Nc(D._centerInfo)},rotate:function(X,o,n,Q){var l=this;if(X||o){Q==t&&(Q=l._firstPersonMode),l._rotateAnim&&l._rotateAnim.stop(!0);var v=l._center,s=l._eye,y=l.getCenterInfo().length,U=Q?v:s,O=Q?s:v,A=id(U,O),L=W(A[0],A[2]),z=W(k(A[0]*A[0]+A[2]*A[2]),A[1]),K=Q?r:Y;return Q&&(o=-o),(n=Yq(n))?(n.action=function(v){l.fi({kind:l._rotating?"betweenRotate":"beginRotate"}),l._rotating=1;var n=L+X*v,R=z+o*v;R=Bp(R),A[0]=y*E(R)*E(n),A[1]=y*_(R),A[2]=y*E(R)*_(n),U[0]=O[0]+A[0],U[1]=O[1]+A[1],U[2]=O[2]+A[2],l.fp(K,t,U)},n.innerFunc=function(){delete l._rotateAnim,delete l._rotating,l.fi({kind:"endRotate"}),l.onRotateEnded()},l._rotateAnim=yc(n)):(L+=X,z+=o,z=Bp(z),A[0]=y*E(z)*E(L),A[1]=y*_(z),A[2]=y*E(z)*_(L),U[0]=O[0]+A[0],U[1]=O[1]+A[1],U[2]=O[2]+A[2],l.fp(K,t,U),void 0)}},pan:function(u,P,V,g){if(u||P){var M=this;g==t&&(g=M._firstPersonMode),M._panAnim&&M._panAnim.stop(!0);var i=Jf(M),R=[i[0]*u,i[4]*u,i[8]*u],L=[i[1]*P,i[5]*P,i[9]*P],_=R[0]+L[0],o=R[1]+L[1],W=R[2]+L[2],S=M._center,F=M._eye;if(g){var e=po(M.getBoundaries(),F[0],F[2],F[0]+_,F[2]+W,k(_*_+W*W));_=e[0],W=e[1]}if(V=Yq(V)){var Q=Nc(F),w=Nc(S);return V.action=function(f){M.fi({kind:M._panning?"betweenPan":"beginPan"}),M._panning=1,S[0]=w[0]+_*f,S[1]=w[1]+o*f,S[2]=w[2]+W*f,F[0]=Q[0]+_*f,F[1]=Q[1]+o*f,F[2]=Q[2]+W*f,M.fp(Y,t,F),M.fp(r,t,S)},V.innerFunc=function(){delete M._panAnim,delete M._panning,M.fi({kind:"endPan"}),M.onPanEnded()},M._panAnim=yc(V)}S[0]+=_,S[1]+=o,S[2]+=W,F[0]+=_,F[1]+=o,F[2]+=W,M.fp(Y,t,F),M.fp(r,t,S)}},walk:function(C,D,Q){if(C){var n=this;Q==t&&(Q=n._firstPersonMode),n._walkAnim&&n._walkAnim.stop(!0);var E=n._center,w=n._eye,z=id(E,w,!0);if(Q){var F=po(n.getBoundaries(),w[0],w[2],w[0]+z[0]*C,w[2]+z[2]*C,g(C));if(C=Uk(F),!C)return;z=[F[0]/C,0,F[1]/C]}if(D=Yq(D)){var q=Nc(w),Z=Nc(E);return D.action=function(v){n.fi({kind:n._walking?"betweenWalk":"beginWalk"}),n._walking=1;var $=C*v;w[0]=q[0]+z[0]*$,w[1]=q[1]+z[1]*$,w[2]=q[2]+z[2]*$,E[0]=Z[0]+z[0]*$,E[1]=Z[1]+z[1]*$,E[2]=Z[2]+z[2]*$,n.fp(Y,t,w),n.fp(r,t,E)},D.innerFunc=function(){delete n._walkAnim,delete n._walking,n.fi({kind:"endWalk"}),n.onWalkEnded()},n._walkAnim=yc(D)}w[0]+=z[0]*C,w[1]+=z[1]*C,w[2]+=z[2]*C,E[0]+=z[0]*C,E[1]+=z[1]*C,E[2]+=z[2]*C,n.fp(Y,t,w),n.fp(r,t,E)}},handleScroll:function(j,m){j.preventDefault();var i=this,w=i._moveStep;i.isFirstPersonMode()?i.isPannable()&&i.pan(0,m>0?w:-w):i.isZoomable()&&i.setZoom(0>m?1/$k:$k)},handlePinch:function(r,Z){this.isZoomable()&&this.setZoom(Z>r?1/Jm:Jm)},reset:function(){this.setCenter(b.graph3dViewCenter),this.setEye(b.graph3dViewEye),this.setUp(b.graph3dViewUp)},moveSelection:function(c,Z,k){var J,w=this,G=w.dm();G&&(J=G.getHistoryManager()),J&&J.beginInteraction(),qo(this.sm().toSelection(this.isMovable,this),c,Z,k),J&&J.endInteraction()},getMoveMode:function(I,n){var O=n.s("3d.move.mode");if(O)return O;var m="88",p="89",w="90";return Vm(I)||Oj[m]&&Oj[p]&&Oj[w]?"xyz":Oj[m]&&Oj[p]?"xy":Oj[m]&&Oj[w]?"xz":Oj[p]&&Oj[w]?"yz":Oj[m]?"x":Oj[p]?"y":Oj[w]?"z":"xz"},handleTick:function(){var w=this,x=!1,E=w._moveStep,A=E,s=!1,o=!0,W=w._rotateStep*(o?-1:1);if(w.isWalkable()||(A=0),w.isPannable()||(E=0),w.isRotatable()||(W=0),w._tickTime){var O=(Co()-w._tickTime)/50;A*=O,E*=O,W*=O}w._tickId&&(If(w._tickId),delete w._tickId,delete w._tickTime),dm()&&(x=!0,w.pan(-E,0,s,o)),hp()&&(x=!0,w.pan(E,0,s,o)),wb()&&(x=!0,Vm()?w.pan(0,E,s,o):w.walk(A,s,o)),zb()&&(x=!0,Vm()?w.pan(0,-E,s,o):w.walk(-A,s,o)),_c()&&(x=!0,w.rotate(-W,0,s,o)),Qj()&&(x=!0,w.rotate(W,0,s,o)),aj()&&(x=!0,w.rotate(0,-W/2,s,o)),Nj()&&(x=!0,w.rotate(0,W/2,s,o)),x&&(w._tickTime=Co(),w._tickId=td(w.handleTick,w))},handleKeyDown:function(o){var u=this;!is(o)&&$b[o.keyCode]?u.handleTick():Jn(o)?u.selectAll():mg(o)?u.handleDelete(o):wo(o)&&this.isResettable()&&u.reset()},checkDoubleClickOnNote:function(f,C,I){var z=this;if(I===Er){if(C.s("note.toggleable"))return C.s(rs,!C.s(rs)),z.fi({kind:"toggleNote",event:f,data:C,part:I}),!0}else if(I===aq&&C.s("note2.toggleable"))return C.s(Kf,!C.s(Kf)),z.fi({kind:"toggleNote2",event:f,data:C,part:I}),!0;return!1},checkDoubleClickOnRotation:function(P,g,H){return H===Ie?(g.setRotationX(0),!0):H===uj?(g.setRotationY(0),!0):H===sd?(g.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(F){var L=this,z=L.getWidth()/2,Z=L.getHeight()/2,Q=L._pvMatrix;return Q||(Q=tf(L),L._pvMatrix=tq(Q,Q,Jf(L))),F=Dk([F[0],F[1],F[2],1],Q),{x:z+z*F[0]/F[3],y:Z-Z*F[1]/F[3]}},getHitPosition:function(G,U,K){var Q=this,s=Q.getWidth(),P=Q.getHeight(),J=G.target?Q.lp(G):G,W=J.x-s/2,$=J.y-P/2,n=Q.getCenterInfo(),I=Jf(Q);U=U?U:[0,0,0],K=K?K:[0,1,0],W=W/s*n.width,$=-1*$/P*n.height;var d=[I[0]*W,I[4]*W,I[8]*W],i=[I[1]*$,I[5]*$,I[9]*$],y=[d[0]+i[0],d[1]+i[1],d[2]+i[2]],k=Q.getCenter(),D=Jg(Q,U,K,[y[0]+k[0],y[1]+k[1],y[2]+k[2]]);return D?D:[0,0,0]},getLineLength:function(L){this.validate();var e=this.getData3dUI(L);if(e&&e.getCache){var P=e.getCache();if(P)return P[P.length-1].length}return 0},getLineOffset:function(D,S){this.validate();var q=this.getData3dUI(D);if(q&&q.getCache){var b=q.getCache();if(b)return Ck(b,S)}return t}});var al=ve.Interactor=function(M){this.gv=M};Mq("Interactor",X,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var os=ve.DefaultInteractor=function(h){Ag(os,this,[h])};Mq("DefaultInteractor",al,{handle_contextmenu:function(f){Vk(f)},handle_mousewheel:function(A){this.gv.handleScroll(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(w){Vk(w);var G=this,g=G.gv,B=kf(w),X=g.getDataInfoAt(w),u=X?X.data:t,m=X?X.part:t,E=g.sm(),e=Bh(w),T=Sn(w);g.setFocus(w)&&(G.state=t,G.pendingCS=t,u?is(w)?E.co(u)?E.rs(u):E.as(u):E.co(u)||E.ss(u):B&&(is(w)?g.isRectSelectable()&&(G.state=uc):G.pendingCS=Rg(w)),G._tickId&&(If(G._tickId),delete G._tickId,delete G._tickTime),G.state||(g.isFirstPersonMode()&&(Vm(w)||T>2?G.state="pan":g.isMouseRoamable()||F?(G.state="roaming",G.foward=e&&kf(w),G._tickTime=Co(),G._tickId=td(G.tick,G)):B||(G.state="roaming")),G.state||(B&&e&&rr[m]?(G.state=m,G.p3=u.p3()):B&&e&&im(u)&&g.isSelected(u)&&g.isMovable(u)?(G.state="move",G.p3=u.p3(),G.movedata=u):F&&(T>2?G.state="pan":2===T&&(G.dist=ir(w),G.state="pinch")))),G.point=g.lp(w),ns(G,w),Zp(w)?g.handleDoubleClick(w,u,m):g.handleClick(w,u,m))},tick:function(){var W=this,U=W.gv,l=U._moveStep;W.point&&U.isWalkable()&&(W._tickTime&&(l*=(Co()-W._tickTime)/50),U.walk(W.foward?l:-l),W._tickTime=Co(),W._tickId=td(W.tick,W))},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(b){var w=this.pendingCS;w&&(Uk(w,Rg(b))<=1&&this.gv.sm().cs(),this.pendingCS=t)},handleWindowMouseMove:function(S){this.handleWindowTouchMove(S)},handleWindowTouchMove:function(j){var $,J,R=this,H=R.gv,y=R.state,G=R.point,E=H.dm(),p=E.getHistoryManager(),B=H.lp(j),M=B.x-G.x,U=B.y-G.y,r=-x*M/H.getWidth(),t=-x*U/H.getHeight();if("roaming"===y)R.rotate(j,r/2,t/2);else if(y===Ie||y===uj||y===sd)p&&!H._editingRotation&&p.beginInteraction(),H.fi({kind:H._editingRotation?"betweenEditRotation":"beginEditRotation",event:j}),H._editingRotation=1,H.sm().each(function(e){if(im(e)&&H.isRotationEditable(e)){var I=g(r)>g(t)?r:t;y===Ie?e.setRotationX(e.getRotationX()+I):y===uj?e.setRotationY(e.getRotationY()+I):y===sd&&e.setRotationZ(e.getRotationZ()+I)}});else if("move"===y||rr[y]){y===Zb||y===jf||y===Mi?(p&&!H._editingSize&&p.beginInteraction(),H.fi({kind:H._editingSize?"betweenEditSize":"beginEditSize",event:j}),H._editingSize=1):(p&&!H._moving&&p.beginInteraction(),H.fi({kind:H._moving?"betweenMove":"beginMove",event:j}),H._moving=1);var C,e=R.p3,K=H.getPositionInfo(e),Q=Jf(H);C=y===Fr?"x":y===xh?"y":y===Ub?"z":y===Zb?"sx":y===jf?"sy":y===Mi?"sz":H.getMoveMode(j,R.movedata),M=M/H.getWidth()*K.width,U=-1*U/H.getHeight()*K.height;var P,S,d=[Q[0]*M,Q[4]*M,Q[8]*M],s=[Q[1]*U,Q[5]*U,Q[9]*U],_=d[0]+s[0],T=d[1]+s[1],A=d[2]+s[2],V=[e[0]+_,e[1]+T,e[2]+A],L=id(H.getEye(),V,!0);if("xyz"===C?(P=V,H.moveSelection(_,T,A)):"xz"===C?(P=Jg(H,e,[0,1,0],V),P&&H.moveSelection(P[0]-e[0],0,P[2]-e[2])):"xy"===C?(P=Jg(H,e,[0,0,1],V),P&&H.moveSelection(P[0]-e[0],P[1]-e[1],0)):"yz"===C?(P=Jg(H,e,[1,0,0],V),P&&H.moveSelection(0,P[1]-e[1],P[2]-e[2])):"x"===C||"sx"===C?(L[0]=0,P=Jg(H,e,L,V),P&&(S=P[0]-e[0],"x"===C?H.moveSelection(S,0,0):H.sm().each(function(f){im(f)&&H.isSizeEditable(f)&&($=n(gh,f.getWidth()+S),J=$/f.getWidth(),f.setWidth($),Vm(j)&&(f.setHeight(f.getHeight()*J),f.setTall(f.getTall()*J)))}))):"y"===C||"sy"===C?(L[1]=0,P=Jg(H,e,L,V),P&&(S=P[1]-e[1],"y"===C?H.moveSelection(0,S,0):H.sm().each(function(W){im(W)&&H.isSizeEditable(W)&&($=n(gh,W.getTall()+S),J=$/W.getTall(),W.setTall($),Vm(j)&&(W.setHeight(W.getHeight()*J),W.setWidth(W.getWidth()*J)))}))):("z"===C||"sz"===C)&&(L[2]=0,P=Jg(H,e,L,V),P&&(S=P[2]-e[2],"z"===C?H.moveSelection(0,0,S):H.sm().each(function(q){im(q)&&H.isSizeEditable(q)&&($=n(gh,q.getHeight()+S),J=$/q.getHeight(),q.setHeight($),Vm(j)&&(q.setTall(q.getTall()*J),q.setWidth(q.getWidth()*J)))}))),!P)return;R.p3=P}else if(y===uc){var u=R.div;u||(u=R.div=gc(),Zc(R.getView(),u),u.op=G,u.style.background=H.getRectSelectBackground()),H.fi({kind:H._rectSelecting?"betweenRectSelect":"beginRectSelect",event:j}),H._rectSelecting=1,u.rect=Hi(u.op,B),fg(u,u.rect)}else if("pinch"===y&&2===Sn(j)){H.fi({kind:H._pinching?"betweenPinch":"beginPinch",event:j}),H._pinching=1;var S=ir(j);H.handlePinch(S,R.dist),R.dist=S}else"pan"===y||Vm(j)?R.pan(j,M,U):H.isFirstPersonMode()||(kf(j)?R.rotate(j,r,t):(R.pan(j,M,0),H.isWalkable()&&(H.fi({kind:H._walking?"betweenWalk":"beginWalk",event:j}),H._walking=1,H.walk(U/H.getHeight()*H.getCenterInfo().height))));R.point=B},pan:function(o,j,Y){var U=this.gv;if(U.isPannable()){var W=U.getCenterInfo(),S=j/U.getWidth()*W.width,d=-1*Y/U.getHeight()*W.height;U.fi({kind:U._panning?"betweenPan":"beginPan",event:o}),U._panning=1,U.pan(-S,-d)}},rotate:function(_,E,P){var O=this.gv;O.isRotatable()&&(O.fi({kind:O._rotating?"betweenRotate":"beginRotate",event:_}),O._rotating=1,O.rotate(E,P))},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(c){var h=this,d=h.gv,i=d.dm(),H=i.getHistoryManager(),C=h.div;if(C){var $=d.getDatasInRect(C.rect);if(!$.isEmpty()){var g=d.sm(),_=g.toSelection();$.each(function(c){g.co(c)?_.remove(c):_.add(c)}),g.ss(_)}gi(C)}d._moving&&(delete d._moving,d.fi({kind:"endMove",event:c}),d.onMoveEnded(),H&&H.endInteraction()),d._panning&&(delete d._panning,d.fi({kind:"endPan",event:c}),d.onPanEnded()),d._rotating&&(delete d._rotating,d.fi({kind:"endRotate",event:c}),d.onRotateEnded()),d._editingRotation&&(delete d._editingRotation,d.fi({kind:"endEditRotation",event:c}),H&&H.endInteraction()),d._editingSize&&(delete d._editingSize,d.fi({kind:"endEditSize",event:c}),H&&H.endInteraction()),d._pinching&&(delete d._pinching,d.fi({kind:"endPinch",event:c}),d.onPinchEnded()),d._rectSelecting&&(delete d._rectSelecting,d.fi({kind:"endRectSelect",event:c}),d.onRectSelectEnded()),d._walking&&(delete d._walking,d.fi({kind:"endWalk",event:c}),d.onWalkEnded()),h.dist=h.point=h.state=h.p3=h.movedata=h.div=h.pendingCS=h._tickTime=h._tickId=h.foward=t}});var qq=function(X){this.gv=X};Ib(qq,X,{_iv:!0,iv:function(){this._iv=!0},face:function(s,e){var m=this,J=m.gv.getGL();if(!J||!im(s))return t;var f=e.x,M=e.width,r=e.height,b=m.height-e.y-r,F=D(M/2),d=new Uint8Array(4*M*r),Z=0;for(m.iv(),m.validate(s),Ac(J,m.frame),J.readPixels(f,b,M,r,J.RGBA,J.UNSIGNED_BYTE,d),Ac(J,t),m.iv();F>=Z;Z++)for(var x=F-Z,g=F+Z,q=x;g>=q;q++)for(var i=x;g>=i;i++)if(q===x||q===g||i===x||i===g){var v=ki.m[d[4*(q*M+i)]];if(v)return v}},get:function(A,o){this.validate();var h=this,F=h.gv.getGL();if(!F)return t;var O,l,G=A.x,c=A.width,B=A.height,i=h.height-A.y-B,V=D(c/2),n=new Uint8Array(4*c*B),U=0,m=n.length,I=o?t:new Me,$=o?t:{};if(Ac(F,h.frame),F.readPixels(G,i,c,B,F.RGBA,F.UNSIGNED_BYTE,n),Ac(F,t),o){for(;V>=U;U++)for(var f=V-U,L=V+U,a=f;L>=a;a++)for(var s=f;L>=s;s++)if((a===f||a===L||s===f||s===L)&&(O=h.info(n,4*(a*c+s))))return O}else for(;m>U;U+=4)O=h.info(n,U),O&&(l=O.data,$[l._id]||(I.add(l),$[l._id]=l));return I},info:function(J,n){return this.colorMap[(J[n]<<24)+(J[n+1]<<16)+(J[n+2]<<8)+J[n+3]]},validate:function(w){var Q=this,X=Q.gv,p=X.getGL();if(p){var J=X.getWidth(),$=X.getHeight(),E=p.RGBA,g=p.TEXTURE_2D,e=p.RENDERBUFFER,d=p.FRAMEBUFFER;Q.texture||(Q.texture=gs(p),Q.render=p.createRenderbuffer(),Q.frame=p.createFramebuffer()),(Q.width!==J||Q.height!==$)&&(bm(p,Q.texture),p.texImage2D(g,0,E,J,$,0,E,p.UNSIGNED_BYTE,t),Rm(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.bindRenderbuffer(e,Q.render),p.renderbufferStorage(e,p.DEPTH_COMPONENT16,J,$),Ac(p,Q.frame),p.framebufferTexture2D(d,p.COLOR_ATTACHMENT0,g,Q.texture,0),p.framebufferRenderbuffer(d,p.DEPTH_ATTACHMENT,e,Q.render),bm(p,t),p.bindRenderbuffer(e,t),Ac(p,t),Q.width=J,Q.height=$),Q._iv&&(Q._iv=!1,Ac(p,Q.frame),X.draw(w||(Q.colorMap={}),1),Ac(p,t))}}});var Yi=function(X){this.gv=X};Ib(Yi,X,{gap:0,size:0,draw:function(F,w){var p=this,e=p.gv,V=e._gridGap,o=e._gridSize;if(e._gridVisible){if(p.gap!==V||p.size!==o){for(var A=[],$=e._gridSize/2,z=V*$,j=0;2*$+1>j;j++){var y=6*j,k=6*(2*$+1)+y;A[y]=-z,A[y+1]=0,A[y+2]=-z+j*V,A[y+3]=z,A[y+4]=0,A[y+5]=-z+j*V,A[k]=-z+j*V,A[k+1]=0,A[k+2]=-z,A[k+3]=-z+j*V,A[k+4]=0,A[k+5]=z}p.vs=new ab(A),p.gap=V,p.size=o}Ef(e),Lg(F,w),Ej(F,w,1,e._gridColor,e._buffer.vs,p.vs),qf(F,0,p.vs.length/3,F.LINES),Xh(F,w)}else p.vs=p.gap=p.size=t}});var ij=function(K){this.gv=K};Ib(ij,X,{draw:function($,c){var G=this.gv,V=G._buffer.vs,X=G._axisXColor,n=G._axisYColor,l=G._axisZColor,N=G._originAxisVisible,y=G._centerAxisVisible;if(N||y){var T=w?$.TRIANGLES:$.TRIANGLE_FAN,A=$.LINES;if(Ef(G),Lg($,c),N){var r=G.getCenterInfo(),v=d(r.width,r.height)/5,B=.8*v,o=.05*v;Ej($,c,1.5,X,V,new ab([0,0,0,v,0,0,B,o,0,B,0,o,B,-o,0,B,0,-o,B,o,0,0,0,0,0,v,0,o,B,0,0,B,o,-o,B,0,0,B,-o,o,B,0,0,0,0,0,0,v,o,0,B,0,o,B,-o,0,B,0,-o,B,o,0,B])),qf($,0,2,A),qf($,1,6,T),Ej($,c,t,n),qf($,7,2,A),qf($,8,6,T),Ej($,c,t,l),qf($,14,2,A),qf($,15,6,T)}if(y){var E=G._center,g=E[0],s=E[1],C=E[2],r=G.getPositionInfo(E);v=d(r.width,r.height)/20,Ej($,c,1.5,X,V,new ab([g,s,C,g+v,s,C,g,s,C,g,s+v,C,g,s,C,g,s,C+v])),qf($,0,2,A),Ej($,c,t,n),qf($,2,2,A),Ej($,c,t,l),qf($,4,2,A)}Xh($,c)}}});var Zd=function(Y){this.gv=Y},Fr="edit_tx",xh="edit_ty",Ub="edit_tz",Ie="edit_rx",uj="edit_ry",sd="edit_rz",Zb="edit_sx",jf="edit_sy",Mi="edit_sz",rr={};rr[Fr]=1,rr[xh]=1,rr[Ub]=1,rr[Ie]=1,rr[uj]=1,rr[sd]=1,rr[Zb]=1,rr[jf]=1,rr[Mi]=1,Ib(Zd,X,{draw:function(W,J,H){var g=this,j=g.gv,v=j.sm().ld();if(j.isEditable(v)&&im(v)&&(!j.isFirstPersonMode()||!j.isMouseRoamable()&&!F)){Ef(j);var E,S,w=j.isMovable(v),r=j.isRotationEditable(v),Q=j.isSizeEditable(v),e=j._axisXColor,A=j._axisYColor,U=j._axisZColor,_=j._editSizeColor,L=j.getCenterInfo(),l=d(L.width,L.height)/10,O=l/(H?5:10),B=.7*l,K=.4*B,V=v.p3(),k=V[0],R=V[1],p=V[2];E=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],w&&g.drawAxis(W,J,v,H,Fr,e,E,[k,R-O,p,k+B,R-O,p,k+B,R,p,k+B,R,p,k,R,p,k,R-O,p,k,R-O,p+O,k+B,R-O,p+O,k+B,R-O,p,k+B,R-O,p,k,R-O,p,k,R-O,p+O]),S=k+B,Q&&g.drawAxis(W,J,v,H,Zb,_,E,[S,R-O,p,S+K,R-O,p,S+K,R,p,S+K,R,p,S,R,p,S,R-O,p,S,R-O,p+O,S+K,R-O,p+O,S+K,R-O,p,S+K,R-O,p,S,R-O,p,S,R-O,p+O]),S+=K,r&&g.drawAxis(W,J,v,H,Ie,e,E,[S,R-O,p,S+K,R-O,p,S+K,R,p,S+K,R,p,S,R,p,S,R-O,p,S,R-O,p+O,S+K,R-O,p+O,S+K,R-O,p,S+K,R-O,p,S,R-O,p,S,R-O,p+O]),E=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],w&&g.drawAxis(W,J,v,H,xh,A,E,[k,R,p,k,R+B,p,k-O,R+B,p,k-O,R+B,p,k-O,R,p,k,R,p,k,R,p,k,R,p-O,k,R+B,p-O,k,R+B,p-O,k,R+B,p,k,R,p]),S=R+B,Q&&g.drawAxis(W,J,v,H,jf,_,E,[k,S,p,k,S+K,p,k-O,S+K,p,k-O,S+K,p,k-O,S,p,k,S,p,k,S,p,k,S,p-O,k,S+K,p-O,k,S+K,p-O,k,S+K,p,k,S,p]),S+=K,r&&g.drawAxis(W,J,v,H,uj,A,E,[k,S,p,k,S+K,p,k-O,S+K,p,k-O,S+K,p,k-O,S,p,k,S,p,k,S,p,k,S,p-O,k,S+K,p-O,k,S+K,p-O,k,S+K,p,k,S,p]),E=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],w&&g.drawAxis(W,J,v,H,Ub,U,E,[k,R,p,k,R,p+B,k,R-O,p+B,k,R-O,p+B,k,R-O,p,k,R,p,k,R-O,p,k-O,R-O,p,k-O,R-O,p+B,k-O,R-O,p+B,k,R-O,p+B,k,R-O,p]),S=p+B,Q&&g.drawAxis(W,J,v,H,Mi,_,E,[k,R,S,k,R,S+K,k,R-O,S+K,k,R-O,S+K,k,R-O,S,k,R,S,k,R-O,S,k-O,R-O,S,k-O,R-O,S+K,k-O,R-O,S+K,k,R-O,S+K,k,R-O,S]),S+=K,r&&g.drawAxis(W,J,v,H,sd,U,E,[k,R,S,k,R,S+K,k,R-O,S+K,k,R-O,S+K,k,R-O,S,k,R,S,k,R-O,S,k-O,R-O,S,k-O,R-O,S+K,k-O,R-O,S+K,k,R-O,S+K,k,R-O,S])}},drawAxis:function(l,m,x,N,o,r,S,Y){var M=this.gv._buffer;ys(l,m,N,!0,x,o),Fl(l,m,t,!0,t,!0,t,!1),Bb(l,m.uDiffuse,r),en(l,M.vs,new ab(Y),m.aPosition),en(l,M.ns,new ab(S),m.aNormal),qf(l,0,12),rn(l,m)}});var Qk=function(o,z){this.gv=o,this.s=function(s,T,Q){return T==t&&(T=Q),T==t?z.getStyle(s):an(T,z,o)},this.data=z};Ib(Qk,X,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},draw:function(q,R,d,y){var Z,J,h,x,I,H,o,r=this,U=r.gv,B=r.data,E=B._id,n=r.s("batch"),e=U._batchIndexMap,S=U._batchModelMap,$=U.isSelectable(B),O=U.getBrightness(B),w=O!=t&&1!==O;if(r._iv){if(h=jd(e,S,B,n),r.validate(h,n?xg[n]||$i:t),h&&(x=e[E],I=x.size=h.vs.length/3-x.begin,o=h.rs))for(O=w?O:1,H=0;I>H;H++)o.push(O);if(im(B)){var j=U.getWireframe(B);j&&we(U,B,j)}r.labelInfo=r.label2Info=r.noteInfo=r.note2Info=r.iconsInfo=t,r.updateLabel(wj,"getLabel"),r.updateLabel(Dm,"getLabel2"),r.updateNote(Er,"getNote"),r.updateNote(aq,"getNote2"),r.updateIcons(),r._iv=!1}w&&Bb(q,R.uBrightness,O),J=ys(q,R,d,$,B,wh),J&&(Xo(J,e[E],S),Xo(J,U._polylineIndexMap[E],U._polylineModelMap),Xo(J,U._wireframeIndexMap[E],U._wireframeModelMap)),e[E]||r.drawBody(q,R,y),(Z=r.labelInfo)&&(ys(q,R,d,$,B,wj),r._drawLabel(Z,wj,y)),(Z=r.label2Info)&&(ys(q,R,d,$,B,Dm),r._drawLabel(Z,Dm,y)),(Z=r.noteInfo)&&(ys(q,R,d,$,B,Er),r._drawNote(Z,Er,y)),(Z=r.note2Info)&&(ys(q,R,d,$,B,aq),r._drawNote(Z,aq,y)),(Z=r.iconsInfo)&&r._drawIcons(q,R,Z,d,$,y),w&&Bb(q,R.uBrightness,1)},validate:function(){},getPartMat:function(){return Tf},drawBody:function(){},dispose:function(){},getBodyColor:function(S){var d=this.data,W=this.gv.getBodyColor(d);return W?W:S?d.getStyle(S):t},updateLabel:function(F,G){var g=this,a=g.data,S=g.gv,c=g.s,W=S[G](a);if(W!=t){var z=c(F+".scale"),X=c(F+".max"),J=g[F+"Info"]={label:W,textureScale:c(F+".texture.scale"),color:S[G+"Color"](a),font:c(F+".font"),background:S[G+"Background"](a)},d=J.rect=_k(J,W);X>0&&X<d.width&&(J.labelWidth=d.width,d.width=X),d.x=d.y=0,d.width*=z,d.height*=z,J.mat=g.getPartMat(c(F+".autorotate"),c(F+".position"),d,c(F+".face"),c(F+".t3"),c(F+".r3"),c(F+".rotationMode"));var j=d.width/2,x=d.height/2;J.vs=new ab([-j,x,0,-j,-x,0,j,-x,0,j,x,0]),d.width/=z,d.height/=z}},updateNote:function(V,S){var k=this,o=k.data,E=k.gv,e=k.s,N=E[S](o);if(N!=t){var l=e(V+".scale"),m=this[V+"Info"]={note:N,textureScale:e(V+".texture.scale"),expanded:e(V+".expanded"),font:e(V+".font"),color:e(V+".color"),borderWidth:e(V+".border.width"),borderColor:e(V+".border.color"),background:E[S+"Background"](o)};if(m.expanded){var X=e(V+".max"),Z=_k(m,N);Z.width+=6,Z.height+=2,X>0&&X<Z.width&&(m.labelWidth=Z.width,Z.width=X);var J={x:-Z.width/2,y:-8-Z.height,width:Z.width,height:Z.height+8}}else J={x:-6,y:-18,width:12,height:18};m.mat=k.getPartMat(e(V+".autorotate"),e(V+".position"),t,e(V+".face"),e(V+".t3"),e(V+".r3"),e(V+".rotationMode")),m.rect=J,1!==l&&(J=Nc(J),J.x*=l,J.height*=l,J.y=-J.height,J.width*=l);var K=J.x,c=J.y,q=J.width,x=J.height;m.vs=new ab([K,-c,0,K,-c-x,0,K+q,-c-x,0,K+q,-c,0])}},_drawLabel:function(D,Q,q){if(q(this.s(Q+".transparent"))){var R=D.rect,S=D.textureScale,f=R.width*S,$=R.height*S;if(f>=1&&$>=1){var z=bb(f,$);1!==S&&(z.translate(z,R.x,R.y),z.scale(S,S),z.translate(z,-R.x,-R.y)),ui(z,D),z.restore(),ke(this,Q,D.mat,D.vs,!0)}}},_drawNote:function(n,b,H){if(H(this.s(b+".transparent"))){var O=n.rect,q=n.textureScale,E=O.x,C=O.y,f=O.width*q,I=O.height*q;if(f>=1&&I>=1){O.x=O.y=0;var S=bb(f,I);1!==q&&S.scale(q,q),ak(S,n),S.restore(),O.x=E,O.y=C,ke(this,b,n.mat,n.vs,!1)}}},_drawIcons:function(J,S,c,V,f,Q){if(c){var Z=this,X=Z.gv,$=Z.data,l=X._buffer,m=X._texture,R=c.icons;for(var W in R){var x=R[W],j=c.rects[W];if(j&&Q(an(x.transparent,$,X))){ys(J,S,V,f,$,W);var w=an(x.shape3d,$,X),L=w?[w]:an(x.names,$,X),A=L?L.length:0,M=an(x.textureScale,$,X)||1,h=an(x.light,$,X);h==t&&(h=w?!0:!1),Fl(J,S,an(x.blend,$,X),h,an(x.opacity,$,X),an(x.reverseFlip,$,X),an(x.reverseColor,$,X),an(x.reverseCull,$,X));for(var B=0;A>B;B++){var d=L[B],Y=j[B];if(Ym(Z,Y.mat),w)Yd(X,$,rk(Z.s,w),Z.s);else{var o=vn(d);if(o){var b=Y.width*M,v=Y.height*M;if(b>=1&&v>=1){var C=bb(b,v);yg(C,o,an(x.stretch,$,X),0,0,b,v,$,X),C.restore(),gs(J,vb,m),Nd(J,S,m,an(x.discardSelectable,$,X),l.uv,Cl),en(J,l.vs,Y.vs,S.aPosition),en(J,l.ns,Gb,S.aNormal),Zn(J,l.is,Uc),Dj(J,0,Uc.length),em(J,S,m)}}}Ei(X)}rn(J,S)}}}}});var fr=function(z,t){Ag(fr,this,[z,t])};Ib(fr,Qk,{getPartMat:function(F,o,R,l,Z,W,B,j,S){var w=this.data,E=Rk(o,w.s3(),R,l,j,S);return te(jl(),E,w.p3(),l,Z,W,B,F,w.r3(),w.getRotationMode())},clear:function(){var I=this;I.faceMat=I.mat=I.shapeModel=I.left=I.right=I.front=I.back=I.top=I.bottom=I.csg=t},validate:function(x,H){var m=this,R=m.gv,X=m.data,T=rk(m.s),e=Gk(X,R.getMat(X),T?m.s("shape3d.scaleable"):!0);if(m.clear(),x){var S=[];T?Rj(R,X,T,m.s,m.getBodyColor(),[e],x,S):(Ki(R,X,x,H,e,s,S,Lm),Ki(R,X,x,H,e,c,S,oj),Ki(R,X,x,H,e,y,S,ec),Ki(R,X,x,H,e,a,S,ds),Ki(R,X,x,H,e,v,S,rp),Ki(R,X,x,H,e,z,S,Jk)),S.length&&(jb(x.vs,S),jb(x.ns,dk(S)))}else m.mat=e,(m.shapeModel=T)||(m.vf(s),m.vf(c),m.vf(v),m.vf(z),m.vf(y),m.vf(a))},vf:function(D){var R=this;if(R.gv.getFaceVisible(R.data,D)){var K=ym(R,D);return K.mat&&(R.faceMat=!0),K}},drawBody:function(g,u,r){var U=this,O=U.gv,N=U.data,c=O._cube,q=U.shapeModel;Ef(O,U.mat),q?Yd(O,N,q,U.s,U.getBodyColor(),r):(en(g,c.vs,t,u.aPosition),en(g,c.ns,t,u.aNormal),Zn(g,c.is),U.drawFace(g,u,U.left,0,r),U.drawFace(g,u,U.front,6,r),U.drawFace(g,u,U.right,12,r),U.drawFace(g,u,U.back,18,r),U.drawFace(g,u,U.top,24,r),U.drawFace(g,u,U.bottom,30,r)),Ei(O),U.faceMat&&(U.drawFace(g,u,U.left,0,r,!0),U.drawFace(g,u,U.front,6,r,!0),U.drawFace(g,u,U.right,12,r,!0),U.drawFace(g,u,U.back,18,r,!0),U.drawFace(g,u,U.top,24,r,!0),U.drawFace(g,u,U.bottom,30,r,!0))
},drawFace:function(v,g,n,i,j,Y){if(n){if(!j(n.transparent))return;if(Y&&!n.mat||!Y&&n.mat)return;Y&&Ef(this.gv,n.mat);var o=this,Z=o.data,E=o.gv,U=E.getTexture(n.texture,Z),D=n.uv,y=n.uvScale,q=n.uvOffset,u=n.discardSelectable;if(U)if(D){for(var L=8*(i/6),A=0;8>A;A++)Wh[L+A]=D[A];Nd(v,g,U,u,E._buffer.uv,Wh,q,y)}else Nd(v,g,U,u,E._cube.uv,t,q,y);Fl(v,g,n.blend,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),Bb(v,g.uDiffuse,n.color),Dj(v,i,6),rn(v,g),em(v,g,U),Y&&Ei(E)}}});var Nl=function(_,O){Ag(Nl,this,[_,O])};Ib(Nl,Qk,{ms_line:1,validate:function(j){var L=this,U=L.gv,o=L.data,c=L.s,O=c("edge.width"),M=o._sourceAgent,K=o._targetAgent;if(L.shapeModel=L.info=t,M&&K){var N,S,$,m,y,T,l,H,g,V,I=o.isLooped(),C=c(Jl),A=b.getEdgeType(C);if(A){var z=A(o,ep(L,U,o,I,C),U,L._sameSourceWithFirstEdge);if(!z.points||z.points.isEmpty())return;T=L.info={},l=z.segments,y=z.points,H=y.size();for(var k=M.getElevation(),i=K.getElevation(),n=0;H>n;n++){var s=y.get(n);s.e==t&&(s.e=k+(i-k)*n/(H-1))}g=Cp(y.get(0)),V=Cp(y.get(H-1));var R=H%2;0===R?(T.c1=Cp(y.get(H/2-1)),T.c2=Cp(y.get(H/2))):T.p3=Cp(y.get((H-R)/2)),T.s1=g,T.s2=Cp(y.get(1)),T.t1=Cp(y.get(H-2)),T.t2=V}else{y=new Me,T=L.info={};var h=c("edge.offset"),Z=c("edge.center"),E=c("edge.source.t3"),v=c("edge.target.t3"),B=M.p3(),F=K.p3();if(E&&(B[0]+=E[0],B[1]+=E[1],B[2]+=E[2]),v&&(F[0]+=v[0],F[1]+=v[1],F[2]+=v[2]),C===io){l=c("edge.segments");var e=T.points=c(wq)||ll;if(H=e.size()){g=Cp(e.get(0)),V=Cp(e.get(H-1)),!Z&&h&&($=id(g,B,!0),h=d(h,Uk(B,g)),B=[B[0]+$[0]*h,B[1]+$[1]*h,B[2]+$[2]*h],$=id(F,V,!0),h=d(h,Uk(V,F)),F=[F[0]-$[0]*h,F[1]-$[1]*h,F[2]-$[2]*h]);var R=H%2;0===R?(N=Cp(e.get(H/2-1)),S=Cp(e.get(H/2))):T.p3=Cp(e.get((H-R)/2)),T.s1=B,T.s2=g,T.t1=V,T.t2=F}else!Z&&h&&($=id(F,B,!0),m=Uk(B,F),h=Fi(h,m),B=[B[0]+$[0]*h,B[1]+$[1]*h,B[2]+$[2]*h],F=[F[0]-$[0]*h,F[1]-$[1]*h,F[2]-$[2]*h]),N=B,S=F;y.add({x:B[0],y:B[2],e:B[1]}),y.addAll(e),y.add({x:F[0],y:F[2],e:F[1]})}else{var W=ep(L,U,o,I,C);if(L._sameSourceWithFirstEdge||(W=-W),I){var G=B[0],u=B[1],X=B[2],x=M.getTall()/2+W;N=[G-W,u+x,X],S=[G+W,u+x,X],y.add({x:G-W,y:X,e:u}),y.add({x:G-W,y:X,e:u+x}),y.add({x:G+W,y:X,e:u+x}),y.add({x:G+W,y:X,e:u})}else{$=id(F,B,!0),m=Uk(B,F);var q={x:B[0],y:B[2]},_={x:F[0],y:F[2]},D=Hd(t,q,_,W),Q=D.x-q.x,f=D.y-q.y;h=Fi(h,m),$[0]*=h,$[1]*=h,$[2]*=h,N=[B[0]+$[0]+Q,B[1]+$[1],B[2]+$[2]+f],S=[F[0]-$[0]+Q,F[1]-$[1],F[2]-$[2]+f],Z?(y.add({x:B[0],y:B[2],e:B[1]}),y.add({x:N[0],y:N[2],e:N[1]}),y.add({x:S[0],y:S[2],e:S[1]}),y.add({x:F[0],y:F[2],e:F[1]})):(y.add({x:N[0],y:N[2],e:N[1]}),y.add({x:S[0],y:S[2],e:S[1]}))}}T.c1=N,T.c2=S}T.list=c(cg)===Hp?L.createTubeModel(y,l,O/2,j):L.createLineModel(y,l,O,"edge","edge.dash")}}});var Yb=function(z,e){Ag(Yb,this,[z,e])};Ib(Yb,fr,{drawBody:function(C,r,M){var i=this,e=i.gv,S=i.shapeModel;Ef(e,i.mat),S?Yd(e,i.data,S,i.s,i.getBodyColor(),M):(or(i,C,r,i.left,M),or(i,C,r,i.front,M),or(i,C,r,i.right,M),or(i,C,r,i.back,M),or(i,C,r,i.top,M),or(i,C,r,i.bottom,M)),Ei(e)},validate:function(Q,X){var K,A,f=this,H=f.s,i=f.data,k=i.p3(),T=i._thickness/2,l=i.isClosePath(),m=i.getPoints(),e=i.getSegments(),C=H(cp),O=Q&&Q.uv;if(f.clear(),0>T)A=f.shapeModel=Bl(m,e,H(_q),H(Qp),C,H(vc),i.getTall(),i.getElevation(),l),H(ai)?H("shape3d.image")||delete A.uv:(delete A.vs,delete A.ns,delete A.uv),H("shape3d.top.image")||delete A.top_uv,H("shape3d.bottom.image")||delete A.bottom_uv;else if(H(cg)===Hp)K=mo(m,e,C,l),A=f.shapeModel={vs:[]},H("shape3d.image")&&(A.uv=[],A.sum=H(vc)||yf(K)||1,A.len=0),H(_q)&&!l&&(A.top_vs=[],H("shape3d.top.image")&&(A.top_uv=[])),H(Qp)&&!l&&(A.bottom_vs=[],H("shape3d.bottom.image")&&(A.bottom_uv=[])),f.iteratePoints(K,T);else{var D,$,U,Y,w,j,B,r,V,u;K=mo(m,e,C,l),w=f.vf(v,O,!1,X),T&&(j=f.vf(z,O,!1,X),B=l?t:f.vf(s,O,!1,X),r=l?t:f.vf(c,O,!1,X),V=f.vf(y,O,!1,X),u=f.vf(a,O,!1,X)),T?f.iteratePoints(K,T):w&&K.forEach(function(Q){if(Y=Q.length,Y>0)for(D=Q[0],U=1;Y>U;U++)$=Q[U],f.addV(w.vs,D,$),D=$}),f.initTUV(K),Q||(w&&(w.ns=dk(w.vs),vm(w,"vs"),vm(w,Ho)),T&&(j&&(j.ns=dk(j.vs),vm(j,"vs"),vm(j,Ho)),B&&(B.ns=dk(B.vs),vm(B,"vs"),vm(B,Ho)),r&&(r.ns=dk(r.vs),vm(r,"vs"),vm(r,Ho)),V&&(V.ns=dk(V.vs),vm(V,"vs"),vm(V,Ho)),u&&(u.ns=dk(u.vs),vm(u,"vs"),vm(u,Ho))))}var o=f.mat=jl();Rq(o,k),El(o,i.r3(),i.getRotationMode()),Rq(o,Gd(k)),Q&&(Nq(f,o,Q,A),f.clear())},initTUV:function(Z){var S,a,r,U,C,T,s,p=this,m=p.front,u=p.back,w=p.top,G=p.bottom,D=m?m.tuv:t,k=u?u.tuv:t,f=w?w.tuv:t,F=G?G.tuv:t,o=0;(D||k||f||F)&&(S=p.s(vc)||yf(Z)||1,Z.forEach(function(x){if(a=x.length,a>0)for(T=x[0],r=1;a>r;r++)s=x[r],U=o/S,o+=Uk(T,s),C=o/S,p.addTUV(m,U,C),p.addTUV(u,1-C,1-U),p.addTUV(w,U,C),p.addTUV(G,U,C),T=s}))},addTUV:function($,I,d){if($){var s=$.uv,j=$.tuv;if(j){if(s)var m=s[0]+(s[6]-s[0])*I,U=s[1]+(s[7]-s[1])*I,b=s[2]+(s[4]-s[2])*I,q=s[3]+(s[5]-s[3])*I,h=s[2]+(s[4]-s[2])*d,J=s[3]+(s[5]-s[3])*d,e=s[0]+(s[6]-s[0])*d,z=s[1]+(s[7]-s[1])*d;else m=I,U=0,b=I,q=1,h=d,J=1,e=d,z=0;j.push(b,q,h,J,e,z,e,z,m,U,b,q)}}},addLRUV:function(Z){var U=Z.uv,D=Z.tuv;D&&(U?D.push(U[2],U[3],U[4],U[5],U[6],U[7],U[6],U[7],U[0],U[1],U[2],U[3]):D.push(0,1,1,1,1,0,1,0,0,0,0,1))},iteratePoints:function(r,f){var z,s,e,J,u,h=this;r.forEach(function(g){if(u=g.length,u>0)for(z={p:g[0],n:!0},J=1;u>J;J++)s=g[J],e=u-1>J?g[J+1]:t,h.addPoint(z,s,e,f,g)})},addPoint:function(L,u,c,$,q){var n,z,b,a,r,B,x,y,T,U=this,C=L.p,V=L.f,m=L.b,i=U.s("shape3d.side")||$c,f=U.s("shape3d.start.angle"),Y=U.shapeModel,j=U.data.isClosePath();if(L.n&&(L.n=!1,V=j&&q.length>2?Hd(q[q.length-2],C,u,$):Hd(t,C,u,$),m=Bf(C,V),Y?Y.top_vs&&U.addCircle(m,V,i,f,Y.top_vs,Y.top_uv):(n=U.left)&&(U.addV(n.vs,m,V),U.addLRUV(n))),z=c?Hd(C,u,c,$):j&&q.length>2?Hd(C,u,q[1],$):Hd(C,u,t,$),b=Bf(u,z),Y){var v,P,S=Y.vs,p=Y.uv,Q=Y.sum;for(p&&(v=Y.len/Q,Y.len+=Uk(C,u),P=Y.len/Q),B=U.getCircle(m,V,i,f),x=U.getCircle(b,z,i,f),y=0;i>y;y++)T=y+1,jb(S,B[T]),jb(S,x[y]),jb(S,B[y]),jb(S,x[y]),jb(S,B[T]),jb(S,x[T]),p&&(a=y/i,r=T/i,p.push(v,r,P,a,v,a,P,a,v,r,P,r));!c&&Y.bottom_vs&&U.addCircle(b,z,i,f,Y.bottom_vs,Y.bottom_uv,!0)}else!c&&(n=U.right)&&(U.addV(n.vs,z,b),U.addLRUV(n)),(n=U.front)&&U.addV(n.vs,V,z),(n=U.back)&&U.addV(n.vs,b,m),(n=U.top)&&U.addH(n.vs,V,z,b,m,!0),(n=U.bottom)&&U.addH(n.vs,m,b,z,V);L.p=u,L.f=z,L.b=b},addCircle:function(O,Q,e,J,q,v,w){var T,b,X=this,k=X.data,C=X.getCircle(O,Q,e,J),M=(O.x+Q.x)/2,R=(O.y+Q.y)/2,B=k.getElevation(),s=0;for(s=0;e>s;s++)w?(jb(q,C[s]),jb(q,C[s+1])):(jb(q,C[s+1]),jb(q,C[s])),jb(q,[M,B,R]),v&&(w?(T=x*(s+1)/e+J,b=x*s/e+J):(T=x*s/e+J,b=x*(s+1)/e+J),v.push(.5-.5*_(b),.5-.5*E(b),.5-.5*_(T),.5-.5*E(T),.5,.5))},getCircle:function(k,I,p,W){for(var b,f,N=this,g=N.data,z=[],S=(k.x+I.x)/2,r=(k.y+I.y)/2,s=g.getTall()/2,T=g.getElevation(),Z=0;p>=Z;Z++)b=x*Z/p+W,f=_(b),z.push([S+(k.x-S)*f,T+s*E(b),r+(k.y-r)*f]);return z},addV:function(T,z,f){var $=z.x,C=z.y,F=f.x,x=f.y,d=this.data,V=d.getElevation(),j=d.getTall()/2;T.push($,V-j,C,F,V-j,x,F,V+j,x,F,V+j,x,$,V+j,C,$,V-j,C)},addH:function(r,X,f,G,z,F){var q=this.data,C=q.getTall()/2,Z=q.getElevation()+(F?C:-C);r.push(X.x,Z,X.y,f.x,Z,f.y,G.x,Z,G.y,G.x,Z,G.y,z.x,Z,z.y,X.x,Z,X.y)},vf:function(Y,T,i,u){var R,l=this,Q=l.gv.getFaceVisible(l.data,Y);return(i||Q)&&(R=ym(l,Y,u),R.vs=[],R.tuv=Q&&(R.texture||T)?[]:t,R.visible=Q),R}});var vo=function(i,h){Ag(vo,this,[i,h])};Ib(vo,Qk,{ms_line:1,validate:function(V){var K=this,u=K.data,Q=K.s,G=u.getPoints(),b=G.size();if(K.shapeModel=K.info=t,b>1){var M=K.info={},S=u.getSegments(),Y=u.getThickness(),T=Cp(G.get(0)),E=Cp(G.get(b-1)),p=b%2;0===p?(M.c1=Cp(G.get(b/2-1)),M.c2=Cp(G.get(b/2))):M.p3=Cp(G.get((b-p)/2)),M.s1=T,M.s2=Cp(G.get(1)),M.t1=Cp(G.get(b-2)),M.t2=E,M.list=Q(cg)===Hp?K.createTubeModel(G,S,Y/2,V):K.createLineModel(G,S,Y,"shape.border","shape.dash")}}}),op(b,{accordionViewExpandIcon:Fo(Zh),accordionViewCollapseIcon:Fo(Zh,!0),accordionViewLabelColor:ko,accordionViewLabelFont:Al,accordionViewTitleBackground:rj,accordionViewSelectBackground:wr,accordionViewSelectWidth:3,accordionViewSeparatorColor:Z,splitViewDividerSize:1,splitViewDividerBackground:rj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ti,rect:[2,2,12,12],background:Zh}]},propertyViewLabelColor:Gn,propertyViewLabelSelectColor:ko,propertyViewLabelFont:Al,propertyViewExpandIcon:Fo(Zj),propertyViewCollapseIcon:Fo(Zj,!0),propertyViewBackground:Eq,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Wd,propertyViewColumnLineColor:Wd,propertyViewSelectBackground:wr,listViewLabelColor:Gn,listViewLabelSelectColor:ko,listViewLabelFont:Al,listViewRowLineVisible:!1,listViewRowLineColor:Wd,listViewSelectBackground:wr,treeViewLabelColor:Gn,treeViewLabelSelectColor:ko,treeViewLabelFont:Al,treeViewExpandIcon:Fo(Hl),treeViewCollapseIcon:Fo(Hl,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Wd,treeViewSelectBackground:wr,tableViewLabelColor:Gn,tableViewLabelSelectColor:ko,tableViewLabelFont:Al,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Wd,tableViewColumnLineColor:Wd,tableViewSelectBackground:wr,treeTableViewLabelColor:Gn,treeTableViewLabelSelectColor:ko,treeTableViewLabelFont:Al,treeTableViewExpandIcon:Fo(Hl),treeTableViewCollapseIcon:Fo(Hl,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Wd,treeTableViewColumnLineColor:Wd,treeTableViewSelectBackground:wr,tableHeaderLabelColor:Gn,tableHeaderLabelFont:Al,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:fp,tableHeaderBackground:Eq,tableHeaderMoveBackground:$f,tableHeaderInsertColor:wr,tableHeaderSortDescIcon:zc(Zj,!0),tableHeaderSortAscIcon:zc(Zj),tabViewTabGap:1,tabViewLabelColor:ko,tabViewLabelFont:Al,tabViewTabBackground:rj,tabViewSelectWidth:3,tabViewSelectBackground:wr,tabViewMoveBackground:$f,tabViewInsertColor:wr,toolbarLabelColor:Gn,toolbarLabelSelectColor:ko,toolbarLabelFont:Al,toolbarBackground:Eq,toolbarSelectBackground:wr,toolbarItemGap:8,toolbarSeparatorColor:xf},!0);var vs={translateX:1,sortColumn:1},gf={sortable:1,sortOrder:1,sortFunc:1},Be={focusData:1},fe={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},He={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},rb=function(P,_){_.add(P),P.hasChildren()&&P.eachChild(function(b){rb(b,_)})},_r=function(V,s,Q,o,$,x,f,H,P,l,R){var K,p=Q.getValueType(),N=Q.getAlign();if(Q.getEnumValues()){var u=Q.toEnumLabel(s),U=db||0,Y=0,n=x,M=b.getTextSize(o,u).width;return K=vn(Q.toEnumIcon(s)),K&&(Y=x+db/2,"center"===N?Y+=(H-(U+M))/2:"right"===N&&(Y=Y+H-(U+M)),xi(V,K,Y,f+P/2),n=Y+db/2),u!=t&&(K?fo(V,u,o,$,n,f,H-(n-x),P):fo(V,u,o,$,x,f,H,P,N)),void 0}return s=Q.formatValue(s),s!=t?p===yn?(hc(V,x,f,H,P,s),void 0):p===Bc||!p&&ed(s)?(K=vn(s?Ue:cs),xi(V,K,x+H/2,f+P/2,l,R),void 0):(fo(V,s,o,$,x,f,H,P,N),void 0):void 0},Cq=function(X,H){var B=H.view,E=B.getDataModel().getHistoryManager(),K=Mp(X),I=H.column||H.property;E&&E.beginInteraction(),H.editor=X,X.info=H,B.setCurrentEditor(X),B.getView().insertBefore(K,B._scrollBarDiv),fg(X,H.editorRect),X.setFocus?X.setFocus():bp(X),X.commitValue=function(){X._itemEditorInstance&&(X=X._itemEditorInstance),B.setValue(H.data,I,X.getValue?X.getValue():X.value),X.close&&X.close(),gi(K)},I.onEditorCreated&&I.onEditorCreated(H)},lq=function(X,w,P,Z,K){var s=Aq(X,P),O=w.value,y=w.view,N=K.getValueType();return s.onblur=s.onchange=function(){y.endEditing()},"input"===X?(O=K.formatValue(O),O!=t&&(s.value=O),s.onkeydown=function(C){eg(C)&&y.endEditing()},(N===ss||N===hk)&&s.addEventListener(Jb,b.numberListener,!1)):X===uc&&Z.forEach(function(v){var f=C.createElement("option");f.innerHTML=K.toEnumLabel(v),f.value=v,K.isEnumEqual(O,v)&&(f.selected=!0),Zc(s,f)}),Cq(s,w),s},qs=p.widget={},Li=function(v,j,s){Ib(J+".widget."+v,j,s)};op(nk,{ms_value:function(m){m.getValue=function(k){var $=this.getItemById(k),s=$.element;return s?s.getValue?s.getValue():s.value:$.selected},m.setValue=function(I,c){var H=this.getItemById(I),B=H.element;B?B.setValue?B.setValue(c):B.value=c:(H.selected=c,this.iv())},m.v=function(I,D){var $=this;if(2===arguments.length)$.setValue(I,D);else{if(!me(I))return $.getValue(I);for(var x in I)$.setValue(x,I[x])}return $}},ms_columnproperty:function(q){q._icon=t,q._accessType=t,q._valueType=t,q._editable=!1,q._batchEditable=!0,q._align=s,q._nullable=!0,q._emptiable=!1,q.setParent=rm,q.formatValue=function(i){var Q=this,q=Q._valueType;if(Q.getEnumValues())return Q.toEnumLabel(i);if(q===Bc)return!!i;if(i!=t){if(q===ss)return I(i);if(Ud(i))return xd(i)}return i},q.setEnum=function(r,X,F,u,D,b){var x=this;r&&r.values&&(u=r.editable,F=r.icons,X=r.labels,D=r.strict,b=r.maxHeight,r=r.values),Go(r)&&(r=r._as),Go(X)&&(X=X._as),Go(F)&&(F=F._as),x._enumValues=r,x._enumLabels=X,x._enumIcons=F,x._enumEditable=u,x._enumStrict=D==t?!0:D,x._enumMaxHeight=b,r&&r.length&&Ud(r[0])&&(x._valueType=hk),x.fp("enum",!1,!0)},q.getEnumMaxHeight=function(){return this._enumMaxHeight},q.isEnumEditable=function(){return this._enumEditable},q.getEnumValues=function(){return this._enumValues},q.getEnumLabels=function(){return this._enumLabels},q.getEnumIcons=function(){return this._enumIcons},q.isEnumStrict=function(){return this._enumStrict},q.isEnumEqual=function(U,z){return this._enumStrict?U===z:U==z},q.toEnumLabel=function(l){var w=this,p=w._enumValues,S=w._enumLabels;if(p&&S)for(var F=0;F<p.length;F++)if(w.isEnumEqual(l,p[F]))return S[F];return l},q.toEnumIcon=function(K){var X=this,G=X._enumValues,V=X._enumIcons;if(G&&V)for(var W=0;W<G.length;W++)if(X.isEnumEqual(K,G[W]))return V[W];return Z}},ms_element:function(K){K.addElement=function(B,r,d,C,y,S){if(B){var n=this,A=n._elements,b=gc(1);n._columnLineVisible&&(y-=1),n._rowLineVisible&&(S-=1),0>=y||0>=S||(n._elements||(A=n._elements={}),A[r]||(A[r]=new Me),fg(b,n.tx()+d,n.ty()+C,y,S),Zc(b,B),n._view.insertBefore(b,n._scrollBarDiv),B.onParentAdded&&B.onParentAdded(b),A[r].add(b))}},K.removeElements=function(){var A=this,I=A._elements;if(I){for(var Z in I)I[Z].each(function(W){gi(W)});delete A._elements}},K.removeElement=function(l){var i=this;if(i._elements){var u=i._elements[l];u&&(u.each(function(e){gi(e)}),delete i._elements[l])}}},ms_cell:function(M){M.getValue=function(B,b){return b.getValue?b.getValue(B,b,this):hf(B,b.getAccessType(),b.getName())},M.setValue=function(n,X,d){if(X.isEmptiable()||""!==d||(d=Z),X.isNullable()||d!=t){var R=this,u=X.getName(),c=X.getAccessType(),J=X.getValueType();J===ss&&ii(d)?d=V(d):J===hk&&ii(d)?d=parseFloat(d):J===Bc&&ii(d)&&(d="true"===d),R._batchEditable&&X._batchEditable&&R.isSelected(n)?R.sm().each(function(f){X.setValue?X.setValue(f,X,d,R):Il(f,c,u,d)}):X.setValue?X.setValue(n,X,d,R):Il(n,c,u,d)}},M.setCurrentEditor=function(U){this.endEditing(),this._currentEditor=U,this.redraw()},M.isEditing=function(x,k){var l=this,d=l._currentEditor;if(!d)return!1;if(k){var Y=d.info;return Y?(Y.column||Y.property)===k&&Y.data===x:!1}return!0},M.endEditing=function(){var O=this,c=O._currentEditor,n=O.getDataModel().getHistoryManager();c&&(delete O._currentEditor,c.commitValue&&c.commitValue(c.info),O.redraw(),n&&n.endInteraction())},M.beginEditing=function(R){this.endEditing();var O=this,u=R.column||R.property;if(u.beginEditing)u.beginEditing(R);else{var E=R.data,X=R.value,M=O.getSelectBackground(E),b=u.getEnumValues(),c=u.getSlider(),s=u.getColorPicker();if(c){var H=wn(qs.Slider,c);return H.setValue(X),H.getView().onblur=function(){O.endEditing()},H.isInstant()&&(H.onValueChanged=function(){O.setValue(E,u,H.getValue())}),Cq(H,R),void 0}if(s||u.getValueType()===yn){var w=wn(qs.ColorPicker,s);return w.setValue(X),w.onClosed=function(){O.endEditing()},w.isInstant()&&(w.onValueChanged=function(L,l){O.setValue(E,u,l)}),Cq(w,R),w.open(),void 0}if(b){if(qs.ComboBox){var D=new qs.ComboBox;D.setValue(X),D.setValues(b),D.setLabels(u.getEnumLabels()),D.setIcons(u.getEnumIcons()),D.setEditable(u.isEnumEditable()),D.setStrict(u.isEnumStrict()),D.setMaxHeight(u.getEnumMaxHeight()),D.onClosed=function(){O.endEditing()},Cq(D,R),D.open()}else lq(uc,R,M,b,u);return}var r=u.getValueType();if(r===Bc||ed(X))return O.setValue(E,u,!X),void 0;if(u.getItemEditor()){var k=Pe(u.getItemEditor()),y=new k(E,u,O,R),d=y.getView();return d._itemEditorInstance=y,y.setValue(X),xe(d),Cq(d,R),y.editBeginning&&y.editBeginning(),void 0}lq("input",R,M,t,u)}}},ms_tablePane:function(G){G.init=function(w){var p=this,v=p.th=new Np(w),d=p._view=gc(1);p.tv=p._tableView=w,Zc(d,v.getView()),Zc(d,w.getView()),v.mp(function(O){O.property===ho&&p.iv()}),p.iv()},G.getTableView=function(){return this.tv},G.getTableHeader=function(){return this.th},G.getDataModel=function(){return this.tv.dm()},G.getColumnModel=function(){return this.tv.getColumnModel()},G.setColumns=function(o){this.tv.setColumns(o)},G.addColumns=function(c){this.tv.addColumns(c)},G.endEditing=function(){this.tv.endEditing()},G.validateImpl=function(){var d=this,v=d.th,u=ul(v),t={x:0,y:0,width:d.getWidth(),height:u};fg(v,t),t.y=u,t.height=n(0,d.getHeight()-u),fg(d.tv,t)}},ms_vs:function(S){S.isVScrollable=function(){return this._viewRect.height<this._scrollHeight},S.showVBar=function(){var f=this;f.isVScrollable()&&(f._vTimer||(N(function(){f.handleVTimeout()},on),f.iv()),f._vTimer=new Date)},S.handleVTimeout=function(){var s=this;if(s._vTimer){var x=new Date;x.getTime()-s._vTimer.getTime()>=on?(delete s._vTimer,s.iv()):N(function(){s.handleVTimeout()},on)}},S.updateVBar=function(){var q=this,k=q._vBar;if(q._vTimer||!q._autoHideScrollBar){k||Zc(q._scrollBarDiv,k=q._vBar=gc());var A=q._viewRect,R=A.height,n=q._scrollHeight,u=q.getScrollBarSize(),S=A.width-u-2,c=R*(-q.ty()/n),g=R*(R/n),s=k.style;n>R?(rc>g&&(c=c+g/2-rc/2,0>c&&(c=0),c+rc>R&&(c=R-rc),g=rc),s.visibility=tb,s.background=q.getScrollBarColor(),s.borderRadius=u/2+Ur,fg(k,S,c,u,g)):s.visibility=Pp}else k&&(k.style.visibility=Pp)}},ms_hs:function(z){z.isHScrollable=function(){return this._viewRect.width<this._scrollWidth},z.showHBar=function(){var I=this;I.isHScrollable()&&(I._hTimer||(N(function(){I.handleHTimeout()},on),I.iv()),I._hTimer=new Date)},z.handleHTimeout=function(){var d=this;if(d._hTimer){var u=new Date;u.getTime()-d._hTimer.getTime()>=on?(delete d._hTimer,d.iv()):N(function(){d.handleHTimeout()},on)}},z.updateHBar=function(){var q=this,i=q._hBar;if(q._hTimer||!q._autoHideScrollBar){i||Zc(q._scrollBarDiv,i=q._hBar=gc());var T=q._viewRect,D=T.width,X=q._scrollWidth,r=q.getScrollBarSize(),$=T.height-r-2,d=D*(-q.tx()/X),U=D*(D/X),b=i.style;X>D?(rc>U&&(d=d+U/2-rc/2,0>d&&(d=0),d+rc>D&&(d=D-rc),U=rc),b.visibility=tb,b.background=q.getScrollBarColor(),b.borderRadius=r/2+Ur,fg(i,d,$,U,r)):b.visibility=Pp}else i&&(i.style.visibility=Pp)}}}),Vh(Ue,vq(16,16,[{type:Qm,rect:[1,1,14,14],background:wr},{type:Yl,rect:[1,1,14,14],width:1,color:xp},{type:zq,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Vh(cs,vq(16,16,{type:Yl,rect:[1,1,14,14],width:1,color:xp})),Vh(Bs,vq(16,16,[{type:cc,rect:[2,2,12,12],borderWidth:1,borderColor:xp,background:"#FFF"},{type:cc,rect:[4,4,8,8],background:wr}])),Vh(yl,vq(16,16,{type:cc,rect:[2,2,12,12],borderWidth:1,borderColor:xp})),nk.ms_list=function(W){W._viewRect=sl,W._scrollHeight=0,W._scrollWidth=0,W.initList=function($){var N=this;N._dirtyRows=new Me,N._rows=new Me,N._rowMap={},N._startRowIndex=0,N._endRowIndex=0,N._view=gc(1),N._canvas=Rd(N._view),Zc(N._view,N._scrollBarDiv=gc()),N.dm($?$:new fq)},W.getCheckIcon=function(X){var t=this.sm(),p=t.co(X);return t.sg()?vn(p?Bs:yl):vn(p?Ue:cs)},W.checkData=function(K){var U=this.sm(),w=U.co(K);U.sg()&&w||(this._checking=1,w?U.rs(K):U.as(K),delete this._checking)},W.getDataAt=function(j){j.target&&(j=this.lp(j));var S=D(j.y/this._rowHeight),l=this._rows;return 0>S||S>=l.size()?t:l.get(S)},W.onDataDoubleClicked=function(){},W.onDataClicked=function(){},W.adjustTranslateX=function(){return 0},W.adjustTranslateY=function(w){var L=this.getHeight()-this._scrollHeight;return L>w&&(w=L),w>0?0:I(w)},W.onPropertyChanged=function(A){var t=this,E=A.property;fe[E]?t.ivm():Be[E]||t.redraw(),E===Sr?t.showHBar():E===Mm&&t.showVBar()},W.getLabel=function(E){return E.toLabel()},W.getLabelFont=function(){return this._labelFont},W.getLabelColor=function(K){var q=this;if(q.isCheckMode()){if(q._focusData===K)return q._labelSelectColor}else if(q.isSelected(K))return q._labelSelectColor;return q._labelColor},W.getStartRowIndex=function(){return this._startRowIndex},W.getEndRowIndex=function(){return this._endRowIndex},W.getRowDatas=function(){return this._rows},W.getRowIndex=function(b){return this._rowMap[b._id]},W.getRowSize=function(){return this._rows.size()},W.getViewRect=function(){return Nc(this._viewRect)},W.isVisible=function(E){return this._visibleFunc?this._visibleFunc(E):!0},W.getCurrentSortFunc=function(){return this._sortFunc},W.setDataModel=function(B){var q=this,k=q._dataModel,S=q._selectionModel;k!==B&&(k&&(k.umm(q.handleDataModelChange,q),k.umd(q.handleDataPropertyChange,q),k.umh(q.handleHierarchyChange,q),S||k.sm().ums(q.handleSelectionChange,q)),q._dataModel=B,B.mm(q.handleDataModelChange,q),B.md(q.handleDataPropertyChange,q),B.mh(q.handleHierarchyChange,q),S?S._setDataModel(B):B.sm().ms(q.handleSelectionChange,q),q.fp("dataModel",k,B))},W.validateModel=function(){var J=this;J._rows.clear(),J._rowMap={},J.buildChildren(J._dataModel._roots);var V=J._rows=J._rows.toList(J.isVisible,J),b=0,K=J.getCurrentSortFunc(),T=V.size();for(K&&V.sort(K);T>b;b++)J._rowMap[V.get(b)._id]=b},W.buildChildren=function(x){var o=this;x.each(function(V){o._rows.add(V),o.buildChildren(V._children)})},W.handleDataModelChange=function(){this.ivm()},W.handleDataPropertyChange=function(g){"parent"===g.property?this.ivm():this.invalidateData(g.data)},W.handleHierarchyChange=function(){this.ivm()},W.handleSelectionChange=function(y){y.datas.each(this.invalidateData,this),this.onSelectionChanged(y)},W.onSelectionChanged=function(D){var F=this,Z=F.sm();!F.isAutoMakeVisible()||1!==Z.size()||"set"!==D.kind&&"append"!==D.kind||F._checking||F.makeVisible(Z.ld())},W.makeVisible=function(o){o&&(this._makeVisibleData=o,this.iv())},W.scrollToIndex=function(v){var M=this,n=M._viewRect,g=n.height,x=M._rowHeight,C=x*v;v>=0&&v<M._rows.size()&&g>0&&(C+x>n.y+g?M.ty(-C+g-x):C<n.y&&M.ty(-C))},W.ivm=function(){this.invalidateModel()},W.invalidateModel=function(){var x=this;x._invalidateModel||(x._invalidateModel=1,x._redrawAll=1,delete x._dirtyMap,x.iv())},W.redraw=function(){var h=this;h._redrawAll||(h._redrawAll=1,delete h._dirtyMap,h.iv())},W.invalidateData=function(S){var Z=this;u?Z.redraw():Z._redrawAll||(Z._dirtyMap||(Z._dirtyMap={}),Z._dirtyMap[S._id]=S,Z.iv())},W.getFocusData=function(){return this._focusData},W.setFocusDataById=function(X){this.setFocusData(this.dm().getDataById(X))},W.setFocusData=function(X){var d=this,G=d._focusData;G!==X&&(d._focusData=X,d.fp("focusData",G,X),G&&d.invalidateData(G),X&&(d.invalidateData(X),d.isAutoMakeVisible()&&d.makeVisible(X)))},W.drawRowBackground=function(M,L,n,P,a,X,m){var p=this,S=p.isCheckMode();(L===p._focusData&&S||n&&!S)&&hc(M,P,a,X,m,p.getSelectBackground(L))},W.drawData=function(J,G,i){var w=this,Q=w._rowHeight,W=Q*i,l=w._viewRect,L=l.x,h=l.width;J.save(),J.beginPath(),J.rect(L,W,h,Q),J.clip(),w.addElement(w.drawRow(J,G,w.isSelected(G),L,W,h,Q),i,L,W,h,Q),J.restore(),w._rowLineVisible&&hc(J,L,W+Q-1,h,1,w._rowLineColor)},W._drawAllRows=function(l){var I=this,b=I._startRowIndex,g=I._viewRect,H=g.x,y=g.y,X=g.width,A=g.height;for(l.beginPath(),l.rect(H,y,X,A),l.clip(),l.clearRect(H,y,X,A),I.removeElements(),I.drawBottomPainters(l);b<I._endRowIndex;b++)I.drawData(l,I._rows.get(b),b);I.drawTopPainters(l)},W._drawDirtyRows=function(a){for(var p,l=this,N=l._rowHeight,P=l._viewRect,y=P.x,o=P.width,U=l._startRowIndex,Y=l._dirtyRows;U<l._endRowIndex;U++)p=l._rows.get(U),l._dirtyMap[p._id]&&Y.add({data:p,index:U});Y.isEmpty()||(a.beginPath(),Y.each(function(m){a.rect(y,m.index*N,o,N)}),a.clip(),Y.each(function(h){a.clearRect(y,h.index*N,o,N)}),Y.each(function(c){l.removeElement(c.index)}),l.drawBottomPainters(a),Y.each(function(S){l.drawData(a,S.data,S.index)}),l.drawTopPainters(a),Y.clear())},W.validateImpl=function(){var E=this,k=E._canvas,p=E.getWidth(),Y=E.getHeight(),I=E._rowHeight,Z=E._redrawAll;(p!==k.clientWidth||Y!==k.clientHeight)&&(eh(k,p,Y),Z=1),E._invalidateModel&&E.validateModel();var z=E._viewRect,j={x:-E.tx(),y:-E.ty(),width:p,height:Y},o=E._rows.size(),u=Yc(k),m=E._makeVisibleData;Z||lf(j,z)||(Z=1),E._viewRect=j,E._scrollHeight=o*I,E._startRowIndex=D(j.y/I),E._endRowIndex=Q((j.y+j.height)/I),E._startRowIndex<0&&(E._startRowIndex=0),E._endRowIndex>o&&(E._endRowIndex=o),E.updateColumnInfos&&Z&&E.updateColumnInfos(),kk(u,E.tx(),E.ty(),1),Z?E._drawAllRows(u):E._dirtyMap&&E._drawDirtyRows(u),E.updateVBar(),E.updateHBar(),u.restore(),E._redrawAll=E._dirtyMap=E._invalidateModel=t,m&&(E.scrollToIndex(E.getRowIndex(m)),delete E._makeVisibleData),E.tx(E.tx()),E.ty(E.ty())}},nk.ms_tree=function(o){o._rootVisible=!0,o._rootData=t,o.initTree=function(){this._expandMap={},this._levelMap={}},o.validateModel=function(){var z=this,s=z._rootData;z._rows.clear(),z._levelMap={},z._rowMap={},z._currentLevel=0,s?z._rootVisible?z.isVisible(s)&&z.buildData(s):z.buildChildren(s):z.buildChildren(),delete z._currentLevel},o.buildData=function(Y){var a=this,K=Y._id,P=a._rows;a._rowMap[K]=P.size(),P.add(Y),a._levelMap[K]=a._currentLevel,a.isExpanded(Y)&&(a._currentLevel++,a.buildChildren(Y),a._currentLevel--)},o.buildChildren=function(M){var k=this,b=M?M._children:k._dataModel._roots,s=k.getCurrentSortFunc();s&&k.isChildrenSortable(M)?b.toList(k.isVisible,k).sort(s).each(k.buildData,k):b.each(function(j){k.isVisible(j)&&k.buildData(j)})},o.getLevel=function(t){return this._levelMap[t._id]},o.getToggleIcon=function(d){var k=this,W=k._loader,O=k._collapseIcon;return W&&!W.isLoaded(d)?O:d.hasChildren()?k.isExpanded(d)?k._expandIcon:O:t},o.isCheckMode=function(){return this._checkMode!=t},o.isChildrenSortable=function(){return!0},o.handleDataModelChange=function(Q){var $=this;Q.kind===Ve?delete $._expandMap[Q.data._id]:Q.kind===Yn&&($._expandMap={}),$.ivm()},o.toggle=function(i){var t=this;t.isExpanded(i)?t.collapse(i):t.expand(i)},o.isExpanded=function(o){return 1===this._expandMap[o._id]},o.expand=function(Y){var P=this,n=P._loader;P.isExpanded(Y)||(n&&!n.isLoaded(Y)&&n.load(Y),P._expandMap[Y._id]=1,P.ivm(),P.onExpanded(Y))},o.onExpanded=function(){},o.collapse=function(x){var C=this;C.isExpanded(x)&&(delete C._expandMap[x._id],C.ivm(),C.onCollapsed(x))},o.onCollapsed=function(){},o.expandAll=function(){var v=this;v._dataModel.each(function(U){U.hasChildren()&&(v._expandMap[U._id]=1)}),v.ivm()},o.collapseAll=function(){this._expandMap={},this.ivm()},o.makeVisible=function(t){if(t){var h=this;if(!h._rootData||t.isDescendantOf(h._rootData)){for(var b=t._parent;b;)h.expand(b),b=b._parent;h._makeVisibleData=t,h.iv()}}},o.checkData=function(r){var I,u=this,p=u._checkMode,P=u.sm(),y=P.co(r);if(!P.sg()||!y){if(u._checking=1,p===M)y?P.rs(r):P.as(r);else if(p===Tb)I=new Me(r),I.addAll(r._children);else if("descendant"===p)I=new Me,rb(r,I);else if("all"===p&&(I=new Me,rb(r,I),!y))for(var b=r._parent;b;)I.add(b),b=b._parent;I&&(y?P.rs(I):P.as(I)),delete u._checking}},o.drawTree=function(X,h,i,H,M,P,C){var l=this,j=l._indent,K=l._levelMap[h._id],Z=l.getIconWidth(h),W=vn(l.getToggleIcon(h));W?(H+=j*K,xi(X,W,H+j/2,M+C/2,h,l),H+=j):H+=j*(K+1),l._checkMode&&(xi(X,l.getCheckIcon(h),H+j/2,M+C/2,h,l),H+=j),l.drawIcon(X,h,H,M,Z,C),l.drawLabel(X,h,H+Z,M,C)}},nk.ms_listtree=function(l){l.getIcon=function(M){return M.getIcon()},l.getIconWidth=function(e){return this.getIcon(e)?this._indent:0},l.drawIcon=function(p,M,s,P,D,T){if(D){var o=this,L=o.getBodyColor(M),e=vn(o.getIcon(M),L);e&&(T-=o.isRowLineVisible()?1:0,yg(p,e,xm,s,P,D,T,M,o,L),Ji(p,o.getBorderColor(M),s,P,D,T))}},l.drawLabel=function(s,v,w,K,T){var M=this;fo(s,M.getLabel(v),M.getLabelFont(v),M.getLabelColor(v),w,K,0,T)}},nk.ms_table=function(B){B.initTable=function(){var S=this,N=S._columnModel=new fq;S._columnInfos=new Me,N.mm(S.handleColumnModelChange,S),N.md(S.handleColumnPropertyChange,S),N.mh(S.handleColumnHierarchyChange,S)},B.setColumns=function(i){this._columnModel.clear(),this.addColumns(i)},B.addColumns=function(U){var n=this._columnModel;U.forEach(function(G){if(!(G instanceof oq)){var M=Pe(G.className);G=wn(M?M:oq,G)}n.add(G)})},B.onColumnClicked=function(){},B.onCheckColumnClicked=function(){},B.getColumnInfo=function(S){for(var K,h=0,F=this._columnInfos,f=F.size();f>h;h++)if(K=F.get(h),K.column===S)return K;return t},B.getColumnAt=function(Y){var U=this.getColumnInfoAt(Y);return U?U.column:t},B.getColumnInfoAt=function(X){for(var f=this,x=X.target?f.lp(X).x:X.x,s=f._columnInfos,i=0;i<s.size();i++){var W=s.get(i),a=W.startX;if(x>=a&&x<a+W.column.getWidth())return W}return t},B.getToolTip=function(h){var a=this,i=a.getDataAt(h),X=a.getColumnAt(h);return i&&X?X.getToolTip(i,a):t},B.adjustTranslateX=function(w){var l=this.getWidth()-this._scrollWidth;return l>w&&(w=l),w>0?0:I(w)},B.updateColumnInfos=function(){var $=this,j=$._viewRect,X=$._columnInfos;X.clear(),$._scrollWidth=0,$._columnModel._roots.each(function(w){if(w.isVisible()){var u=$._scrollWidth+w.getWidth();$._scrollWidth<=j.x+j.width&&u>=j.x&&X.add({column:w,startX:$._scrollWidth}),$._scrollWidth=u}})},B.drawData=function(q,v,a){var H=this,k=H._rowHeight,E=k*a,T=H.isSelected(v),h=H._viewRect,B=h.x,F=h.width;H.drawRowBackground(q,v,T,B,E,F,k),H._columnInfos.each(function(L){var m=L.column,s=L.startX,t=m.getWidth();t>0&&!H.isEditing(v,m)&&(q.save(),q.beginPath(),q.rect(s,E,t,k),q.clip(),H.addElement(H.drawCell(q,v,T,m,s,E,t,k),a,s,E,t,k),H._columnLineVisible&&hc(q,s+t-1,E,1,k,H._columnLineColor),q.restore())}),H._rowLineVisible&&hc(q,B,E+k-1,F,1,H._rowLineColor)},B.drawCell=function(X,B,p,b,T,U,e,J){var o=this;if(b.drawCell)return b.drawCell(X,B,p,b,T,U,e,J,o);var Z=o.getValue(B,b);_r(X,Z,b,o.getLabelFont(B,b,Z),o.getLabelColor(B,b,Z),T,U,e,J,B,o)},B.getColumnModel=function(){return this._columnModel},B.handleColumnModelChange=function(){this.redraw()},B.handleColumnPropertyChange=function(w){var E=this;w.data===E._sortColumn&&gf[w.property]?E.ivm():(E.showHBar(),E.redraw())},B.handleColumnHierarchyChange=function(){this.redraw()},B.getCurrentSortFunc=function(){var B=this,K=B._sortColumn;if(K&&K.isSortable()){var X=K.getSortFunc(),U=Qg===K.getSortOrder()?1:-1;return X||(X=ip),function(R,_){return X.call(B,B.getValue(R,K),B.getValue(_,K),R,_)*U}}return B._sortFunc},B.isCellEditable=function(m,Q){return Q.isEditable()&&this.isEditable()},B.checkEditing=function(Q,v){if(kf(v))for(var J=this,s=J.lp(v),S=J._columnInfos,p=J._rowHeight,A=J._viewRect,P=A.x,X=A.y,_=A.width,e=A.height,L=0;L<S.size();L++){var x=S.get(L),m=x.startX,B=x.column,D=B.getWidth();if(B!==J._checkColumn&&B!==J._treeColumn&&J.isCellEditable(Q,B)&&s.x>=m&&s.x<m+D){var b={x:m,y:J.getRowIndex(Q)*p,width:D,height:p},R={x:b.x+J.tx(),y:b.y+J.ty(),width:b.width,height:b.height},t=0,$=0;return b.x<P?t=b.x-P:b.x+b.width>P+_&&(t=b.x+b.width-P-_),t&&(J.tx(J.tx()-t),R.x-=t),b.y<X?$=b.y-X:b.y+p>X+e&&($=b.y+p-X-e),$&&(J.ty(J.ty()-$),R.y-=$),J.beginEditing({data:Q,column:B,value:J.getValue(Q,B),event:v,rect:b,editorRect:R,view:J}),void 0}}}},qs.BaseItemEditor=function(H,t,C,o){this._data=H,this._column=t,this._master=C,this._editInfo=o},Li("BaseItemEditor",X,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var xb=p.Tab=function(){Ag(xb,this)};Qr("Tab",pc,{ms_ac:["view","closable","disabled"],_icon:t,_closable:!1,_disabled:!1,setParent:rm});var oq=p.Column=function(){Ag(oq,this)};Qr("Column",pc,{ms_columnproperty:1,ms_ac:["accessType","valueType",tb,sn,gb,Zk,"align",yn,"sortOrder",kj,"sortable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Qg,_sortFunc:t,_sortable:!0,setWidth:function(A){16>A&&(A=16);var g=this._width;this._width=A,this.fp(Zk,g,A)},getToolTip:function(h,n){return this.formatValue(n.getValue(h,this))}});var ri=p.Property=function(){Ag(ri,this)};Qr("Property",pc,{ms_columnproperty:1,ms_ac:["accessType","valueType",sn,gb,"categoryName",yn,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:t,getToolTip:function(Q,y,l){var p=this;
return y?p.formatValue(l.getValue(Q,p)):l.getPropertyName(p)}}),qs.AccordionView=function(){var v=this;v._titleMap={},v._titleList=new Me,v._currentTitle=t,v._currentView=t,v._currentContent=t,v._view=gc(),v.iv()},Li("AccordionView",X,{ms_v:1,ms_fire:1,ms_ac:[ad,mh,"titleHeight",pp,ee,"titleBackground","selectWidth",Xg,"orientation","separatorColor"],_expandIcon:b.accordionViewExpandIcon,_collapseIcon:b.accordionViewCollapseIcon,_titleHeight:$o,_labelColor:b.accordionViewLabelColor,_labelFont:b.accordionViewLabelFont,_titleBackground:b.accordionViewTitleBackground,_selectBackground:b.accordionViewSelectBackground,_selectWidth:b.accordionViewSelectWidth,_orientation:"v",_separatorColor:b.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._titleList},getCurrentTitle:function(){return this._currentTitle},add:function(u,T,y,$){var w=this,s=gc();if(w._titleMap[u])throw u+" already exists";s.onmousedown=Vk,s.style.cursor=Mr,s.addEventListener(F?$g:to,function(g){Vk(g)},!1),s.addEventListener(F?Vf:Wi,function(i){Vk(i),kf(i)&&(w._currentTitle===u?w.collapse():w.expand(u))},!1),Zc(w._view,s),w._titleMap[u]={content:T,div:s,canvas:Rd(s),icon:$},w._titleList.add(u),y&&w.expand(u),w.iv()},remove:function(U){var l=this,y=l._titleMap[U];y&&(gi(y.div),delete l._titleMap[U],l._titleList.remove(U),l.iv())},clear:function(){var N=this;N._titleMap={},N._titleList.clear(),N.iv()},isExpanded:function(e){return this._currentTitle===e},expand:function(j){var x=this;x._titleMap[j]&&x._currentTitle!==j&&(x._currentTitle=j,x.onExpanded(j),x.iv())},onExpanded:function(){},collapse:function(){var v=this;v._currentTitle&&(v.onCollapsed(v._currentTitle),delete v._currentTitle,v.iv())},onCollapsed:function(){},initCanvas:function(S,k,I){eh(S,k,I);var a=Yc(S);return kk(a,0,0,1),a.clearRect(0,0,k,I),a},drawTitle:function(L,z,$,o,H){var E=this,h=vn(H.icon),j=E.isExpanded(z),q=E._titleHeight,u=E._titleBackground,Q=E._selectWidth,Z=E._separatorColor,W=vn(j?E._expandIcon:E._collapseIcon),y=Q+4;hc(L,0,0,$,o,u),j&&Q&&hc(L,0,0,Q,o,E._selectBackground),(j||E._titleList.get(E._titleList.size()-1)!==z)&&hc(L,0,o-1,$,1,Z?Z:zo(u)),h&&(xi(L,h,y+Do(h)/2,q/2),y+=Do(h)+2),fo(L,z,E.getLabelFont(z),E.getLabelColor(z),y,0,0,q),W&&xi(L,W,$-Do(W)/2-4,q/2)},validateImpl:function(){var s=this,c=s._view,g=0,r=0,w=s.getWidth(),A=s.getHeight(),_=s._titleHeight,O=s._titleList.size()*_,m=s._currentContent,y=s._currentView;delete s._currentContent,delete s._currentView,s._titleList.each(function(K){var v,u,b=s._titleMap[K],I=b.content,m=s._currentTitle===K;Kd(s)?(fg(b.div,g,0,_,A),v=s.initCanvas(b.canvas,_,A),Ap(v,0,A),$p(v,-P),s.drawTitle(v,K,A,_,b),v.restore(),m?(u=n(0,w-O),I&&(s._currentContent=I,s._currentView=Mp(I),fg(I,g+_,0,u,A)),g+=_+u):g+=_):(fg(b.div,0,r,w,_),v=s.initCanvas(b.canvas,w,_),s.drawTitle(v,K,w,_,b),v.restore(),m?(u=n(0,A-O),I&&(s._currentContent=I,s._currentView=Mp(I),fg(I,0,r+_,w,u)),r+=_+u):r+=_)});var f=s._currentView;m&&m!==s._currentContent&&m.endEditing&&m.endEditing(),f&&f!==y&&Zc(c,f),y&&y!==f&&gi(y)}}),qs.SplitView=function($,S,f,G){var o=this,R=o._dividerDiv=gc(),z=o._toggleLeftCanvas=Rd(),v=o._toggleRightCanvas=Rd(),O=z.style,g=v.style;o._view=gc(1),Zc(o._view,R),O.msTouchAction=hj,O.pointerEvents=hj,O.cursor=Mr,g.msTouchAction=hj,g.pointerEvents=hj,g.cursor=Mr,$&&o.setLeftView($),S&&o.setRightView(S),f&&o.setOrientation(f),G!=t&&o.setPosition(G),o.setStatus(je),new tr(o)},Li("SplitView",X,{ms_v:1,ms_fire:1,ms_ac:["dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:b.splitViewDividerSize,_dividerBackground:b.splitViewDividerBackground,_dragOpacity:b.splitViewDragOpacity,_toggleIcon:b.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(x,S){var m=this,F=m._position;isNaN(x)||(S||(m._valueScope=0>x?-1:x>1?1:0),m._position=x,m.fp(Ol,F,x))},getLeftView:function(){return this._leftView},setLeftView:function(d){var Q=this,K=Q._leftView,H=Q._view;if(Q._leftView!==d){if(K&&K!==Q._rightView){var a=Mp(K);a.parentNode===H&&gi(a)}if(Q._leftView=d,d){var k=Mp(d);k.parentNode!==H&&H.insertBefore(k,Q._dividerDiv)}Q.fp("leftView",K,d)}},getRightView:function(){return this._rightView},setRightView:function(y){var t=this,B=t._rightView,F=t._view;if(t._rightView!==y){if(B&&B!==t._leftView){var W=Mp(B);W.parentNode===F&&gi(W)}if(t._rightView=y,y){var s=Mp(y);s.parentNode!==F&&F.insertBefore(s,t._dividerDiv)}t.fp("rightView",B,y)}},validateImpl:function(){var p=this,m=p._draggable,M=p._position,C=p.getWidth(),f=p.getHeight(),l=p._dividerSize,O=p._dividerBackground,Q=F?18:8,L=p._dividerDiv,v=p._valueScope,t=p._toggleLeftCanvas,_=p._toggleRightCanvas,j=p._toggleIcon,z=p._status,W=L.style,x=null,g=F?20:4,D=j.comps[0];l>=Q||0===l?p._coverDiv&&(gi(p._coverDiv),delete p._coverDiv):p._coverDiv||(p._coverDiv=gc(),w&&(p._coverDiv.style.background=Zr),Zc(L,p._coverDiv)),p._togglable?t.parentNode||(Zc(L,t),Zc(L,_)):(gi(t),gi(_));var Y=p._coverDiv,G=p._leftView,A=p._rightView;if(Kd(p)){if(l>C&&(l=C),z===je)if(1===v)var e=M,J=n(0,C-l-e);else-1===v?(J=-M,e=n(0,C-l-J)):(e=I((C-l)*M),J=n(0,C-l-e));else"cl"===z?(e=0,J=n(0,C-l)):"cr"===z&&(J=0,e=n(0,C-l));G&&fg(G,0,0,e,f),A&&fg(A,e+l,0,J,f),fg(L,e,0,l,f),p._absPosition=e,Y&&(fg(Y,l/2-Q/2,0,Q,f),Y.style.cursor=m?ik:""),L.style.cursor=m?ik:"";var S=L.clientHeight/2,h=L.clientWidth;eh(t,h,h),fg(t,0,S-h-g,h,h),x=Yc(t),kk(x,0,0,1),D.rotation=-P,Bk(x,j,0,0,h,h),x.restore(),eh(_,h,h),fg(_,0,S+g,h,h),x=Yc(_),kk(x,0,0,1),D.rotation=P,Bk(x,j,0,0,h,h),x.restore()}else{if(l>f&&(l=f),z===je)if(1===v)var r=M,k=n(0,f-l-r);else-1===v?(k=-M,r=n(0,f-l-k)):(r=I((f-l)*M),k=n(0,f-l-r));else"cl"===z?(r=0,k=n(0,f-l)):"cr"===z&&(k=0,r=n(0,f-l));G&&fg(G,0,0,C,r),A&&fg(A,0,r+l,C,k),fg(L,0,r,C,l),p._absPosition=r,Y&&(fg(Y,0,l/2-Q/2,C,Q),Y.style.cursor=m?Sp:""),W.cursor=m?Sp:"";var d=L.clientWidth/2,h=L.clientHeight;eh(t,h,h),fg(t,d-h-g,0,h,h),x=Yc(t),kk(x,0,0,1),D.rotation=0,Bk(x,j,0,0,h,h),x.restore(),eh(_,h,h),fg(_,d+g,0,h,h),x=Yc(_),kk(x,0,0,1),D.rotation=R,Bk(x,j,0,0,h,h),x.restore()}W.background=O}});var tr=function(T){this.sv=T,this.addListeners()};Ib(tr,X,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(M){var c=this,p=c.sv,h=p._dividerDiv,b=p._toggleLeftCanvas,w=p._toggleRightCanvas,T=p._status,D=M.target;if(D===b)T===je?p.setStatus("cl"):"cr"===T&&p.setStatus(je);else if(D===w)T===je?p.setStatus("cr"):"cl"===T&&p.setStatus(je);else if(Bh(M)&&(D===h||D===p._coverDiv)&&(Vk(M),p.isDraggable())){c.resizeDiv=gc();var U=c.resizeDiv.style,A=h.style;U.left=A.left,U.top=A.top,U.width=A.width,U.height=A.height,U.opacity=p.getDragOpacity(),U.background=p.getDividerBackground(),c.clientValue=c._lastPosition=Kd(p)?Rg(M).x:Rg(M).y,Zc(c.getView(),c.resizeDiv),c._clientPoint=Rg(M),ns(c,M)}},handleWindowTouchMove:function(E){if(Bh(E)){var i=this,J=i.sv,h=J._dividerSize,p=i.resizeDiv.style,o=J.getWidth(),K=J.getHeight(),y=J._absPosition-i._lastPosition;Kd(J)?(i.clientValue=Rg(E).x,y+=i.clientValue,y>o-h&&(y=o-h),0>y&&(y=0),p.left=y+Ur):(i.clientValue=Rg(E).y,y+=i.clientValue,y>K-h&&(y=K-h),0>y&&(y=0),p.top=y+Ur)}},handleWindowTouchEnd:function(o){var Q=this,j=Q.sv,P=j._absPosition-Q._lastPosition+Q.clientValue,K=j._dividerSize,c=Kd(j)?j.getWidth():j.getHeight(),H=j._valueScope,_=Uk(Q._clientPoint,Rg(o));_>1&&(j.setStatus(je),0>P&&(P=0),P>c-K&&(P=c-K),c!==K&&(1===H?j.setPosition(P,1):-1===H?j.setPosition(P-c+K,1):j.setPosition(P/(c-K),1))),gi(Q.resizeDiv),Q.resizeDiv=Q.clientValue=Q._clientPoint=t},handle_mousedown:function(z){kf(z)&&this.handle_touchstart(z)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)}}),qs.TabView=function(){var S=this,h=S._view=gc(1),e=S._titleDiv=gc(1),P=S._tabModel=new fq,m=P.sm(),b=S.invalidate;S._tabInfos=new Me,S._canvas=Rd(e),Zc(h,e),Zc(h,S._contentDiv=gc(1)),m.setSelectionMode(o),m.ms(b,S),P.mm(b,S),P.md(b,S),P.mh(b,S),new cf(S),S.iv()},Li("TabView",X,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",pp,ee,"tabBackground","selectWidth",Xg,"moveBackground","insertColor"],_tabPosition:y,_tabHeight:$o,_tabGap:b.tabViewTabGap,_labelColor:b.tabViewLabelColor,_labelFont:b.tabViewLabelFont,_tabBackground:b.tabViewTabBackground,_selectWidth:b.tabViewSelectWidth,_selectBackground:b.tabViewSelectBackground,_moveBackground:b.tabViewMoveBackground,_insertColor:b.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._contentDiv},getTitleDiv:function(){return this._titleDiv},getTabModel:function(){return this._tabModel},add:function(a,z,N){var U=new xb,R=this._tabModel;return U.setName(a),U.setView(z),R.add(U),N&&R.sm().ss(U),U},getLabel:function(X){return X.toLabel()},onPropertyChanged:function(){this.iv()},setMovingTabInfo:function(Q){this._movingTabInfo=Q,this.iv()},get:function(P){var w=this,F=w._tabModel;if(Ud(P))return F._roots.get(P);if(ii(P)){var D;return F.each(function(U){P===w.getLabel(U)&&(D=U)}),D}return P instanceof xb?P:t},select:function(l){this._tabModel.sm().ss(this.get(l))},remove:function(s){var d=this;if(s=d.get(s)){var X=d._tabModel,S=X._roots.indexOf(s);d._tabModel.remove(s),d.selectOne(--S)}},getCurrentTab:function(){return this._currentTab},hideTabView:function(N,P){P.parentNode===this._contentDiv&&(Zf(P)?(P.style.display=rd,P._tab_=N):gi(P),oe())},showTabView:function(h,A){Zf(A)&&(A.style.display="block",A._tab_=h),A.parentNode!==this._contentDiv&&(Zc(this._contentDiv,A),oe())},updateTabView:function(){var B,h=this,E=h._currentTab,c=h._currentView,Y=h._tabModel.sm().ld();Y&&(B=Mp(Y.getView())),B!==c&&(c&&(E.getView().endEditing&&E.getView().endEditing(),h.hideTabView(E,c)),B&&h.showTabView(Y,B)),h._currentTab=Y,h._currentView=B,E!==Y&&h.onTabChanged(E,Y)},onTabChanged:function(){},onTabClosed:function(S,Z){this.selectOne(--Z)},selectOne:function(F){var q=this,e=q._tabModel,O=e.size();if(O&&!e.sm().ld()){F==t&&(F=0),F>=O&&(F=O-1),0>F&&(F=0);for(var p=F;p>=0;p--){var k=q.get(p);if(!k.isDisabled())return q.select(k),k}for(p=F+1;O>p;p++)if(k=q.get(p),!k.isDisabled())return q.select(k),k}},getTabWidth:function(n){var w=4,c=vn(n.getIcon());c&&(w+=Do(c,n)+4);var H=this.getLabel(n);return H&&(w+=nb(this.getLabelFont(n),H).width+4),n.isClosable()&&(w+=10),w},drawTab:function(Z,n,V,_,u,E,I){var g,d=this,Y=d._tabPosition,l=V+4,B=d._selectWidth,w=vn(n.getIcon()),p=n.isDisabled(),X=d.getLabelColor(n),e=d.getLabelFont(n),h=d.getLabel(n),t=d._selectBackground,W=Y===s+"-vertical",k=Y===c+"-vertical";(W||k)&&(l=_+4),p&&(Z.globalAlpha=Wj),hc(Z,V,_,u,E,I),n===d._currentTab&&B&&(Y===y?hc(Z,V,_+E-B,u,B,t):Y===s?hc(Z,V+u-B,_,B,E,t):Y===c?hc(Z,V,_,B,E,t):W?hc(Z,V+u-B,_,B,E,t):k?hc(Z,V,_,B,E,t):hc(Z,V,_,u,B,t));var b=u/2;if(W&&(Ap(Z,b,_+E/2),$p(Z,R),Ap(Z,-b,-_-E/2)),w){var i=xk(w,n),U=Do(w,n);if(W||k){var Q=V+u/2,D=l+i/2;Ap(Z,Q,D),$p(Z,P),Ap(Z,-Q,-D),xi(Z,w,V+u/2,l+i/2,n,d),Ap(Z,Q,D),$p(Z,-P),Ap(Z,-Q,-D),l+=i+4}else xi(Z,w,l+U/2,_+E/2,n,d),l+=U+4}return W||k?(Ap(Z,u/2,l+u/2),$p(Z,P),Ap(Z,-u/2,-l-u/2),fo(Z,h,e,X,V,l,E,u),Ap(Z,u/2,l+u/2),$p(Z,-P),Ap(Z,-u/2,-l-u/2)):fo(Z,h,e,X,l,_,u,E),W&&(Ap(Z,b,_+E/2),$p(Z,-R),Ap(Z,-b,-_-E/2)),n.isClosable()&&(Z.strokeStyle=X,Z.lineWidth=1,Z.beginPath(),k?(Z.moveTo(V+u-10,_+E-4),Z.lineTo(V+u-4,_+E-10),Z.moveTo(V+u-4,_+E-4),Z.lineTo(V+u-10,_+E-10),Z.stroke(),g={x:V+u-12,y:_+E-12,width:12,height:12}):(Z.moveTo(V+u-10,_+4),Z.lineTo(V+u-4,_+10),Z.moveTo(V+u-4,_+4),Z.lineTo(V+u-10,_+10),Z.stroke(),g={x:V+u-12,y:_,width:12,height:12})),p&&(Z.globalAlpha=1),g},validateImpl:function(){var k=this;k.updateTabView();var u,D=k._canvas,K=k._tabPosition,T=k._titleDiv,M=k._contentDiv,Z=k._tabModel,P=k.getWidth(),F=k.getHeight(),I=k._tabHeight,L=k._tabInfos,r=k._tabGap,p=K===y,t=K===s,V=K===a,U=K===c,h=K===s+"-vertical",i=K===c+"-vertical",j=k._movingTabInfo,q=0;if((t||U)&&Z._roots.each(function(Z){q=n(k.getTabWidth(Z),q)}),p?(fg(T,0,0,P,I),u={x:0,y:I,width:P,height:n(0,F-I)}):t?(fg(T,0,0,q,F),u={x:q,y:0,width:n(0,P-q),height:F}):U?(fg(T,P-q,0,q,F),u={x:0,y:0,width:n(0,P-q),height:F}):h?(fg(T,0,0,I,F),u={x:I,y:0,width:n(0,P-I),height:F}):i?(fg(T,P-I,0,I,F),u={x:0,y:0,width:n(0,P-I),height:F}):(fg(T,0,F-I,P,I),u={x:0,y:0,width:P,height:n(0,F-I)}),fg(M,u),h||i){k._currentView&&(u.x=0,fg(k._currentTab.getView(),u)),eh(D,I,F);var O=Yc(D),C=0;if(kk(O,0,k.ty(),1),O.clearRect(0,0,I,F),L.clear(),Z._roots.each(function(T){var A,U=k.getTabWidth(T);j&&j.tab===T||(A=k.drawTab(O,T,0,C,I,U,k._tabBackground),A&&i&&(A.x=P-12)),L.add({closeRect:A,tab:T,startY:C,endY:C+U,height:U}),C+=U+r}),k._sumHeight=n(0,C-r),j){var S=j.position;k.drawTab(O,j.tab,0,j.startY,I,j.height,k._moveBackground),hc(O,0,S,I,1,k._insertColor)}O.restore(),k.ty(k.ty())}else if(t||U){k._currentView&&(u.x=0,fg(k._currentTab.getView(),u)),eh(D,q,F);var O=Yc(D),C=0;if(kk(O,0,k.ty(),1),O.clearRect(0,0,q,F),L.clear(),Z._roots.each(function(a){var v;j&&j.tab===a||(v=k.drawTab(O,a,0,C,q,I,k._tabBackground),v&&U&&(v.x=P-12)),L.add({closeRect:v,tab:a,startY:C,endY:C+I,height:I}),C+=I+r}),k._sumHeight=n(0,C-r),j){var S=j.position;k.drawTab(O,j.tab,0,j.startY,q,j.height,k._moveBackground),hc(O,0,S,q,1,k._insertColor)}O.restore(),k.ty(k.ty())}else{k._currentView&&(u.y=0,fg(k._currentTab.getView(),u)),eh(D,P,I);var O=Yc(D),b=0;if(kk(O,k.tx(),0,1),O.clearRect(0,0,P,I),L.clear(),Z._roots.each(function(o){var q,z=k.getTabWidth(o);j&&j.tab===o||(q=k.drawTab(O,o,b,0,z,I,k._tabBackground),q&&V&&(q.y=F-I)),L.add({closeRect:q,tab:o,startX:b,endX:b+z,width:z}),b+=z+r}),k._sumWidth=n(0,b-r),j){var S=j.position;k.drawTab(O,j.tab,j.startX,0,j.width,I,k._moveBackground),vh(O,k._insertColor,S,0,I)}O.restore(),k.tx(k.tx())}for(var W=[],g=M.children,d=0;d<g.length;d++){var m=g[d],N=m._tab_;N&&!Z.contains(N)&&W.push(m)}W.forEach(function(N){M.removeChild(N)})}});var cf=function(Q){this.tv=Q,this.addListeners()};Ib(cf,X,{ms_listener:1,getView:function(){return this.tv._titleDiv},handle_mousewheel:function(X){this.handleScroll(X,10*(X.wheelDelta/40))},handle_DOMMouseScroll:function(F){this.handleScroll(F,10*-F.detail)},handleScroll:function(j,M){Vk(j);var n=this.tv,z=n._tabPosition;!n.isHScrollable()||z!==y&&z!==a||n.tx(this.tv.tx()+M),!n.isVScrollable()||z!==s&&z!==c&&z!==s+"-vertical"&&z!==c+"-vertical"||n.ty(this.tv.ty()+M)},getTabInfoAt:function(G){var x,Z,F=this.tv,q=F._tabPosition,B=F._tabInfos;if(q===y||q===a){var w=F.lp(G).x;for(x=0;x<B.size();x++)if(Z=B.get(x),Z.startX<=w&&w<=Z.endX)return Z}else if(q===s||q===c||q===s+"-vertical"||q===c+"-vertical"){var o=F.lp(G).y;for(x=0;x<B.size();x++)if(Z=B.get(x),Z.startY<=o&&o<=Z.endY)return Z}return t},isClickable:function(i){var b=this.tv,z=b._tabPosition,X=this.tabInfo=this.getTabInfoAt(i);return!b.isHScrollable()||z!==y&&z!==a?!b.isVScrollable()||z!==s&&z!==c&&z!==s+"-vertical"&&z!==c+"-vertical"?X&&(!X.tab.isDisabled()||b.isMovable()):!0:!0},handle_mousemove:function(K){var z=this;Fh?z.tabInfo2=z.getTabInfoAt(K):z.getView().style.cursor=z.isClickable(K)?Mr:""},handle_mousedown:function(B){this.handle_mousemove(B),this.handle_touchstart(B)},handle_touchstart:function(q){var m=this,b=m.tv,p=b._tabPosition;Vk(q),m.isClickable(q)&&(p===y||p===a?(m.x=Rg(q).x,m.lp=b.lp(q),m.tx=b.tx()):(m.y=Rg(q).y,m.lp=b.lp(q),m.ty=b.ty()),ns(m,q))},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(B){var h,Q=this,u=Q.tv,T=u._tabPosition,_=Q.tabInfo;if(T===y||T===a){if(h=Rg(B).x-Q.x,!Q.translating&&!Q.moving&&g(h)>2&&(u.isHScrollable()&&!is(B)?Q.translating=1:_&&u.isMovable()&&(Q.moving=1)),Q.translating)u.tx(Q.tx+h);else if(Q.moving){var e=Q.lp.x+h,D=u._tabGap/2;u._tabInfos.each(function(W){var b=W.endX,v=e-W.startX<b-e;e>=W.startX&&b>=e&&u.setMovingTabInfo({tab:_.tab,startX:_.startX+h,width:_.width,front:v,insertTab:W.tab,position:v?n(0,W.startX-D):d(u._sumWidth,b+D)})})}}else if(h=Rg(B).y-Q.y,!Q.translating&&!Q.moving&&g(h)>2&&(u.isVScrollable()&&!is(B)?Q.translating=1:_&&u.isMovable()&&(Q.moving=1)),Q.translating)u.ty(Q.ty+h);else if(Q.moving){var k=Q.lp.y+h,D=u._tabGap/2;u._tabInfos.each(function(I){var l=I.endY,Q=k-I.startY<l-k;k>=I.startY&&l>=k&&u.setMovingTabInfo({tab:_.tab,startY:_.startY+h,height:_.height,front:Q,insertTab:I.tab,position:Q?n(0,I.startY-D):d(u._sumHeight,l+D)})})}},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(){var P=this,r=P.tv,H=r._tabPosition,J=r.getTabModel(),G=J._roots,g=P.tabInfo;if(P.moving){var R=r._movingTabInfo;if(R&&R.insertTab!==R.tab){var p=R.tab,K=G.remove(p),A=G.indexOf(R.insertTab);A>=0&&(R.front||A++,A<=G.size()&&(G.add(p,A),J.fireHierarchyChange(p,K,A)))}r.setMovingTabInfo(t),delete P.moving}else if(!P.translating&&g){p=g.tab;var x=P.tabInfo2;if(!x||x.tab===p)if(!p.isDisabled()&&qn(g.closeRect,P.lp)){var Y=G.indexOf(p);J.remove(p),r.onTabClosed(p,Y)}else p.isDisabled()||r._currentTab===p||J.sm().ss(p)}P.translating=P.tabInfo=P.tabInfo2=H===y||H===a?P.x=P.lp=P.tx=t:P.y=P.lp=P.ty=t}}),qs.PropertyView=function(S){var G=this;G._view=gc(1),G._canvas=Rd(G._view),Zc(G._view,G._scrollBarDiv=gc()),G._rows=new Me,G._categories=new Me,G._categoryMap={},G._historyMap={};var t=G._propertyModel=new fq,f=G.ivm;t.mm(f,G),t.md(f,G),t.mh(f,G),G.dm(S?S:new fq),new Dr(G)},Li("PropertyView",X,{ms_ac:[pp,si,ee,sn,gb,"categorizable",fb,kj,np,ad,mh,Bd,Xl,jq,"selectRowIndex",Xg,"background",ws,xl,ao,fk,Ye],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_element:1,ms_cell:1,ms_tip:1,_viewRect:sl,_scrollHeight:0,_columnLineX:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:db,_background:b.propertyViewBackground,_expandIcon:b.propertyViewExpandIcon,_collapseIcon:b.propertyViewCollapseIcon,_scrollBarColor:$q,_scrollBarSize:uo,_autoHideScrollBar:ce,_selectBackground:b.propertyViewSelectBackground,_rowHeight:Nk,_rowLineVisible:b.propertyViewRowLineVisible,_rowLineColor:b.propertyViewRowLineColor,_columnPosition:.5,_columnLineVisible:b.propertyViewColumnLineVisible,_columnLineColor:b.propertyViewColumnLineColor,_labelColor:b.propertyViewLabelColor,_labelSelectColor:b.propertyViewLabelSelectColor,_labelFont:b.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._columnPosition},setColumnPosition:function(i){0>i&&(i=0),i>1&&(i=1);var S=this,e=S._columnPosition;S._columnPosition=i,S.fp("columnPosition",e,i)},getPropertyName:function(O){return O.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Y,n,P){return P===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(B,v){return v===this._selectRowIndex?this._labelSelectColor:B.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(U){var w=this.getHeight()-this._scrollHeight;return w>U&&(U=w),U>0?0:I(U)},isExpanded:function(t){if(!t)return!0;var O=this._categoryMap[t];return O?O.isExpanded:!(this._historyMap[t]===!1)},toggle:function(v){var O=this;O.isExpanded(v)?O.collapse(v):O.expand(v)},expandAll:function(){this.validate();for(var O in this._categoryMap)this.expand(O)},expand:function(z){if(z&&z!==rd){var T=this,H=T._categoryMap[z];H&&!H.isExpanded&&(H.isExpanded=!0,T.onExpanded(z),T.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var T in this._categoryMap)this.collapse(T)},collapse:function(h){if(h&&h!==rd){var n=this,F=n._categoryMap[h];F&&F.isExpanded&&(F.isExpanded=!1,n.onCollapsed(h),n.ivm())}},onCollapsed:function(){},getCategoryName:function(a){if(!this.isCategorizable())return rd;var T=a.getCategoryName();return T?T:rd},getPropertyModel:function(){return this._propertyModel},setDataModel:function(h){var o=this,O=o._dataModel;O!==h&&(O&&(O.umd(o.handlePropertyChange,o),o._selectionModel||O.sm().ums(o.ivm,o)),o._dataModel=h,h.md(o.handlePropertyChange,o),o._selectionModel?o._selectionModel._setDataModel(h):h.sm().ms(o.ivm,o),o.fp(Cr,O,h))},isVisible:function(C){return this._visibleFunc?this._visibleFunc(C):!0},onPropertyChanged:function(C){var V=this,T=C.property;He[T]?V.ivm():V.iv(),T===Mm&&V.showVBar()},getCurrentData:function(){return this._currentData},updateCurrentData:function(){this._currentData=this.sm().ld()},getRawProperties:function(){return this._currentData?this._propertyModel._roots:ll},handlePropertyChange:function(A){this._currentData===A.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var o=this;o._invalidateModel||(o.setSelectRowIndex(-1),o._invalidateModel=1,o.iv())},redraw:function(){this.iv()},validateModel:function(){var C=this,H=C._rows,S=C._categories,f={},e=new Me,D=C._currentData;C.updateCurrentData(),D!==C._currentData&&C.endEditing(),H.clear(),S.clear(),C.getRawProperties().each(function(G){if(C.isVisible(G)){e.add(G);var j=C.getCategoryName(G);f[j]||(S.add(j,j===rd?0:Z),f[j]={isExpanded:C.isExpanded(j),properties:new Me})}}),C._sortFunc&&e.sort(C._sortFunc);for(var l in C._categoryMap)C._historyMap[l]=C.isExpanded(l);C._categoryMap=f,S.each(function(A){A!==rd&&H.add(A);var M=f[A];M.isExpanded&&e.each(function(T){C.getCategoryName(T)===A&&(M.properties.add(T),H.add({property:T,data:C._currentData}))},C)})},validateImpl:function(){var l=this;l.removeElements(),l._invalidateModel&&(l.validateModel(),delete l._invalidateModel);var p=l._canvas,m=l.getWidth(),i=l.getHeight(),V=-l.ty(),h=l._rowHeight,G=l._indent,q=m-G,n=l._rows,M=n.size(),U=l._columnLineX=G+q*l._columnPosition,g=l._scrollHeight=M*h;eh(p,m,i),l._viewRect={x:0,y:V,width:m,height:i},l._startRowIndex=D(V/h),l._endRowIndex=Q((V+i)/h),l._startRowIndex<0&&(l._startRowIndex=0),l._endRowIndex>M&&(l._endRowIndex=M);var x,v=Yc(p),F=l._background;kk(v,0,-V,1),v.beginPath(),v.rect(0,V,m,i),v.clip(),v.clearRect(0,V,m,i),l.drawBottomPainters(v),F&&hc(v,0,0,G,g,F);for(var y=l._startRowIndex;y<l._endRowIndex;y++){var r=n.get(y),V=h*y;if(ii(r))F&&hc(v,G,V,q,h,F),x=vn(l.isExpanded(r)?l._expandIcon:l._collapseIcon),x&&yg(v,x,xm,0,V,G,h),v.save(),v.beginPath(),v.rect(G,V,q,h),v.clip(),l.drawCategoryName(v,r,y,G,V,q,h),v.restore();else{var z=r.property,P=r.data,x=vn(z.getIcon()),w=l._selectRowIndex===y?l.getSelectBackground():t;if(x&&yg(v,x,xm,0,V,G,h),w&&hc(v,G,V,q,h,w),v.save(),v.beginPath(),v.rect(G,V,U-G,h),v.clip(),l.drawPropertyName(v,z,y,G,V,U-G,h),v.restore(),!l.isEditing(P,z)){var e=U+1,X=m-U-1;v.save(),v.beginPath(),v.rect(e,V,X,h),v.clip(),l.addElement(l.drawPropertyValue(v,z,l.getValue(P,z),y,e,V,X,h,P),y,e,V,X,h),v.restore()}}l._rowLineVisible&&hc(v,G,V+h-1,q,1,l._rowLineColor)}l._columnLineVisible&&(hc(v,U,0,1,g,l._columnLineColor),hc(v,m-1,0,1,g)),l.drawTopPainters(v),l.updateVBar(),v.restore(),l.ty(l.ty())},drawCategoryName:function(M,T,J,a,j,S,p){fo(M,T,this.getCategoryFont(T),this.getCategoryColor(T),a,j,S,p)},drawPropertyName:function(i,f,c,O,k,V,y){return f.drawPropertyName?(f.drawPropertyName(i,f,c,O,k,V,y,this),void 0):(fo(i,this.getPropertyName(f),this.getPropertyFont(f,c),this.getPropertyColor(f,c),O,k,V,y),void 0)},drawPropertyValue:function(E,z,h,C,A,q,n,P,Z){return z.drawPropertyValue?z.drawPropertyValue(E,z,h,C,A,q,n,P,Z,this):(_r(E,h,z,this.getLabelFont(z,h,C),this.getLabelColor(z,h,C),A,q,n,P,Z,this),void 0)},isPropertyEditable:function(b){return b.isEditable()&&this.isEditable()},setProperties:function(F){this._propertyModel.clear(),this.addProperties(F)},addProperties:function(a){if(a){var X=this._propertyModel;a.forEach(function(m){if(!(m instanceof ri)){var b=Pe(m.className);m=wn(b?b:ri,m)}X.add(m)})}},getRowIndexAt:function(q){var X=this,J=D(X.lp(q).y/X._rowHeight);return J>=0&&J<X._rows.size()?J:-1},getPropertyAt:function(R){var $=this,S=$.getRowIndexAt(R);return S>=0?$._rows.get(S).property:t},getToolTip:function(c){var $=this,J=$.getPropertyAt(c),O=$._currentData;return J&&O?J.getToolTip(O,$._columnLineX<$.lp(c).x,$):t}});var Dr=function(L){this.pv=L,this.addListeners()};Ib(Dr,X,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(W){this.getView().style.cursor=W},clear:function(){var n=this;n.state=n.cp=n.ty=n.p=t,n.setCursor(M)},handle_mousedown:function(W){this.handle_touchstart(W)},handle_touchstart:function(_){var S=this,v=S.pv;Vk(_),v.setFocus(_)&&(kf(_)?(S.cp=Rg(_),S.ty=v.ty(),S.p=v.getColumnPosition(),S.handle_touchmove(_)):v.setSelectRowIndex(v.getRowIndexAt(_)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(E){this.handle_touchend(E)},handle_touchend:function(W){var v=this;if(v.cp&&!v.state){var n=v.pv,S=n.lp(W),H=S.x,L=S.y,Q=n._indent,V=n.getRowIndexAt(W),p=n._columnLineX;if(V>=0){var y=n._rowHeight,Y=y*V,$=n._rows.get(V),D=$.property;if(ii($))vn(n.isExpanded($)?n._expandIcon:n._collapseIcon)&&H>=0&&Q>=H&&L>=Y&&Y+y>=L?n.toggle($):Zp(W)&&n.toggle($);else if(H>p&&n.isPropertyEditable(D)){var k={x:p+1,y:Y,width:n.getWidth()-p-1,height:y},C={x:k.x+n.tx(),y:k.y+n.ty(),width:k.width,height:k.height};n.beginEditing({data:$.data,property:D,value:n.getValue($.data,D),event:W,rect:k,editorRect:C,view:n})}}n.setSelectRowIndex(V)}v.clear()},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(l){var f=this,O=f.pv,v=f.ty,S=f.cp,G=Rg(l),m=f.state;if("p"===m)O.setTranslateY(v+G.y-S.y);else if("c"===m){var r=O.getWidth()-O._indent;if(r>16){var d=f.p-(S.x-G.x)/r,n=16/r;n>d&&(d=n),d>1-n&&(d=1-n),O.setColumnPosition(d)}}else"s"===m&&O.setTranslateY(v+(S.y-G.y)*O._scrollHeight/O._viewRect.height)},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(j){if(!Fh&&kf(j)){var i=this,v=i.pv,n=g(v.lp(j).x-v._columnLineX)<=(F?8:3);i.cp?i.state||(n?(i.state="c",ns(i)):g(Rg(j).y-i.cp.y)>=2&&(i.state=i.isV(j)?"s":"p",ns(i))):(n?i.setCursor(ik):i.setCursor(M),i.isV(j)&&v.showVBar())}},isV:function(N){var v=this.pv,z=v._viewRect;return v.isVScrollable()&&z.x+z.width-v.lp(N).x<dg},handle_mousewheel:function(G){this.handleScroll(G,G.wheelDelta/40)},handle_DOMMouseScroll:function(P){2===P.axis&&this.handleScroll(P,-P.detail)},handleScroll:function(g,z){var T=this.pv;Vk(g),T.endEditing(),T.translate(0,z*T.getRowHeight())},handle_keydown:function(M){var C=this.pv,P=C._rows.size(),X=C._selectRowIndex+(aj(M)?-1:1);(aj(M)||Nj(M))&&(0>X&&(X=0),X>=P&&(X=P-1),C.setSelectRowIndex(X))}}),qs.ListView=function(F){this.initList(F),new Wo(this)},Li("ListView",X,{ms_ac:[pp,si,ee,ws,fb,xl,ao,kj,np,Bd,Xl,jq,Hh,Xg],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,ms_list:1,ms_listtree:1,ms_dm:1,ms_element:1,_checkMode:!1,_indent:db,_rowHeight:Nk,_rowLineVisible:b.listViewRowLineVisible,_rowLineColor:b.listViewRowLineColor,_scrollBarColor:$q,_scrollBarSize:uo,_autoMakeVisible:ug,_autoHideScrollBar:ce,_selectBackground:b.listViewSelectBackground,_labelColor:b.listViewLabelColor,_labelSelectColor:b.listViewLabelSelectColor,_labelFont:b.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(e){var U=this,E=U._checkMode;U._checkMode=e,U.fp(Qc,E,e)},drawRow:function(Z,v,O,J,w,N,n){var S=this,G=0,U=S._indent,Y=S.getIconWidth(v);S.drawRowBackground(Z,v,O,J,w,N,n),S._checkMode&&(xi(Z,S.getCheckIcon(v),G+U/2,w+n/2,v,S),G+=U),S.drawIcon(Z,v,G,w,Y,n),S.drawLabel(Z,v,G+Y,w,n)}});var Wo=function(K){this.list=K,this.addListeners()};Ib(Wo,X,{ms_listener:1,getView:function(){return this.list._view},clear:function(X){var C=this;X&&"d"===C.state&&C.list.handleDragAndDrop(X,"end"),C.state=C.cp=C.tx=C.ty=t},handle_mousedown:function(y){this.handle_touchstart(y)},handle_touchstart:function(i){var K=this,d=K.list;if(Vk(i),d.setFocus(i))if(K.cp=Rg(i),K.tx=d.tx(),K.ty=d.ty(),kf(i))K.isV(i)||K.isH(i)||!d.handleDragAndDrop||d.handleDragAndDrop(i,"prepare");else{var M=d.getDataAt(i);M&&K.handleSelectMode(i,M),K.clear(i)}},handleWindowMouseUp:function(c){this.clear(c)},handleWindowTouchEnd:function(t){this.clear(t)},handle_mouseup:function(N){this.handle_touchend(N)},handle_touchend:function(t){var I=this,L=I.list;if(I.cp&&!I.state){var w=L.getDataAt(t);w&&(L.isCheckMode()?I.handleCheckMode(t,w):I.handleSelectMode(t,w),Zp(t)?L.onDataDoubleClicked(w,t):L.onDataClicked(w,t))}I.clear(t)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(I){var R=this,z=R.list,J=R.state,_=R.tx,D=R.ty,c=R.cp,S=Rg(I),d=z._viewRect;"p"===J?z.setTranslate(_+S.x-c.x,D+S.y-c.y):"v"===J?z.ty(D+(c.y-S.y)*z._scrollHeight/d.height):"h"===J?z.tx(_+(c.x-S.x)*z._scrollWidth/d.width):"d"===J&&z.handleDragAndDrop(I,"between")},handle_mousemove:function(z){this.handle_touchmove(z)},handle_touchmove:function(J){if(!Fh&&kf(J)){var S=this,f=S.list,$=S.isV(J),k=S.isH(J);if(S.cp){if(!S.state){if(Uk(Rg(J),S.cp)<2)return;$?S.state="v":k?S.state="h":f.handleDragAndDrop?(S.state="d",f.handleDragAndDrop(J,"begin")):S.state="p",ns(S)}}else $&&f.showVBar(),k&&f.showHBar()}},isV:function(q){var y=this.list,Z=y._viewRect;return y.isVScrollable()&&Z.x+Z.width-y.lp(q).x<dg},isH:function(P){var O=this.list,h=O._viewRect;return O.isHScrollable()&&h.y+h.height-O.lp(P).y<dg},handle_mousewheel:function(e){this.handleScroll(e,e.wheelDelta/40,e.wheelDelta!==e.wheelDeltaX)},handle_DOMMouseScroll:function(u){this.handleScroll(u,-u.detail,1)},handleScroll:function(t,m,Y){var K=this.list;Vk(t),K.endEditing&&K.endEditing(),Y&&K.isVScrollable()?K.translate(0,m*K.getRowHeight()):K.isHScrollable()&&K.translate(10*m,0)},handle_keydown:function(X){var d,T=this.list,S=T.sm(),b=T._rows,W=b.size();if(Jn(X))T.selectAll();else if(mg(X))T.handleDelete&&T.handleDelete(X);else if(wo(X))T.isCheckMode()&&(d=T.getFocusData(),d&&T.checkData(d));else if(aj(X)||Nj(X)){var f=T.isCheckMode();if(d=f?T.getFocusData():S.ld()){var k=T.getRowIndex(d);k>=0&&(aj(X)?0!==k&&(d=b.get(k-1),f?T.setFocusData(d):S.ss(d)):k!==W-1&&(d=b.get(k+1),f?T.setFocusData(d):S.ss(d)))}else W>0&&(d=b.get(0),f?T.setFocusData(d):S.ss(d))}},handleCheckMode:function(P,I){var Z=this.list,N=Z.lp(P).x;return N>=0&&N<=Z._indent?(Z.checkData(I),void 0):(Z.setFocusData(I),void 0)},handleSelectMode:function(E,Y){var O=this.list,i=O.sm(),h=i.ld();if(is(E))O.isSelected(Y)?i.rs(Y):i.as(Y);else if(Vm(E))if(h)for(var F=O.getRowIndex(h),e=O.getRowIndex(Y);F!==e;)F+=e>F?1:-1,i.as(O._rows.get(F));else i.ss(Y);else(kf(E)||!i.contains(Y))&&i.ss(Y)}}),qs.TreeView=function(W){var N=this;N.initTree(),N.initList(W),new Sq(N)},Li("TreeView",X,{ms_ac:[pp,si,ee,"rootVisible",Qc,"rootData",kj,np,Bd,Xl,jq,fb,ws,xl,ao,ad,mh,Hh,Xg,"loader"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,ms_list:1,ms_dm:1,ms_tree:1,ms_listtree:1,ms_element:1,_checkMode:t,_indent:db,_rowHeight:Nk,_rowLineVisible:b.treeViewRowLineVisible,_rowLineColor:b.treeViewRowLineColor,_scrollBarColor:$q,_scrollBarSize:uo,_autoHideScrollBar:ce,_expandIcon:b.treeViewExpandIcon,_collapseIcon:b.treeViewCollapseIcon,_autoMakeVisible:ug,_selectBackground:b.treeViewSelectBackground,_labelColor:b.treeViewLabelColor,_labelSelectColor:b.treeViewLabelSelectColor,_labelFont:b.treeViewLabelFont,drawRow:function(F,W,f,l,$,K,b){var E=this;E.drawRowBackground(F,W,f,l,$,K,b),E.drawTree(F,W,f,0,$,K,b)}});var Sq=function(s){Ag(Sq,this,[s])};Ib(Sq,Wo,{toggle:function(h,o,Z,Q){var d=this.list,u=d.lp(h).x;if(vn(d.getToggleIcon(o))){var e=Z*Q;if(u>=e&&e+Z>=u)return d.toggle(o),!0}return Zp(h)?(d.toggle(o),!0):!1},handleCheckMode:function(T,V){var W=this.list,D=W.lp(T).x,Q=W._levelMap[V._id],e=W._indent,i=e*(Q+1);return D>=i&&i+e>=D?(W.checkData(V),void 0):(this.toggle(T,V,e,Q)||W.setFocusData(V),void 0)},handleSelectMode:function(k,v){var J=this,A=J.list;J.toggle(k,v,A._indent,A.getLevel(v))||Sq.superClass.handleSelectMode.call(J,k,v)
},handle_keydown:function(o){if(_c(o)||Qj(o)){var b=this.list,Y=b._rows,N=b.isCheckMode(),E=b.sm(),P=N?b.getFocusData():E.ld();P?P.hasChildren()&&(_c(o)?b.collapse(P):b.expand(P)):Y.size()>0&&(P=Y.get(0),N?b.setFocusData(P):E.ss(P))}else Sq.superClass.handle_keydown.call(this,o)}});var Tm=qs.TableView=function(i){this.initTable(),this.initList(i),new Cb(this)};Li("TableView",X,{ms_ac:[pp,si,ee,"sortMode",sn,gb,ws,xl,ao,fk,Ye,"sortColumn",kj,np,Bd,Xl,jq,Hh,Xg],ms_v:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,ms_list:1,ms_dm:1,ms_tip:1,ms_table:1,ms_element:1,ms_cell:1,_sortMode:Wp,_editable:!0,_batchEditable:!1,_rowHeight:Nk,_rowLineVisible:b.tableViewRowLineVisible,_rowLineColor:b.tableViewRowLineColor,_columnLineVisible:b.tableViewColumnLineVisible,_columnLineColor:b.tableViewColumnLineColor,_scrollBarColor:$q,_scrollBarSize:uo,_autoHideScrollBar:ce,_autoMakeVisible:ug,_selectBackground:b.tableViewSelectBackground,_labelColor:b.tableViewLabelColor,_labelSelectColor:b.tableViewLabelSelectColor,_labelFont:b.tableViewLabelFont,getCheckColumn:function(){var Z=this;if(!Z._checkColumn){var M=Z._checkColumn=new oq;M.setEditable(!0),M.setWidth(40),M.getValue=Z.getCheckColumValue,M.drawCell=Z.drawCheckColumnCell}return Z._checkColumn},isCheckMode:function(){return this._columnModel.contains(this._checkColumn)},setCheckMode:function(Y){var W=this,M=W._columnModel,G=W.getCheckColumn();Y!==W.isCheckMode()&&(Y?M.add(G,0):M.remove(G),W.fp(Qc,!Y,Y))},getCheckColumValue:function(w,E,G){return G.isSelected(w)},drawCheckColumnCell:function(F,x,J,N,m,y,l,e,V){xi(F,V.getCheckIcon(x),m+l/2,y+e/2,x,V)}});var Cb=function(u){Ag(Cb,this,[u])};Ib(Cb,Wo,{handleCheckMode:function(h,E){var a=this.list,x=a._checkColumn;if(a.isCellEditable(E,x)){var N=a.getColumnInfo(x),m=a.lp(h).x;if(N&&m>=N.startX&&m<N.startX+x.getWidth())return a.checkData(E),void 0}a.setFocusData(E),a.checkEditing(E,h)},handleSelectMode:function(_,F){Cb.superClass.handleSelectMode.apply(this,arguments),this.list.checkEditing(F,_)}});var Hj=qs.TreeTableView=function(T){var y=this,q=y._treeColumn=new oq;y.initTree(),y.initTable(),y.initList(T),q.setDisplayName("Name"),q.setEditable(!0),q.setWidth(180),q.drawCell=ms,q.getValue=eq,y._columnModel.add(q),new fs(y)},ms=function(K,C,b,z,v,P,Q,R,t){t.drawTree(K,C,b,v,P,Q,R)},eq=function(z,$,P){return P.getLabel(z)};Li("TreeTableView",X,{ms_ac:[pp,si,ee,"sortMode",sn,gb,fb,Qc,"rootData","rootVisible",kj,np,"sortColumn",ad,mh,Bd,Xl,jq,Hh,ao,ws,xl,fk,Ye,Xg,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,ms_painter:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,ms_list:1,ms_dm:1,ms_tip:1,ms_table:1,ms_tree:1,ms_listtree:1,ms_element:1,ms_cell:1,_sortMode:Wp,_checkMode:t,_editable:!0,_batchEditable:!1,_indent:db,_rowHeight:Nk,_rowLineVisible:b.treeTableViewRowLineVisible,_rowLineColor:b.treeTableViewRowLineColor,_columnLineVisible:b.treeTableViewColumnLineVisible,_columnLineColor:b.treeTableViewColumnLineColor,_expandIcon:b.treeTableViewExpandIcon,_collapseIcon:b.treeTableViewCollapseIcon,_scrollBarColor:$q,_scrollBarSize:uo,_autoHideScrollBar:ce,_autoMakeVisible:ug,_selectBackground:b.treeTableViewSelectBackground,_labelColor:b.treeTableViewLabelColor,_labelSelectColor:b.treeTableViewLabelSelectColor,_labelFont:b.treeTableViewLabelFont,getTreeColumn:function(){return this._treeColumn}});var fs=function(P){Ag(fs,this,[P])};Ib(fs,Wo,{handleCheckMode:function(_,P){var R=this.list,C=R._treeColumn,H=R.getColumnInfo(C),x=R.lp(_).x;if(H){var q=R._indent,D=H.startX+q*R.getLevel(P);if(vn(R.getToggleIcon(P))&&x>=D&&D+q>=x)return R.toggle(P),void 0;if(R.isCellEditable(P,C)&&(D+=q,x>=D&&D+q>=x))return R.checkData(P),void 0}R.setFocusData(P),R.checkEditing(P,_)},handleSelectMode:function(j,k){var q=this.list,C=q.lp(j).x;if(vn(q.getToggleIcon(k))){var G=q.getColumnInfo(q._treeColumn);if(G){var f=q._indent,M=G.startX+f*q.getLevel(k);if(C>=M&&M+f>=C)return q.toggle(k),void 0}}fs.superClass.handleSelectMode.apply(this,arguments),q.checkEditing(k,j)}});var Np=qs.TableHeader=function(A){var j=this,O=j._view=gc(1),S=j._columnModel=A.getColumnModel(),F=j.iv;j.tv=j._tableView=A,j._columnInfos=new Me,j._canvas=Rd(O),O.style.background=b.tableHeaderBackground||"",O.style.height=_b+Ur,S.mm(F,j),S.md(F,j),S.mh(F,j),A.mp(function(D){vs[D.property]&&j.iv()},j),new Ir(j),j.iv()};Li("TableHeader",X,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",pp,ee,fb,"moveBackground","insertColor",fk,Ye,"resizable","movable"],_checkIcon:cs,_movable:!0,_resizable:!0,_labelColor:b.tableHeaderLabelColor,_labelFont:b.tableHeaderLabelFont,_columnLineColor:b.tableHeaderColumnLineColor,_columnLineVisible:b.tableHeaderColumnLineVisible,_sortDescIcon:b.tableHeaderSortDescIcon,_sortAscIcon:b.tableHeaderSortAscIcon,_moveBackground:b.tableHeaderMoveBackground,_insertColor:b.tableHeaderInsertColor,_indent:db,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(_){return _.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(F){return F.getColor()||this._labelColor},getLabelAlign:function(b){return b._align},onPropertyChanged:function(){this.iv()},setMovingColumnInfo:function(z){this._movingColumnInfo=z,this.iv()},getLogicalPoint:function(F){return yo(F,this._view,this.tv.tx())},validateImpl:function(){var m=this,S=m._canvas,Y=m.getWidth(),j=m.getHeight(),N=m.tv,h=m._columnInfos,c=m._movingColumnInfo,o=-N.tx(),i=0;(Y!==S.clientWidth||j!==S.clientHeight)&&eh(S,Y,j),h.clear(),m._columnModel._roots.each(function(A){if(A.isVisible()){var P=i+A.getWidth();o+Y>=i&&P>=o&&h.add({column:A,startX:i}),i=P}});var K=Yc(S);if(kk(K,-o,0,1),K.beginPath(),K.rect(o,0,Y,j),K.clip(),K.clearRect(o,0,Y,j),h.each(function(A){var I=A.column,O=A.startX,q=I.getWidth();q>0&&(K.save(),K.beginPath(),K.rect(O,0,q,j),K.clip(),c&&c.column===I||m.drawColumn(K,I,O,0,q,j),m._columnLineVisible&&hc(K,O+q-1,0,1,j,m._columnLineColor),K.restore())}),c){var f=c.column,i=c.startX,T=c.position,k=f.getWidth();K.save(),K.beginPath(),K.rect(i,0,k,j),K.clip(),K.fillStyle=m._moveBackground,K.fill(),m.drawColumn(K,f,i,0,k,j),K.restore(),vh(K,m._insertColor,T,0,j)}K.restore()},isCheckHeader:function(Z){var q=this.tv;return q._checkColumn===Z&&q.sm().getSelectionMode()===G},drawColumn:function(t,B,M,b,J,$){var e=this,Q=e.tv,r=vn(B.getIcon()),j=e.getLabelAlign(B);if(e.isCheckHeader(B)){var E=vn(e._checkIcon);xi(t,E,M+J/2,b+$/2,B,e)}else{var A=e.getLabel(B),I=e.getLabelFont(B),a=e.getLabelColor(B),T=nb(I,A).width,f=r?e._indent:0;j===s?(r&&yg(t,r,xm,M,b,f,$),fo(t,A,I,a,M+f,b,J,$,s)):j===c?(r&&yg(t,r,xm,M+J-T-f,b,f,$),fo(t,A,I,a,M,b,J,$,c)):(r&&yg(t,r,xm,M+(J-T-f)/2,b,f,$),fo(t,A,I,a,M+(J-T+f)/2,b,0,$,s))}if(B.isSortable()&&Q.getSortColumn()===B&&(r=vn(B.getSortOrder()===Qg?e._sortAscIcon:e._sortDescIcon))){var Z=Do(r,B)/2+2;xi(t,r,j===c?M+Z:M+J-Z,b+$/2,B,Q)}}});var Ir=function(P){var B=this;B.th=P,B.tv=P._tableView,B.addListeners()};Ib(Ir,X,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Q){this.getView().style.cursor=Q},handle_mousemove:function(u){if(!Fh){var G=this;delete G.columnInfo,G.setCursor(M);for(var E=G.th,n=E._columnInfos,Q=E.lp(u).x,N=n.size()-1;N>=0;N--){var H=n.get(N),l=H.column,m=H.startX+l.getWidth();if(E.isResizable()&&g(m-Q)<=(F?10:3))return G.columnInfo=H,G.setCursor(ik),void 0;(l.isSortable()||E.isMovable()||l===G.tv.getCheckColumn())&&Q>=H.startX&&m>=Q&&l.getWidth()>0&&(G.columnInfo=H,G.setCursor(Mr))}}},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(A){var M=this;Vk(A),M.tv.endEditing(),M.handle_mousemove(A),M.columnInfo&&(M.x=Rg(A).x,M.lx=M.th.lp(A).x,M.w=M.columnInfo.column.getWidth(),ns(M,A))},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(c){var n=this,k=n.th,E=n.getView().style.cursor,S=n.columnInfo,e=Rg(c).x-n.x;if(n.resizing||n.moving||(E===ik?n.resizing=1:k.isMovable()&&E===Mr&&g(e)>2&&(n.moving=1)),n.resizing)S.column.setWidth(n.w+e);else if(n.moving){var W=n.lx+e;k._columnInfos.each(function(_){var c=_.startX,T=c+_.column.getWidth();if(W>=c&&T>=W){var o={column:S.column,startX:S.startX+e,front:T-W>W-c,insertColumn:_.column};o.position=o.front?c:T,k.setMovingColumnInfo(o)}})}},handleCheckHeader:function(m,c){var E=this,N=E.tv,o=E.th,X=o._checkIcon;if(o.isCheckHeader(m)){var y=vn(X),g=E.lx,V=m.getWidth(),K=Do(y,m);if(g>=c+V/2-K&&c+V/2+K>=g){o.setCheckIcon(X===Ue?cs:Ue);var Q=N.sm(),f=N._rows;return X===Ue?Q.rs(f):Q.ss(f),N.onCheckColumnClicked(m),!0}}return!1},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(R){var B=this,A=B.tv,J=B.th,I=B.columnInfo;if(B.moving){var N=J._movingColumnInfo;if(N&&N.insertColumn!==N.column){var y=N.column,$=A.getColumnModel()._roots,b=$.remove(y),Y=$.indexOf(N.insertColumn);Y>=0&&(N.front||Y++,Y<=$.size()&&($.add(y,Y),A.getColumnModel().fireHierarchyChange(y,b,Y)))}J.setMovingColumnInfo(t),delete B.moving}else if(!B.resizing&&I){y=I.column;var Z=J.lp(R).x,g=I.startX,Q=!0;if(J.onColumnClicked){var n=J.onColumnClicked(y,R);n===!1&&(Q=!1)}if(Q&&Z>=g&&Z<=g+y.getWidth()&&!B.handleCheckHeader(y,g)){if(y.isSortable()){var j=A.getSortMode(),T=y.getSortOrder();j===Wp?A.getSortColumn()===y?(T===Br&&A.setSortColumn(t),y.setSortOrder(T===Qg?Br:Qg)):A.setSortColumn(y):"bistate"===j&&(A.getSortColumn()===y?y.setSortOrder(T===Qg?Br:Qg):A.setSortColumn(y))}A.onColumnClicked(y,R)}}B.columnInfo=B.resizing=B.x=B.lx=B.w=t}}),qs.TablePane=function(h){this.init(new Tm(h))},Li("TablePane",X,{ms_v:1,ms_tablePane:1}),qs.TreeTablePane=function(n){this.init(new Hj(n))},Li("TreeTablePane",X,{ms_v:1,ms_tablePane:1}),qs.Toolbar=function(x){var W=this,y=W._view=gc(1),B=y.style;B.background=b.toolbarBackground||"",B.height=$o+Ur,W._canvas=Rd(y),W._itemInfos=new Me,W._elements=new Me,W.setItems(x||[]),y.handleGroupSelectedChanged=function(I){if(I.isSelected()){var h=I.getGroupId();null!=h&&W._items.forEach(function(U){var L=U.element;L&&L!==I&&L.setSelected&&L.getGroupId&&L.getGroupId()===h&&L.setSelected(!1)})}},new Ml(W)},Li("Toolbar",X,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[qr,pp,ee,si,Xg,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:b.toolbarLabelColor,_labelSelectColor:b.toolbarLabelSelectColor,_labelFont:b.toolbarLabelFont,_selectBackground:b.toolbarSelectBackground,_itemGap:b.toolbarItemGap,_separatorColor:b.toolbarSeparatorColor,_stickToRight:!1,getToolTip:function(u){var Y=this.getItemInfoAt(u);return Y?Y.item.toolTip:t},getLabelColor:function(r){return r.selected&&r.type!==Ue&&r.type!==Vp?this._labelSelectColor:this._labelColor},onPropertyChanged:function(s){this.iv(),s.property===qr&&this._items.forEach(function(F){so(F)})},redraw:function(){this.iv()},addItem:function(M,g){var y=this._items;g==t?y.push(M):y.splice(g,0,M),this.fp(qr,t,y)},removeItem:function(q){if(q)for(var l=this._items,I=0;I<l.length;I++)q===l[I]&&(l.splice(I,1),this.fp(qr,t,l))},removeItemById:function(D){if(D!=t)for(var c=this._items,O=0;O<c.length;O++)D===c[O].id&&(c.splice(O,1),this.fp(qr,t,c))},getItemById:function(T){if(T!=t)for(var J=this._items,f=0;f<J.length;f++){var n=J[f];if(T===n.id)return n}},getItemInfos:function(){return this._itemInfos},getItemInfoAt:function(s){var p=this,Y=0,W=p._itemInfos,k=p.lp(s),C=k.x,V=k.y;if(V>=0&&V<=p.getHeight())for(;Y<W.size();Y++){var m=W.get(Y);if(m.startX<=C&&C<=m.endX)return m}return t},drawItem:function(Y,C,U,n,A){if(C.visible===!1)return 0;var N=this,o=C.disabled;o&&(Y.globalAlpha=Wj);var y=N.drawItemImpl(Y,C,U,n,A),E=N._itemGap;return o&&(Y.globalAlpha=1),this._currentItem!==C||"separator"===C||C.unfocusable||Ji(Y,N._separatorColor,U-E/2,0,y+E,n),y},drawItemImpl:function(s,M,O,A,H){var x,R=this,o=R._view,W=R._itemGap,c=A/2,Q=M.type,E=M.label,N=R.getLabelFont(M),B=R.getLabelColor(M),K=M.selected,n=vn(M.icon),w=Do(n,M),P=0,V=M.element,_=w+(E?nb(N,E).width:0);if("separator"===M)return vh(s,R._separatorColor,O,A/4,c),1;if(V){n&&xi(s,n,O+w/2,c),fo(s,E,N,B,O+w,0,0,A);var e=Mp(V);H||R._elements.add(e),e.parentNode!==o&&Zc(o,e),V.iv&&V.iv(),V.validate&&V.validate();var G=e.getBoundingClientRect(),F=G.width,t=e.style;return xe(e),t.left=R.tx()+O+_+Ur,t.top=(A-G.height)/2+Ur,_+F}return Q===Vp?x=vn(K?Bs:yl):Q===Ue&&(x=vn(K?Ue:cs)),x?(P=Do(x,M),xi(s,x,O+P/2,c),O+=P,_+=P):K&&hc(s,O-W/2,0,_+W,A,R.getSelectBackground(M)),n&&xi(s,n,O+w/2,c),fo(s,E,N,B,O+w,0,0,A),_},validateImpl:function(){var Z=this,H=Z._canvas,r=Z.getWidth(),B=Z.getHeight(),K=Z._itemInfos,V=Z._items;eh(H,r,B);var i=Yc(H),p=Z._itemGap,E=p/2;kk(i,Z.tx(),0,1),i.clearRect(0,0,r,B);var $=Z._elements;Z._elements=new Me,K.clear(),V.forEach(function(e){var X=Z.drawItem(i,e,E,B);K.add({item:e,startX:E,endX:E+X,width:X}),E+=X+p}),$.each(function(e){Z._elements.contains(e)||gi(e)}),Z._sumWidth=n(0,E),i.restore(),Z._stickToRight?(Z._translateX=0,i=Yc(H),E=r-Z._sumWidth+p,kk(i,0,0,1),i.clearRect(0,0,r,B),K.clear(),V.forEach(function(s){var A=Z.drawItem(i,s,E,B,!0);K.add({item:s,startX:E,endX:E+A,width:A}),E+=A+p}),i.restore()):Z.tx(Z.tx())},handleClick:function(J){var N=this,l=J.type,F=J.action,v=J.groupId,i=J.selected;J.disabled||(v!=t?i||(J.selected=!0,this._items.forEach(function(T){T.groupId===v&&J!==T&&(T.selected=!1)}),F&&J.action(J,N)):l===Ue||"toggle"===l?(J.selected=!i,F&&J.action(J,N)):F&&J.action(J,N)),oe(),N.iv()}});var Ml=function(r){this.tb=r,this.addListeners()};Ib(Ml,X,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(b){this.handleScroll(b,10*(b.wheelDelta/40))},handle_DOMMouseScroll:function(l){this.handleScroll(l,10*-l.detail)},handleScroll:function(e,W){Vk(e);var y=this.tb;y.isScrollable()&&!y._stickToRight&&(y.tx(y.tx()+W),jo())},handle_mousemove:function(r){var M=this;Fh?M.info2=M.tb.getItemInfoAt(r):M.setItem(r)},handle_mouseout:function($){var Y=this;$.target===Y.getView()?Y.tb.setCurrentItem(t):Y.handle_mousemove($)},handle_mousedown:function(b){this.handle_mousemove(b),this.handle_touchstart(b)},handle_touchstart:function(p){var H=this,R=H.tb,X=p.target;(X===H.getView()||X===R._canvas)&&(Vk(p),R.setFocus(p)&&(this.setItem(p),(R.isScrollable()||H.info&&!H.info.item.disabled)&&(H.x=Rg(p).x,H.tx=R.tx(),ns(H,p))))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(h){var z=this,Q=z.tb;if(!Q._stickToRight){var I=Rg(h).x-z.x;!z.translating&&g(I)>2&&Q.isScrollable()&&(z.translating=1),z.translating&&Q.tx(z.tx+I)}},handleWindowMouseUp:function(C){this.handleWindowTouchEnd(C)},handleWindowTouchEnd:function(){var J=this,Z=J.tb,Y=J.info,P=J.info2;if(!J.translating&&Y){var u=Y.item;P&&P.item!==u||Z.handleClick(u)}J.translating=J.x=J.tx=J.info2=t,J.setItem()},setItem:function(j){var B=this,v=B.tb,u=B.info=j?v.getItemInfoAt(j):t;v.setCurrentItem(u?u.item:t)}}),qs.BorderPane=function(){this._view=gc(1),this.iv()},Li("BorderPane",X,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(v,D){this._setContent("leftView",v),D!=t&&this.setLeftWidth(D)},getRightView:function(){return this._rightView},setRightView:function(T,b){this._setContent("rightView",T),b!=t&&this.setRightWidth(b)},getTopView:function(){return this._topView},setTopView:function(g,J){this._setContent("topView",g),J!=t&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(J,I){this._setContent("bottomView",J),I!=t&&this.setBottomHeight(I)},getCenterView:function(){return this._centerView},setCenterView:function(P){this._setContent("centerView",P)},_setContent:function(Z,_){var A=this,h="_"+Z,O=A._view,b=A[h];b!==_&&(b&&(b.getView?gi(b.getView()):gi(b)),A[h]=_,_&&(_.getView?Zc(O,_.getView(),1):Zc(O,_,1)),A.fp(Z,b,_))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var Q=this,Y=Q._topView,m=Q._bottomView,c=Q._leftView,q=Q._rightView,H=Q._centerView,b=Q.getWidth(),U=Q.getHeight(),S=0,g=0,C=b,L=U,$=0,x=0,E=0,r=0;Y&&($=Q._topHeight==t?ul(Y):Q._topHeight,g=$),m&&(x=Q._bottomHeight==t?ul(m):Q._bottomHeight,L=U-x),c&&(E=Q._leftWidth==t?qh(c):Q._leftWidth,S=E),q&&(r=Q._rightWidth==t?qh(q):Q._rightWidth,C=b-r);var k=n(0,C-S),A=n(0,L-g);Y&&fg(Y,0,0,b,$),m&&fg(m,0,L,b,x),c&&fg(c,0,g,E,A),q&&fg(q,C,g,r,A),H&&fg(H,S,g,k,A)}})}}(this,Object);